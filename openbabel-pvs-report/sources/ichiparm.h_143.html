
<html>
<head>

  <meta http-equiv="Content-Type" content="text/html; charset=US-ASCII" />
  <title>ichiparm.h</title>

  <link rel="stylesheet" href="../style.css"/>
  <script src="../jquery-3.2.1.min.js"></script>
</head>
<body>

<pre><code class = "cpp">
<a name="ln1">/*</a>
<a name="ln2"> * International Chemical Identifier (InChI)</a>
<a name="ln3"> * Version 1</a>
<a name="ln4"> * Software version 1.04</a>
<a name="ln5"> * September 9, 2011</a>
<a name="ln6"> *</a>
<a name="ln7"> * The InChI library and programs are free software developed under the</a>
<a name="ln8"> * auspices of the International Union of Pure and Applied Chemistry (IUPAC).</a>
<a name="ln9"> * Originally developed at NIST. Modifications and additions by IUPAC </a>
<a name="ln10"> * and the InChI Trust.</a>
<a name="ln11"> *</a>
<a name="ln12"> * IUPAC/InChI-Trust Licence for the International Chemical Identifier (InChI) </a>
<a name="ln13"> * Software version 1.0.</a>
<a name="ln14"> * Copyright (C) IUPAC and InChI Trust Limited</a>
<a name="ln15"> * </a>
<a name="ln16"> * This library is free software; you can redistribute it and/or modify it under the </a>
<a name="ln17"> * terms of the IUPAC/InChI Trust Licence for the International Chemical Identifier </a>
<a name="ln18"> * (InChI) Software version 1.0; either version 1.0 of the License, or </a>
<a name="ln19"> * (at your option) any later version.</a>
<a name="ln20"> * </a>
<a name="ln21"> * This library is distributed in the hope that it will be useful, </a>
<a name="ln22"> * but WITHOUT ANY WARRANTY; without even the implied warranty of </a>
<a name="ln23"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  </a>
<a name="ln24"> * See the IUPAC/InChI Trust Licence for the International Chemical Identifier (InChI) </a>
<a name="ln25"> * Software version 1.0 for more details.</a>
<a name="ln26"> * </a>
<a name="ln27"> * You should have received a copy of the IUPAC/InChI Trust Licence for the </a>
<a name="ln28"> * International Chemical Identifier (InChI) Software version 1.0 along with </a>
<a name="ln29"> * this library; if not, write to:</a>
<a name="ln30"> * </a>
<a name="ln31"> * The InChI Trust</a>
<a name="ln32"> * c/o FIZ CHEMIE Berlin</a>
<a name="ln33"> * Franklinstrasse 11</a>
<a name="ln34"> * 10587 Berlin</a>
<a name="ln35"> * GERMANY</a>
<a name="ln36"> * </a>
<a name="ln37"> */</a>
<a name="ln38"> </a>
<a name="ln39"> </a>
<a name="ln40">int DetectInputINChIFileType(FILE **inp_file, INPUT_PARMS *ip, const char *fmode);</a>
<a name="ln41">void HelpCommandLineParmsReduced(INCHI_IOSTREAM *f);</a>
<a name="ln42"> </a>
<a name="ln43"> </a>
<a name="ln44"> </a>
<a name="ln45"> </a>
<a name="ln46">/*****************************************************************************************/</a>
<a name="ln47">int ReadCommandLineParms(int argc, const char *argv[], INPUT_PARMS *ip, </a>
<a name="ln48">                         char *szSdfDataValue, unsigned long *ulDisplTime, </a>
<a name="ln49">                         int bReleaseVersion, INCHI_IOSTREAM *log_file)</a>
<a name="ln50">{</a>
<a name="ln51">    int           i, k, c;</a>
<a name="ln52">    const char    *q;</a>
<a name="ln53">    unsigned long ul;</a>
<a name="ln54">    int           nFontSize    = -9;</a>
<a name="ln55">    int           nMode        = 0;</a>
<a name="ln56">    int           nReleaseMode = nMode | (REQ_MODE_BASIC | REQ_MODE_TAUT | REQ_MODE_ISO | REQ_MODE_STEREO);</a>
<a name="ln57"> </a>
<a name="ln58"> </a>
<a name="ln59">#if ( MIN_SB_RING_SIZE &gt; 0 )</a>
<a name="ln60">    int           nMinDbRinSize = MIN_SB_RING_SIZE, mdbr=0;</a>
<a name="ln61">#endif</a>
<a name="ln62"> </a>
<a name="ln63">    /*int           bNotRecognized=0;*/</a>
<a name="ln64">    char          szNameSuffix[32], szOutputPath[512];</a>
<a name="ln65">    int           bNameSuffix, bOutputPath;</a>
<a name="ln66">    int           bMergeAllInputStructures;</a>
<a name="ln67">    int           bDisconnectSalts       = (DISCONNECT_SALTS==1);</a>
<a name="ln68">    int           bDoNotAddH             = 0;</a>
<a name="ln69"> </a>
<a name="ln70"> </a>
<a name="ln71"> </a>
<a name="ln72">    int           bVer1Options           = 1;</a>
<a name="ln73">    int           bReconnectCoord        = (RECONNECT_METALS==1);</a>
<a name="ln74">    int           bDisconnectCoord       = (DISCONNECT_METALS==1);</a>
<a name="ln75"> </a>
<a name="ln76">    </a>
<a name="ln77"> </a>
<a name="ln78">#ifdef TARGET_LIB_FOR_WINCHI</a>
<a name="ln79">/*	int           bVer1Options           = 0; </a>
<a name="ln80">    int           bReconnectCoord        = 1;</a>
<a name="ln81">    int           bDisconnectCoord       = 1; */</a>
<a name="ln82">    int			  is_gui				 = 1;</a>
<a name="ln83">    int           bINChIOutputOptions    = INCHI_OUT_EMBED_REC; /* embed reconnected &amp; output full aux info */</a>
<a name="ln84">    int           bCompareComponents     = CMP_COMPONENTS;</a>
<a name="ln85">#else</a>
<a name="ln86">/*  int           bVer1Options           = 1;</a>
<a name="ln87">    int           bReconnectCoord        = (RECONNECT_METALS==1);</a>
<a name="ln88">    int           bDisconnectCoord       = (DISCONNECT_METALS==1); */</a>
<a name="ln89">    int			  is_gui				 = 0;</a>
<a name="ln90">    int           bINChIOutputOptions     = ((EMBED_REC_METALS_INCHI==1)? INCHI_OUT_EMBED_REC   : 0);</a>
<a name="ln91">                                            /*| INCHI_OUT_NO_AUX_INFO INCHI_OUT_SHORT_AUX_INFO*/</a>
<a name="ln92">    int           bCompareComponents     = 0;</a>
<a name="ln93">#endif</a>
<a name="ln94"> </a>
<a name="ln95">    int           bDisconnectCoordChkVal = (CHECK_METAL_VALENCE == 1);</a>
<a name="ln96">    int           bMovePositiveCharges   = (MOVE_CHARGES==1);</a>
<a name="ln97">    int           bAcidTautomerism       = (DISCONNECT_SALTS==1)? (TEST_REMOVE_S_ATOMS==1? 2:1):0;</a>
<a name="ln98">    int           bUnchargedAcidTaut     = (CHARGED_SALTS_ONLY==0);</a>
<a name="ln99">    int           bMergeSaltTGroups      = (DISCONNECT_SALTS==1);</a>
<a name="ln100">    int           bDisplayCompositeResults = 0;</a>
<a name="ln101"> </a>
<a name="ln102">#define VER103_DEFAULT_MODE    (REQ_MODE_TAUT | REQ_MODE_ISO | REQ_MODE_STEREO |\</a>
<a name="ln103">                                REQ_MODE_SB_IGN_ALL_UU | REQ_MODE_SC_IGN_ALL_UU)</a>
<a name="ln104"> </a>
<a name="ln105">    INCHI_MODE     bVer1DefaultMode = VER103_DEFAULT_MODE;</a>
<a name="ln106">   </a>
<a name="ln107">    const char   *ext[MAX_NUM_PATHS+1];</a>
<a name="ln108">    const char   *pArg;</a>
<a name="ln109">    double        t;</a>
<a name="ln110">    int           bRecognizedOption;</a>
<a name="ln111">    int           bDisplay = 0;</a>
<a name="ln112">    int           bNoStructLabels = 0;</a>
<a name="ln113">    int           bOutputMolfileOnly = 0;</a>
<a name="ln114">    int           bOutputMolfileDT = 0;</a>
<a name="ln115">    int           bOutputMolfileSplit = 0;</a>
<a name="ln116">    int           bForcedChiralFlag = 0;</a>
<a name="ln117"> </a>
<a name="ln118">#if ( READ_INCHI_STRING == 1 )</a>
<a name="ln119">    int           bDisplayIfRestoreWarnings = 0;</a>
<a name="ln120">#endif</a>
<a name="ln121"> </a>
<a name="ln122">#ifdef TARGET_LIB_FOR_WINCHI</a>
<a name="ln123">    int           bXml = INCHI_OUT_XML;</a>
<a name="ln124">#else</a>
<a name="ln125">    int           bXml = INCHI_OUT_PLAIN_TEXT;</a>
<a name="ln126">#endif</a>
<a name="ln127">    int bTgFlagVariableProtons = 1;</a>
<a name="ln128">    int bTgFlagHardAddRenProtons = 1;</a>
<a name="ln129">#ifdef STEREO_WEDGE_ONLY</a>
<a name="ln130">    int bPointedEdgeStereo = STEREO_WEDGE_ONLY; /*   NEWPS TG_FLAG_POINTED_EDGE_STEREO*/</a>
<a name="ln131">#endif</a>
<a name="ln132">#if ( FIX_ADJ_RAD == 1 )</a>
<a name="ln133">    int bFixAdjacentRad = 0;</a>
<a name="ln134">#endif</a>
<a name="ln135">    int bAddPhosphineStereo = 1;</a>
<a name="ln136">    int bAddArsineStereo    = 1;</a>
<a name="ln137">    int bFixSp3bug          = 1; </a>
<a name="ln138">    int bFixFB2             = 1; </a>
<a name="ln139">    int bKetoEnolTaut       = 0;</a>
<a name="ln140">    int b15TautNonRing      = 0;</a>
<a name="ln141">    int bStdFormat          = 1;</a>
<a name="ln142">    int bHashKey            = 0;</a>
<a name="ln143">    int bHashXtra1          = 0;</a>
<a name="ln144">    int bHashXtra2          = 0;</a>
<a name="ln145"> </a>
<a name="ln146">    ext[0] = &quot;.mol&quot;;</a>
<a name="ln147">    ext[1] = bVer1Options? &quot;.txt&quot; : &quot;.ich&quot;;</a>
<a name="ln148">    ext[2] = &quot;.log&quot;;</a>
<a name="ln149">    ext[3] = &quot;.prb&quot;;</a>
<a name="ln150">    ext[4] = &quot;&quot;;</a>
<a name="ln151"> </a>
<a name="ln152">#if ( MAX_NUM_PATHS &lt; 4 )</a>
<a name="ln153">  #error Wrong initialization</a>
<a name="ln154">#endif</a>
<a name="ln155"> </a>
<a name="ln156"> </a>
<a name="ln157"> </a>
<a name="ln158">    /*  init table parms */</a>
<a name="ln159">    memset(ip, 0, sizeof(*ip));</a>
<a name="ln160">    </a>
<a name="ln161">    /* default are standard InChI generation options */</a>
<a name="ln162">    bVer1DefaultMode   &amp;=		~REQ_MODE_BASIC;	/* &quot;FIXEDH - OFF&quot; */</a>
<a name="ln163">    bReconnectCoord     =		0;					/* &quot;RECMET - OFF&quot; */</a>
<a name="ln164">    bPointedEdgeStereo  =		1;					/* &quot;NEWPS&quot; */</a>
<a name="ln165">    ip-&gt;bFixNonUniformDraw =	1;					/* &quot;FNUD&quot; */</a>
<a name="ln166">    </a>
<a name="ln167"> </a>
<a name="ln168"> </a>
<a name="ln169">#ifndef COMPILE_ANSI_ONLY</a>
<a name="ln170">    strcpy( ip-&gt;tdp.ReqShownFoundTxt[ilSHOWN], &quot;Shown&quot; );</a>
<a name="ln171">    ip-&gt;dp.sdp.tdp = &amp;ip-&gt;tdp;</a>
<a name="ln172">    ip-&gt;dp.pdp     = &amp;ip-&gt;pdp;</a>
<a name="ln173">#endif</a>
<a name="ln174"> </a>
<a name="ln175">    memset( szNameSuffix, 0, sizeof(szNameSuffix) );</a>
<a name="ln176">    bNameSuffix = 0;</a>
<a name="ln177">    memset(szOutputPath, 0, sizeof(szOutputPath) );</a>
<a name="ln178">    bOutputPath = 0;</a>
<a name="ln179">    bMergeAllInputStructures = 0;</a>
<a name="ln180"> </a>
<a name="ln181">    *ulDisplTime  = 0;</a>
<a name="ln182">#ifdef TARGET_API_LIB</a>
<a name="ln183">    ip-&gt;msec_MaxTime = 0;      /*  milliseconds, default = unlimited in libinchi */</a>
<a name="ln184">#else</a>
<a name="ln185">    ip-&gt;msec_MaxTime = 60000;  /*  milliseconds, default = 60 sec */</a>
<a name="ln186">#endif</a>
<a name="ln187"> </a>
<a name="ln188"> </a>
<a name="ln189">    if ( bReleaseVersion ) </a>
<a name="ln190">    {</a>
<a name="ln191">        /*  normal */</a>
<a name="ln192">        /*ip-&gt;bINChIOutputOptions |= INCHI_OUT_PLAIN_TEXT;*/</a>
<a name="ln193">        /*ip-&gt;bXml = 1;*/</a>
<a name="ln194">        ip-&gt;bAbcNumbers = 0;</a>
<a name="ln195">        ip-&gt;bCtPredecessors = 0;</a>
<a name="ln196">        /*</a>
<a name="ln197">         -- testing --</a>
<a name="ln198">        ip-&gt;bXml = 0;</a>
<a name="ln199">        ip-&gt;bAbcNumbers = 1;</a>
<a name="ln200">        */</a>
<a name="ln201">    } </a>
<a name="ln202">    else </a>
<a name="ln203">    {</a>
<a name="ln204">        /*bXml = INCHI_OUT_PLAIN_TEXT;*/</a>
<a name="ln205">        nReleaseMode = 0;</a>
<a name="ln206">    }</a>
<a name="ln207"> </a>
<a name="ln208">    if ( bVer1Options ) </a>
<a name="ln209">    {</a>
<a name="ln210">        bNameSuffix = 1;</a>
<a name="ln211">        szNameSuffix[0] = '\0';</a>
<a name="ln212">    }</a>
<a name="ln213"> </a>
<a name="ln214"> </a>
<a name="ln215">    /* Parse */</a>
<a name="ln216"> </a>
<a name="ln217">    for ( i = 1; i &lt; argc; i ++ ) </a>
<a name="ln218">    {</a>
<a name="ln219">    </a>
<a name="ln220">        /* if ( !(bVer1Options &amp; 1) &amp;&amp; INCHI_OPTION_PREFX == argv[i][0] &amp;&amp; INCHI_OPTION_PREFX != argv[i][1] ) */</a>
<a name="ln221">        if ( is_gui &amp;&amp; INCHI_OPTION_PREFX == argv[i][0] &amp;&amp; INCHI_OPTION_PREFX != argv[i][1] ) </a>
<a name="ln222">        {</a>
<a name="ln223">        /*=== parsing TARGET_LIB_FOR_WINCHI GUI (and v. 0.9xx Beta)options ===*/</a>
<a name="ln224"> </a>
<a name="ln225">            pArg = argv[i]+1;</a>
<a name="ln226">            </a>
<a name="ln227"> </a>
<a name="ln228">            /*--- Input options ---*/</a>
<a name="ln229">            if ( !stricmp( pArg, &quot;INPAUX&quot; ))</a>
<a name="ln230">            {</a>
<a name="ln231">                if (INPUT_NONE == ip-&gt;nInputType) </a>
<a name="ln232">                    ip-&gt;nInputType = INPUT_INCHI_PLAIN;</a>
<a name="ln233">            }</a>
<a name="ln234"> </a>
<a name="ln235"> </a>
<a name="ln236"> </a>
<a name="ln237">            else if ( INPUT_NONE == ip-&gt;nInputType &amp;&amp;</a>
<a name="ln238">                    (!memicmp( pArg, &quot;SDF&quot;, 3 )) &amp;&amp;</a>
<a name="ln239">                    ( pArg[3] == ':' ) ) </a>
<a name="ln240">            {</a>
<a name="ln241">                k = 0;</a>
<a name="ln242">                mystrncpy( ip-&gt;szSdfDataHeader, pArg+4, MAX_SDF_HEADER+1 );</a>
<a name="ln243">                LtrimRtrim( ip-&gt;szSdfDataHeader, &amp;k );</a>
<a name="ln244">                if ( k ) {</a>
<a name="ln245">                    ip-&gt;pSdfLabel  = ip-&gt;szSdfDataHeader;</a>
<a name="ln246">                    ip-&gt;pSdfValue  = szSdfDataValue;</a>
<a name="ln247">                    ip-&gt;nInputType = INPUT_SDFILE;</a>
<a name="ln248">                } else {</a>
<a name="ln249">                    ip-&gt;pSdfLabel  = NULL;</a>
<a name="ln250">                    ip-&gt;pSdfValue  = NULL;</a>
<a name="ln251">                    ip-&gt;nInputType = INPUT_MOLFILE;</a>
<a name="ln252">                }</a>
<a name="ln253">            } </a>
<a name="ln254"> </a>
<a name="ln255">            else if ( INPUT_NONE == ip-&gt;nInputType &amp;&amp; !stricmp( pArg, &quot;MOL&quot; ) ) </a>
<a name="ln256">            {</a>
<a name="ln257">                ip-&gt;nInputType = INPUT_MOLFILE;</a>
<a name="ln258">            }             </a>
<a name="ln259">            else if ( INPUT_NONE == ip-&gt;nInputType &amp;&amp; !stricmp( pArg, &quot;SDF&quot; ) ) </a>
<a name="ln260">            {</a>
<a name="ln261">                ip-&gt;nInputType = INPUT_MOLFILE;</a>
<a name="ln262">            }             </a>
<a name="ln263">#if ( ADD_CMLPP == 1 )</a>
<a name="ln264">            else if ( INPUT_NONE == ip-&gt;nInputType &amp;&amp; !stricmp( pArg, &quot;CML&quot; )  ) {</a>
<a name="ln265">                 /* CMLfile label */</a>
<a name="ln266">                ip-&gt;nInputType = INPUT_CMLFILE;</a>
<a name="ln267">            } </a>
<a name="ln268">#endif            </a>
<a name="ln269"> </a>
<a name="ln270">            else if ( !memicmp( pArg, &quot;START:&quot;, 6 ) ) </a>
<a name="ln271">            {</a>
<a name="ln272">                ip-&gt;first_struct_number = strtol(pArg+6, NULL, 10);</a>
<a name="ln273">            } </a>
<a name="ln274">            else if ( !memicmp( pArg, &quot;END:&quot;, 4 ) ) </a>
<a name="ln275">            {</a>
<a name="ln276">                ip-&gt;last_struct_number = strtol(pArg+4, NULL, 10);</a>
<a name="ln277">            }</a>
<a name="ln278">#ifdef BUILD_WITH_ENG_OPTIONS</a>
<a name="ln279">            else if ( !memicmp( pArg, &quot;RSB:&quot;, 4 ) ) </a>
<a name="ln280">            {</a>
<a name="ln281">                mdbr = (int)strtol(pArg+4, NULL, 10);</a>
<a name="ln282">            } else</a>
<a name="ln283">            if ( !memicmp( pArg, &quot;DISCONSALT:&quot;, 11 ) ) {</a>
<a name="ln284">                bDisconnectSalts = (0 != strtol(pArg+11, NULL, 10));</a>
<a name="ln285">            } else</a>
<a name="ln286">            if ( !memicmp( pArg, &quot;DISCONMETAL:&quot;, 12 ) ) {</a>
<a name="ln287">                bDisconnectCoord = (0 != strtol(pArg+12, NULL, 10));</a>
<a name="ln288">            } else</a>
<a name="ln289">            if ( !memicmp( pArg, &quot;RECONMETAL:&quot;, 11 ) ) {</a>
<a name="ln290">                bReconnectCoord = (0 != strtol(pArg+11, NULL, 10));</a>
<a name="ln291">            } else</a>
<a name="ln292">            if ( !memicmp( pArg, &quot;DISCONMETALCHKVAL:&quot;, 18 ) ) {</a>
<a name="ln293">                bDisconnectCoordChkVal = (0 != strtol(pArg+18, NULL, 10));</a>
<a name="ln294">            } else</a>
<a name="ln295">            if ( !memicmp( pArg, &quot;MOVEPOS:&quot;, 8 ) ) {</a>
<a name="ln296">                bMovePositiveCharges = (0 != strtol(pArg+8, NULL, 10));</a>
<a name="ln297">            } else</a>
<a name="ln298">            if ( !memicmp( pArg, &quot;MERGESALTTG:&quot;, 12 ) ) {</a>
<a name="ln299">                bMergeSaltTGroups = (0 != strtol(pArg+12, NULL, 10));</a>
<a name="ln300">            } else</a>
<a name="ln301">            if ( !memicmp( pArg, &quot;UNCHARGEDACIDS:&quot;, 15) ) {</a>
<a name="ln302">                bUnchargedAcidTaut = (0 != strtol(pArg+15, NULL, 16));;</a>
<a name="ln303">            } else</a>
<a name="ln304">            if ( !memicmp( pArg, &quot;ACIDTAUT:&quot;, 9 ) ) {</a>
<a name="ln305">                bAcidTautomerism = c = (int)strtol(pArg+9, NULL, 10);</a>
<a name="ln306">                if ( 0 &lt;= c &amp;&amp; c &lt;= 2 )  bAcidTautomerism = c;</a>
<a name="ln307">                /*else bNotRecognized = 2*bReleaseVersion;*/</a>
<a name="ln308">            }</a>
<a name="ln309">#endif </a>
<a name="ln310"> </a>
<a name="ln311">            /*--- Output options ---*/</a>
<a name="ln312">#if ( !defined(TARGET_API_LIB) &amp;&amp; !defined(TARGET_LIB_FOR_WINCHI) )</a>
<a name="ln313">            else if ( !stricmp( pArg, &quot;Tabbed&quot; ) ) </a>
<a name="ln314">            {</a>
<a name="ln315">                bXml |=  INCHI_OUT_TABBED_OUTPUT;</a>
<a name="ln316">            } </a>
<a name="ln317">#endif</a>
<a name="ln318">            else if ( !stricmp( pArg, &quot;NOLABELS&quot; ) ) </a>
<a name="ln319">            {</a>
<a name="ln320">                 bNoStructLabels = 1;</a>
<a name="ln321">            } </a>
<a name="ln322">            else if ( !stricmp( pArg, &quot;SAVEOPT&quot; ) ) </a>
<a name="ln323">            {</a>
<a name="ln324">                 bINChIOutputOptions |= INCHI_OUT_SAVEOPT;</a>
<a name="ln325">            } </a>
<a name="ln326">            else if ( !stricmp( pArg, &quot;AUXNONE&quot; ) ) </a>
<a name="ln327">            {    </a>
<a name="ln328">                /* no aux. info */</a>
<a name="ln329">                bINChIOutputOptions |= INCHI_OUT_NO_AUX_INFO;  /* no aux info */</a>
<a name="ln330">                bINChIOutputOptions &amp;= ~INCHI_OUT_SHORT_AUX_INFO;</a>
<a name="ln331">            } </a>
<a name="ln332"> </a>
<a name="ln333"> </a>
<a name="ln334">#if ( defined(BUILD_WITH_ENG_OPTIONS) || defined(TARGET_LIB_FOR_WINCHI) )</a>
<a name="ln335">            else if ( !stricmp( pArg, &quot;SDFID&quot; ) ) </a>
<a name="ln336">            {</a>
<a name="ln337">                ip-&gt;bGetSdfileId = 1;</a>
<a name="ln338">            }             </a>
<a name="ln339">            else if ( !stricmp( pArg, &quot;XML&quot; ) ) </a>
<a name="ln340">            {</a>
<a name="ln341">                bXml &amp;= ~INCHI_OUT_PLAIN_TEXT;</a>
<a name="ln342">                bXml |=  INCHI_OUT_XML;</a>
<a name="ln343">                /*bNotRecognized = 2*bReleaseVersion;*/</a>
<a name="ln344">            }             </a>
<a name="ln345">            else if ( !stricmp( pArg, &quot;PLAIN&quot; ) ) </a>
<a name="ln346">            {</a>
<a name="ln347">                bXml |=  INCHI_OUT_PLAIN_TEXT;</a>
<a name="ln348">                bXml &amp;= ~INCHI_OUT_XML;</a>
<a name="ln349">            } </a>
<a name="ln350">            else if ( !stricmp( pArg, &quot;ANNPLAIN&quot; ) ) </a>
<a name="ln351">            {</a>
<a name="ln352">                bXml |=   INCHI_OUT_PLAIN_TEXT_COMMENTS;</a>
<a name="ln353">                bXml &amp;=  ~INCHI_OUT_XML_TEXT_COMMENTS;</a>
<a name="ln354">            }             </a>
<a name="ln355">            else if ( !stricmp( pArg, &quot;ANNXML&quot; ) ) </a>
<a name="ln356">            {</a>
<a name="ln357">                bXml |=   INCHI_OUT_XML_TEXT_COMMENTS;</a>
<a name="ln358">                bXml &amp;=  ~INCHI_OUT_PLAIN_TEXT_COMMENTS;</a>
<a name="ln359">            } </a>
<a name="ln360">            else if ( !memicmp( pArg, &quot;AUXINFO:&quot;, 8 ) &amp;&amp; isdigit(UCINT pArg[8]) ) </a>
<a name="ln361">            {</a>
<a name="ln362">                k = strtol(pArg+8, NULL, 10);</a>
<a name="ln363">                if ( k == 0 ) </a>
<a name="ln364">                {</a>
<a name="ln365">                    bINChIOutputOptions |= INCHI_OUT_NO_AUX_INFO;  /* no aux info */</a>
<a name="ln366">                    bINChIOutputOptions &amp;= ~INCHI_OUT_SHORT_AUX_INFO;</a>
<a name="ln367">                } </a>
<a name="ln368">                else if ( k == 1 ) </a>
<a name="ln369">                {</a>
<a name="ln370">                    bINChIOutputOptions &amp;= ~(INCHI_OUT_NO_AUX_INFO | INCHI_OUT_SHORT_AUX_INFO); /* include full aux info */</a>
<a name="ln371">                } </a>
<a name="ln372">                else if ( k == 2 ) </a>
<a name="ln373">                {</a>
<a name="ln374">                    bINChIOutputOptions &amp;= ~INCHI_OUT_NO_AUX_INFO; /* include short aux info */</a>
<a name="ln375">                    bINChIOutputOptions |= INCHI_OUT_SHORT_AUX_INFO;</a>
<a name="ln376">                } </a>
<a name="ln377">                else </a>
<a name="ln378">                {</a>
<a name="ln379">                    bINChIOutputOptions = k;  /* override everything */</a>
<a name="ln380">                }</a>
<a name="ln381">            }             </a>
<a name="ln382">            else if ( !stricmp( pArg, &quot;MERGE&quot; ) ) </a>
<a name="ln383">            {</a>
<a name="ln384">                bMergeAllInputStructures = 1;</a>
<a name="ln385">            } </a>
<a name="ln386">            </a>
<a name="ln387">            else if ( !stricmp( pArg, &quot;PGO&quot; ) ) </a>
<a name="ln388">            {</a>
<a name="ln389">                ip-&gt;bSaveAllGoodStructsAsProblem = 1;</a>
<a name="ln390">            }             </a>
<a name="ln391">            else if ( !stricmp( pArg, &quot;DCR&quot; ) ) </a>
<a name="ln392">            {</a>
<a name="ln393">                bDisplayCompositeResults = 1;</a>
<a name="ln394">            } </a>
<a name="ln395">            </a>
<a name="ln396">            else if ( !stricmp( pArg, &quot;DSB&quot; ) ) </a>
<a name="ln397">            {</a>
<a name="ln398">                nMode |= REQ_MODE_NO_ALT_SBONDS;</a>
<a name="ln399">            }             </a>
<a name="ln400">            else if ( !stricmp( pArg, &quot;NOHDR&quot; ) ) </a>
<a name="ln401">            {</a>
<a name="ln402">                 bNoStructLabels = 1;</a>
<a name="ln403">            } </a>
<a name="ln404">            </a>
<a name="ln405">            else if ( !stricmp( pArg, &quot;NoVarH&quot; ) ) </a>
<a name="ln406">            {</a>
<a name="ln407">                 bTgFlagVariableProtons = 0;</a>
<a name="ln408">            } </a>
<a name="ln409">#endif /* BUILD_WITH_ENG_OPTIONS */</a>
<a name="ln410"> </a>
<a name="ln411"> </a>
<a name="ln412">            /*--- All modes (std and non-std InChI) structure perception options ---*/</a>
<a name="ln413">            else if ( !stricmp( pArg, &quot;SNON&quot; ) ) </a>
<a name="ln414">            {</a>
<a name="ln415">                bVer1DefaultMode &amp;= ~REQ_MODE_STEREO; </a>
<a name="ln416">                nMode &amp;= ~(REQ_MODE_RACEMIC_STEREO | REQ_MODE_RELATIVE_STEREO | REQ_MODE_CHIR_FLG_STEREO);</a>
<a name="ln417">            } </a>
<a name="ln418">            else if ( !stricmp( pArg, &quot;NEWPSOFF&quot; ) ) </a>
<a name="ln419">            {</a>
<a name="ln420">                 bPointedEdgeStereo = 0;</a>
<a name="ln421">            } </a>
<a name="ln422">            else if ( !stricmp( pArg, &quot;DONOTADDH&quot; ) ) </a>
<a name="ln423">            {</a>
<a name="ln424">                bDoNotAddH = 1;</a>
<a name="ln425">            } </a>
<a name="ln426"> </a>
<a name="ln427">            /* Non-standard */</a>
<a name="ln428">#ifndef USE_STDINCHI_API</a>
<a name="ln429">            </a>
<a name="ln430">            /* Non-std InChI structure perception options */           </a>
<a name="ln431">            else if ( !stricmp( pArg, &quot;SREL&quot; ) ) </a>
<a name="ln432">            {</a>
<a name="ln433">                if ( nMode &amp; REQ_MODE_RACEMIC_STEREO ) </a>
<a name="ln434">                {</a>
<a name="ln435">                    nMode ^= REQ_MODE_RACEMIC_STEREO;</a>
<a name="ln436">                }</a>
<a name="ln437">                if ( nMode &amp; REQ_MODE_CHIR_FLG_STEREO ) </a>
<a name="ln438">                {</a>
<a name="ln439">                    nMode ^= REQ_MODE_CHIR_FLG_STEREO;</a>
<a name="ln440">                }</a>
<a name="ln441">                nMode |= REQ_MODE_RELATIVE_STEREO;</a>
<a name="ln442">                nMode |= REQ_MODE_STEREO;</a>
<a name="ln443">                bStdFormat = 0;</a>
<a name="ln444">            }             </a>
<a name="ln445">            else if ( !stricmp( pArg, &quot;SRAC&quot; ) ) </a>
<a name="ln446">            {</a>
<a name="ln447">                if ( nMode &amp; REQ_MODE_RELATIVE_STEREO ) </a>
<a name="ln448">                {</a>
<a name="ln449">                    nMode ^= REQ_MODE_RELATIVE_STEREO;</a>
<a name="ln450">                }</a>
<a name="ln451">                if ( nMode &amp; REQ_MODE_CHIR_FLG_STEREO ) </a>
<a name="ln452">                {</a>
<a name="ln453">                    nMode ^= REQ_MODE_CHIR_FLG_STEREO;</a>
<a name="ln454">                }</a>
<a name="ln455">                nMode |= REQ_MODE_RACEMIC_STEREO;</a>
<a name="ln456">                nMode |= REQ_MODE_STEREO;</a>
<a name="ln457">                bStdFormat = 0;</a>
<a name="ln458">            } </a>
<a name="ln459">            else if ( !stricmp( pArg, &quot;SUCF&quot; ) ) </a>
<a name="ln460">            {</a>
<a name="ln461">                if ( nMode &amp; REQ_MODE_RELATIVE_STEREO ) </a>
<a name="ln462">                {</a>
<a name="ln463">                    nMode ^= REQ_MODE_RELATIVE_STEREO;</a>
<a name="ln464">                }</a>
<a name="ln465">                if ( nMode &amp; REQ_MODE_RACEMIC_STEREO ) </a>
<a name="ln466">                {</a>
<a name="ln467">                    nMode ^= REQ_MODE_RACEMIC_STEREO;</a>
<a name="ln468">                }</a>
<a name="ln469">                nMode |= REQ_MODE_CHIR_FLG_STEREO; /* stereo defined by the Chiral flag */</a>
<a name="ln470">                nMode |= REQ_MODE_STEREO;</a>
<a name="ln471">                bStdFormat = 0;</a>
<a name="ln472">            }             </a>
<a name="ln473">            else if ( !stricmp( pArg, &quot;ChiralFlagON&quot; ) ) </a>
<a name="ln474">            { </a>
<a name="ln475">                /* used only with /SUCF */</a>
<a name="ln476">                /* NB: do not toggle off bStdFormat! (if necessary SUCF will do) */</a>
<a name="ln477">                bForcedChiralFlag &amp;= ~FLAG_SET_INP_AT_NONCHIRAL;</a>
<a name="ln478">                bForcedChiralFlag |= FLAG_SET_INP_AT_CHIRAL;</a>
<a name="ln479">            }             </a>
<a name="ln480">            else if ( !stricmp( pArg, &quot;ChiralFlagOFF&quot; ) ) </a>
<a name="ln481">            { </a>
<a name="ln482">                /* used only with /SUCF */</a>
<a name="ln483">                /* NB: do not toggle off bStdFormat! (if necessary SUCF will do) */</a>
<a name="ln484">                bForcedChiralFlag &amp;= ~FLAG_SET_INP_AT_CHIRAL;</a>
<a name="ln485">                bForcedChiralFlag |= FLAG_SET_INP_AT_NONCHIRAL;</a>
<a name="ln486">            }             </a>
<a name="ln487"> </a>
<a name="ln488">            /*--- Non-std InChI creation options ---*/</a>
<a name="ln489"> </a>
<a name="ln490">            else if ( !stricmp( pArg, &quot;SUU&quot; ) ) </a>
<a name="ln491">            {       </a>
<a name="ln492">                /* include omitted undef/unknown stereo */</a>
<a name="ln493">                bVer1DefaultMode &amp;= ~(REQ_MODE_SB_IGN_ALL_UU | REQ_MODE_SC_IGN_ALL_UU);</a>
<a name="ln494">                bStdFormat = 0;</a>
<a name="ln495">            } </a>
<a name="ln496">            else if ( !stricmp( pArg, &quot;SLUUD&quot; ) ) </a>
<a name="ln497">            {       </a>
<a name="ln498">                /* make labels for unknown and undefined stereo different */</a>
<a name="ln499">                bVer1DefaultMode |= REQ_MODE_DIFF_UU_STEREO;</a>
<a name="ln500">                bStdFormat = 0;</a>
<a name="ln501">            } </a>
<a name="ln502">            /* FixedH */</a>
<a name="ln503">            else if ( !stricmp( pArg, &quot;FIXEDH&quot; ) ) </a>
<a name="ln504">            {</a>
<a name="ln505">                bVer1DefaultMode |= REQ_MODE_BASIC;  /* tautomeric */</a>
<a name="ln506">                bStdFormat = 0;</a>
<a name="ln507">            }             </a>
<a name="ln508">            /* RecMet */</a>
<a name="ln509">            else if ( !stricmp( pArg, &quot;RECMET&quot; ) ) </a>
<a name="ln510">            {    </a>
<a name="ln511">                /* reconnect metals */</a>
<a name="ln512">                bReconnectCoord = 1;</a>
<a name="ln513">                bStdFormat = 0;</a>
<a name="ln514">            } </a>
<a name="ln515">#if ( KETO_ENOL_TAUT == 1 )</a>
<a name="ln516">            else if ( !stricmp( pArg, &quot;KET&quot; ) ) </a>
<a name="ln517">            {</a>
<a name="ln518">                bKetoEnolTaut = 1;</a>
<a name="ln519">                bStdFormat = 0;</a>
<a name="ln520">            } </a>
<a name="ln521">#endif</a>
<a name="ln522">#if ( TAUT_15_NON_RING == 1 )</a>
<a name="ln523">            else if ( !stricmp( pArg, &quot;15T&quot; ) ) </a>
<a name="ln524">            {</a>
<a name="ln525">                b15TautNonRing = 1;</a>
<a name="ln526">                bStdFormat = 0;</a>
<a name="ln527">            } </a>
<a name="ln528">#endif</a>
<a name="ln529"> </a>
<a name="ln530">#endif</a>
<a name="ln531">            /*--- Generation options ---*/</a>
<a name="ln532"> </a>
<a name="ln533">            /* InChIKey/InChI hash */</a>
<a name="ln534">            else if ( !stricmp( pArg, &quot;Key&quot; ) ) </a>
<a name="ln535">            {</a>
<a name="ln536">                bHashKey = 1;</a>
<a name="ln537">            }            </a>
<a name="ln538">            else if ( !stricmp( pArg, &quot;XHash1&quot; ) ) </a>
<a name="ln539">            {</a>
<a name="ln540">                bHashXtra1 = 1;</a>
<a name="ln541">            }            </a>
<a name="ln542">            else if ( !stricmp( pArg, &quot;XHash2&quot; ) ) </a>
<a name="ln543">            {</a>
<a name="ln544">                bHashXtra2 = 1;</a>
<a name="ln545">            }            </a>
<a name="ln546"> </a>
<a name="ln547"> </a>
<a name="ln548">            /*--- (engineering) Undo bug/draw fixes options ---*/</a>
<a name="ln549">#ifdef BUILD_WITH_ENG_OPTIONS</a>
<a name="ln550">            else if ( !stricmp( pArg, &quot;FixSp3bugOFF&quot; ) ) </a>
<a name="ln551">            {</a>
<a name="ln552">                 bFixSp3bug = 0;</a>
<a name="ln553">                 bStdFormat = 0;</a>
<a name="ln554">            }             </a>
<a name="ln555">            else if ( !stricmp( pArg, &quot;FBOFF&quot; ) ) </a>
<a name="ln556">            {</a>
<a name="ln557">                 bFixSp3bug = 0;</a>
<a name="ln558">                 bStdFormat = 0;</a>
<a name="ln559">            }             </a>
<a name="ln560">            else  if ( !stricmp( pArg, &quot;FB2OFF&quot; ) ) </a>
<a name="ln561">            {</a>
<a name="ln562">                 bFixFB2 = 0; </a>
<a name="ln563">                 bStdFormat = 0;</a>
<a name="ln564">            }             </a>
<a name="ln565">            else if ( !stricmp( pArg, &quot;SPXYZOFF&quot; ) ) </a>
<a name="ln566">            {</a>
<a name="ln567">                 bAddPhosphineStereo = 0;</a>
<a name="ln568">                 bStdFormat = 0;</a>
<a name="ln569">            } </a>
<a name="ln570">            else if ( !stricmp( pArg, &quot;SASXYZOFF&quot; ) ) </a>
<a name="ln571">            {</a>
<a name="ln572">                 bAddArsineStereo = 0;</a>
<a name="ln573">                 bStdFormat = 0;</a>
<a name="ln574">            } </a>
<a name="ln575">            else if ( !stricmp( pArg, &quot;FNUDOFF&quot; ) ) </a>
<a name="ln576">            {</a>
<a name="ln577">                 ip-&gt;bFixNonUniformDraw = 0;</a>
<a name="ln578">                 bStdFormat = 0;</a>
<a name="ln579">            }            </a>
<a name="ln580"> </a>
<a name="ln581">            /*--- (hidden) Old structure-perception and InChI creation options ---*/</a>
<a name="ln582">            /*--- (engineering) Old structure-perception and InChI creation options ---*/</a>
<a name="ln583"> </a>
<a name="ln584">            else if ( !stricmp( pArg, &quot;NOUUSB&quot; ) ) </a>
<a name="ln585">            {</a>
<a name="ln586">                nMode |= REQ_MODE_SB_IGN_ALL_UU;</a>
<a name="ln587">                bStdFormat = 0;</a>
<a name="ln588">            }             </a>
<a name="ln589">            else if ( !stricmp( pArg, &quot;NOUUSC&quot; ) ) </a>
<a name="ln590">            {</a>
<a name="ln591">                nMode |= REQ_MODE_SC_IGN_ALL_UU;</a>
<a name="ln592">                bStdFormat = 0;</a>
<a name="ln593">            } </a>
<a name="ln594"> </a>
<a name="ln595">#if ( FIX_ADJ_RAD == 1 )</a>
<a name="ln596">            else if ( !stricmp( pArg, &quot;FixRad&quot; ) ) </a>
<a name="ln597">            {</a>
<a name="ln598">                bFixAdjacentRad = 1;</a>
<a name="ln599">                bStdFormat = 0;</a>
<a name="ln600">            } </a>
<a name="ln601">#endif</a>
<a name="ln602">#if ( UNDERIVATIZE == 1 )</a>
<a name="ln603">            else if ( !stricmp( pArg, &quot;DoDRV&quot; ) ) </a>
<a name="ln604">            {</a>
<a name="ln605">                ip-&gt;bUnderivatize = 1;</a>
<a name="ln606">                bStdFormat = 0;</a>
<a name="ln607">            } </a>
<a name="ln608">#endif</a>
<a name="ln609">#if ( RING2CHAIN == 1 )</a>
<a name="ln610">            else if ( !stricmp( pArg, &quot;DoR2C&quot; ) ) </a>
<a name="ln611">            {</a>
<a name="ln612">                ip-&gt;bRing2Chain = 1;</a>
<a name="ln613">                bStdFormat = 0;</a>
<a name="ln614">            } </a>
<a name="ln615">#endif</a>
<a name="ln616">#if ( RING2CHAIN == 1 || UNDERIVATIZE == 1 )</a>
<a name="ln617">            else if ( !stricmp( pArg, &quot;DoneOnly&quot; ) ) </a>
<a name="ln618">            {</a>
<a name="ln619">                ip-&gt;bIngnoreUnchanged = 1;</a>
<a name="ln620">                bStdFormat = 0;</a>
<a name="ln621">            } </a>
<a name="ln622">#endif</a>
<a name="ln623">            else if ( !stricmp( pArg, &quot;NoADP&quot; ) ) </a>
<a name="ln624">            {</a>
<a name="ln625">                 bTgFlagHardAddRenProtons = 0;</a>
<a name="ln626">                 bStdFormat = 0;</a>
<a name="ln627">            } </a>
<a name="ln628">            else if ( !memicmp( pArg, &quot;DISCONSALT:&quot;, 11 ) ) </a>
<a name="ln629">            {</a>
<a name="ln630">                bDisconnectSalts = (0 != strtol(pArg+11, NULL, 10));</a>
<a name="ln631">                bStdFormat = 0;</a>
<a name="ln632">            }             </a>
<a name="ln633">            else if ( !memicmp( pArg, &quot;DISCONMETAL:&quot;, 12 ) ) </a>
<a name="ln634">            {</a>
<a name="ln635">                bDisconnectCoord = (0 != strtol(pArg+12, NULL, 10));</a>
<a name="ln636">                bStdFormat = 0;</a>
<a name="ln637">            }             </a>
<a name="ln638">            else if ( !memicmp( pArg, &quot;RECONMETAL:&quot;, 11 ) ) </a>
<a name="ln639">            {</a>
<a name="ln640">                bReconnectCoord = (0 != strtol(pArg+11, NULL, 10));</a>
<a name="ln641">                bStdFormat = 0;</a>
<a name="ln642">            }             </a>
<a name="ln643">            else if ( !memicmp( pArg, &quot;DISCONMETALCHKVAL:&quot;, 18 ) ) </a>
<a name="ln644">            {</a>
<a name="ln645">                bDisconnectCoordChkVal = (0 != strtol(pArg+18, NULL, 10));</a>
<a name="ln646">                bStdFormat = 0;</a>
<a name="ln647">            }             </a>
<a name="ln648">            else if ( !memicmp( pArg, &quot;MOVEPOS:&quot;, 8 ) ) </a>
<a name="ln649">            {</a>
<a name="ln650">                bMovePositiveCharges = (0 != strtol(pArg+8, NULL, 10));</a>
<a name="ln651">                bStdFormat = 0;</a>
<a name="ln652">            }             </a>
<a name="ln653">            else if ( !memicmp( pArg, &quot;MERGESALTTG:&quot;, 12 ) ) </a>
<a name="ln654">            {</a>
<a name="ln655">                bMergeSaltTGroups = (0 != strtol(pArg+12, NULL, 10));</a>
<a name="ln656">                bStdFormat = 0;</a>
<a name="ln657">            }             </a>
<a name="ln658">            else if ( !memicmp( pArg, &quot;UNCHARGEDACIDS:&quot;, 15) ) </a>
<a name="ln659">            {</a>
<a name="ln660">                bUnchargedAcidTaut = (0 != strtol(pArg+15, NULL, 16));</a>
<a name="ln661">                bStdFormat = 0;</a>
<a name="ln662">            }             </a>
<a name="ln663">            else if ( !memicmp( pArg, &quot;ACIDTAUT:&quot;, 9 ) ) </a>
<a name="ln664">            {</a>
<a name="ln665">                bAcidTautomerism = c = (int)strtol(pArg+9, NULL, 10);</a>
<a name="ln666">                if ( 0 &lt;= c &amp;&amp; c &lt;= 2 )  bAcidTautomerism = c;</a>
<a name="ln667">                /*else bNotRecognized = 2*bReleaseVersion;*/</a>
<a name="ln668">                bStdFormat = 0;</a>
<a name="ln669">            }             </a>
<a name="ln670"> </a>
<a name="ln671">            /*--- (hidden) Old output and other options ---*/</a>
<a name="ln672"> </a>
<a name="ln673">            else if ( !memicmp( pArg, &quot;O:&quot;, 2 ) ) </a>
<a name="ln674">            {</a>
<a name="ln675">                bNameSuffix = 1;</a>
<a name="ln676">                strncpy(szNameSuffix, pArg+2, sizeof(szNameSuffix)-1);</a>
<a name="ln677">            }             </a>
<a name="ln678">            else if ( !memicmp( pArg, &quot;OP:&quot;, 3 ) ) </a>
<a name="ln679">            {</a>
<a name="ln680">                bOutputPath = 1;</a>
<a name="ln681">                strncpy(szOutputPath, pArg+3, sizeof(szOutputPath)-1);</a>
<a name="ln682">            }             </a>
<a name="ln683">            else if ( !stricmp( pArg, &quot;ALT&quot; ) ) </a>
<a name="ln684">            {</a>
<a name="ln685">                ip-&gt;bAbcNumbers = 1;</a>
<a name="ln686">                bStdFormat = 0;</a>
<a name="ln687">            }             </a>
<a name="ln688">            else if ( !stricmp( pArg, &quot;SCT&quot; ) ) </a>
<a name="ln689">            {</a>
<a name="ln690">                ip-&gt;bCtPredecessors = 1;</a>
<a name="ln691">                bStdFormat = 0;</a>
<a name="ln692">            }             </a>
<a name="ln693">            else if ( !stricmp( pArg, &quot;CMP&quot; ) ) </a>
<a name="ln694">            {</a>
<a name="ln695">                bCompareComponents = CMP_COMPONENTS;</a>
<a name="ln696">            }             </a>
<a name="ln697">            else if ( !stricmp( pArg, &quot;CMPNONISO&quot; ) ) </a>
<a name="ln698">            {</a>
<a name="ln699">                bCompareComponents = CMP_COMPONENTS | CMP_COMPONENTS_NONISO;</a>
<a name="ln700">            } </a>
<a name="ln701">            else if ( !stricmp( pArg, &quot;PW&quot; ) ) </a>
<a name="ln702">            {</a>
<a name="ln703">                ip-&gt;bSaveWarningStructsAsProblem = 1;</a>
<a name="ln704">            }</a>
<a name="ln705"> </a>
<a name="ln706">#endif /* BUILD_WITH_ENG_OPTIONS */</a>
<a name="ln707"> </a>
<a name="ln708"> </a>
<a name="ln709">            else </a>
<a name="ln710">            {</a>
<a name="ln711">                /*for ( k = 0; c=pArg[k]; k ++ )*/</a>
<a name="ln712">                k = 0;</a>
<a name="ln713">                c=pArg[k]; /* prohibit multiple option concatenations, strict syntax check 2008-11-05 DT  */ </a>
<a name="ln714">                {</a>
<a name="ln715">                    c = toupper( c );</a>
<a name="ln716">                    switch ( c ) </a>
<a name="ln717">                    {</a>
<a name="ln718">                    case 'D':</a>
<a name="ln719">                        bDisplay |= 1;</a>
<a name="ln720">                        if ( (pArg[k+1] == 'C' || pArg[k+1] == 'c') &amp;&amp; !pArg[k+2] ) </a>
<a name="ln721">                        {</a>
<a name="ln722">                            bDisplay |= 1;</a>
<a name="ln723">                            k++;</a>
<a name="ln724">                            ip-&gt;bDisplayEachComponentINChI = 1;</a>
<a name="ln725">                        } </a>
<a name="ln726">                        else if ( !pArg[k+1] ) </a>
<a name="ln727">                        {</a>
<a name="ln728">                            bDisplay |= 1;</a>
<a name="ln729">                        }</a>
<a name="ln730">                        break;</a>
<a name="ln731">                    case 'W':</a>
<a name="ln732">                        if ( pArg[k+1] == 'D' ) </a>
<a name="ln733">                        {  </a>
<a name="ln734">                            /* restore Display Time functionality */</a>
<a name="ln735">                            c = 'D';</a>
<a name="ln736">                            k ++;</a>
<a name="ln737">                        }</a>
<a name="ln738">                        t = strtod( pArg+k+1, (char**)&amp;q ); /*  cast deliberately discards 'const' qualifier */</a>
<a name="ln739">                        if ( (q &gt; pArg+k+1 &amp;&amp; errno == ERANGE) || t &lt; 0.0 || t*1000.0 &gt; (double)ULONG_MAX)</a>
<a name="ln740">                        {</a>
<a name="ln741">                            ul = 0;</a>
<a name="ln742">                        } </a>
<a name="ln743">                        else </a>
<a name="ln744">                        {</a>
<a name="ln745">                            ul = (unsigned long)(t*1000.0);</a>
<a name="ln746">                        }</a>
<a name="ln747">                        if ( /*q &gt; pArg+k &amp;&amp;*/ !*q ) </a>
<a name="ln748">                        {</a>
<a name="ln749">                            k = q - pArg - 1; /* k will be incremented by the for() cycle */</a>
<a name="ln750">                            switch( c ) </a>
<a name="ln751">                            {</a>
<a name="ln752">                                case 'D':</a>
<a name="ln753">                                    *ulDisplTime = ul;</a>
<a name="ln754">                                    break;</a>
<a name="ln755">                                case 'W':</a>
<a name="ln756">                                    ip-&gt;msec_MaxTime = ul;</a>
<a name="ln757">                                    break;</a>
<a name="ln758">                            }</a>
<a name="ln759">                        }</a>
<a name="ln760">                        break;</a>
<a name="ln761">                    case 'F':</a>
<a name="ln762">                        c =  (int)strtol( pArg+k+1, (char**)&amp;q, 10 ); /*  cast deliberately discards 'const' qualifier */</a>
<a name="ln763">                        if ( q &gt; pArg+k &amp;&amp; !*q ) </a>
<a name="ln764">                        {</a>
<a name="ln765">                            k = q - pArg - 1;</a>
<a name="ln766">                            if ( abs(c) &gt; 5 ) </a>
<a name="ln767">                            {</a>
<a name="ln768">                                nFontSize = -c;  /* font size 5 or less is too small */</a>
<a name="ln769">                            }</a>
<a name="ln770">                        }</a>
<a name="ln771">                        break;</a>
<a name="ln772">                    default:</a>
<a name="ln773">                        if ( !pArg[k+1] ) </a>
<a name="ln774">                        {</a>
<a name="ln775">                            switch ( c ) </a>
<a name="ln776">                            {</a>
<a name="ln777">                            case 'B':</a>
<a name="ln778">                                nMode |= REQ_MODE_BASIC;</a>
<a name="ln779">                                nReleaseMode = 0;</a>
<a name="ln780">                                /*bNotRecognized = bReleaseVersion;*/</a>
<a name="ln781">                                bStdFormat = 0;</a>
<a name="ln782">                                break;</a>
<a name="ln783">                            case 'T':</a>
<a name="ln784">                                nMode |= REQ_MODE_TAUT;</a>
<a name="ln785">                                nReleaseMode = 0;</a>
<a name="ln786">                                /*bNotRecognized = bReleaseVersion;*/</a>
<a name="ln787">                                break;</a>
<a name="ln788">                            case 'I':</a>
<a name="ln789">                                nMode |= REQ_MODE_ISO;</a>
<a name="ln790">                                nReleaseMode = 0;</a>
<a name="ln791">                                /*bNotRecognized = bReleaseVersion;*/</a>
<a name="ln792">                                break;</a>
<a name="ln793">                            case 'N':</a>
<a name="ln794">                                nMode |= REQ_MODE_NON_ISO;</a>
<a name="ln795">                                nReleaseMode = 0;</a>
<a name="ln796">                                bStdFormat = 0;</a>
<a name="ln797">                                /*bNotRecognized = bReleaseVersion;*/</a>
<a name="ln798">                                break;</a>
<a name="ln799">                            case 'S':</a>
<a name="ln800">                                nMode |= REQ_MODE_STEREO;</a>
<a name="ln801">                                nReleaseMode = 0;</a>
<a name="ln802">                                /*bNotRecognized = bReleaseVersion;*/</a>
<a name="ln803">                                break;</a>
<a name="ln804">                            case 'E':</a>
<a name="ln805">                                if ( nReleaseMode &amp; REQ_MODE_STEREO ) </a>
<a name="ln806">                                {</a>
<a name="ln807">                                    nReleaseMode ^= REQ_MODE_STEREO;</a>
<a name="ln808">                                    bStdFormat = 0;</a>
<a name="ln809">                                }</a>
<a name="ln810">                                break;</a>
<a name="ln811">#ifndef TARGET_LIB_FOR_WINCHI</a>
<a name="ln812">                            default:</a>
<a name="ln813">                                inchi_ios_eprint(log_file, &quot;Unrecognized option: \&quot;%c\&quot;.\n&quot;, c);</a>
<a name="ln814"> </a>
<a name="ln815">#endif</a>
<a name="ln816">                            }</a>
<a name="ln817">                        } </a>
<a name="ln818"> </a>
<a name="ln819"> </a>
<a name="ln820">#ifndef TARGET_LIB_FOR_WINCHI</a>
<a name="ln821">                        else </a>
<a name="ln822">                        {</a>
<a name="ln823">                            inchi_ios_eprint(log_file, &quot;Unrecognized option: \&quot;%c\&quot;.\n&quot;, c);</a>
<a name="ln824">                        }</a>
<a name="ln825">#endif</a>
<a name="ln826">                    }</a>
<a name="ln827">                    /*</a>
<a name="ln828">                    if ( bNotRecognized &amp;&amp; bNotRecognized == bReleaseVersion ) {</a>
<a name="ln829">                        inchi_ios_eprint(stderr, &quot;Unrecognized option: \&quot;%c\&quot;.\n&quot;, c);</a>
<a name="ln830">                        bNotRecognized = 0;</a>
<a name="ln831">                    }</a>
<a name="ln832">                    */</a>
<a name="ln833">                }</a>
<a name="ln834">            }</a>
<a name="ln835"> </a>
<a name="ln836"> </a>
<a name="ln837">            /*</a>
<a name="ln838">            if ( bNotRecognized &amp;&amp; bNotRecognized == 2*bReleaseVersion ) </a>
<a name="ln839">            {</a>
<a name="ln840">               inchi_ios_eprint(stderr, &quot;Unrecognized option: \&quot;%s\&quot;.\n&quot;, argv[i]);</a>
<a name="ln841">               bNotRecognized = 0;</a>
<a name="ln842">            }</a>
<a name="ln843">            */</a>
<a name="ln844"> </a>
<a name="ln845">        } </a>
<a name="ln846">        /*=== end of parsing TARGET_LIB_FOR_WINCHI GUI (and v. 0.9xx Beta)options ===*/</a>
<a name="ln847"> </a>
<a name="ln848"> </a>
<a name="ln849">                </a>
<a name="ln850"> </a>
<a name="ln851">        else if ( (bVer1Options &amp; 1) &amp;&amp; INCHI_OPTION_PREFX == argv[i][0] &amp;&amp; argv[i][1] ) </a>
<a name="ln852">        {</a>
<a name="ln853">        /*=== parsing stand-alone/library InChI options ===*/</a>
<a name="ln854"> </a>
<a name="ln855"> </a>
<a name="ln856">            pArg = argv[i] + 1;</a>
<a name="ln857"> </a>
<a name="ln858">            bRecognizedOption = 2;</a>
<a name="ln859">            bVer1Options += 2;</a>
<a name="ln860">            /* always on: REQ_MODE_TAUT | REQ_MODE_ISO | REQ_MODE_STEREO */</a>
<a name="ln861">#ifdef CML_DEBUG</a>
<a name="ln862">            printf (&quot;1 argv %d %s\n&quot;, i, argv[i]);</a>
<a name="ln863">#endif</a>
<a name="ln864"> </a>
<a name="ln865">            </a>
<a name="ln866">            /*--- Input options ---*/</a>
<a name="ln867">            if ( !stricmp( pArg, &quot;STDIO&quot; ) ) </a>
<a name="ln868">            {</a>
<a name="ln869">                bNameSuffix = 0;</a>
<a name="ln870">            }             </a>
<a name="ln871">            else if ( !stricmp( pArg, &quot;INPAUX&quot; ))</a>
<a name="ln872">            {</a>
<a name="ln873">                if (INPUT_NONE == ip-&gt;nInputType) </a>
<a name="ln874">                    ip-&gt;nInputType = INPUT_INCHI_PLAIN;</a>
<a name="ln875">            }             </a>
<a name="ln876">            else if ( /* INPUT_NONE == ip-&gt;nInputType &amp;&amp;*/</a>
<a name="ln877">                    !memicmp( pArg, &quot;SDF:&quot;, 4 )  ) </a>
<a name="ln878">            {</a>
<a name="ln879">                 /* SDfile label */</a>
<a name="ln880">                k = 0;</a>
<a name="ln881">                mystrncpy( ip-&gt;szSdfDataHeader, pArg+4, MAX_SDF_HEADER+1 );</a>
<a name="ln882">                LtrimRtrim( ip-&gt;szSdfDataHeader, &amp;k );</a>
<a name="ln883">                if ( k ) </a>
<a name="ln884">                {</a>
<a name="ln885">                    ip-&gt;pSdfLabel  = ip-&gt;szSdfDataHeader;</a>
<a name="ln886">                    ip-&gt;pSdfValue  = szSdfDataValue;</a>
<a name="ln887">                    if ( INPUT_NONE == ip-&gt;nInputType ) </a>
<a name="ln888">                    {</a>
<a name="ln889">                        ip-&gt;nInputType = INPUT_SDFILE;</a>
<a name="ln890">                    }</a>
<a name="ln891">                } </a>
<a name="ln892">                else </a>
<a name="ln893">                {</a>
<a name="ln894">                    ip-&gt;pSdfLabel  = NULL;</a>
<a name="ln895">                    ip-&gt;pSdfValue  = NULL;</a>
<a name="ln896">                    if ( INPUT_NONE == ip-&gt;nInputType ) </a>
<a name="ln897">                    {</a>
<a name="ln898">                        ip-&gt;nInputType = INPUT_MOLFILE;</a>
<a name="ln899">                    }</a>
<a name="ln900">                }</a>
<a name="ln901">            }</a>
<a name="ln902"> </a>
<a name="ln903">#if ( ADD_CMLPP == 1 )</a>
<a name="ln904">            else if ( INPUT_NONE == ip-&gt;nInputType &amp;&amp; !stricmp( pArg, &quot;CML&quot; )  ) </a>
<a name="ln905">            {</a>
<a name="ln906">                /* CMLfile label */</a>
<a name="ln907">                ip-&gt;nInputType = INPUT_CMLFILE;</a>
<a name="ln908">            } </a>
<a name="ln909">#endif</a>
<a name="ln910">            else if ( !memicmp( pArg, &quot;START:&quot;, 6 ) ) </a>
<a name="ln911">            {</a>
<a name="ln912">                ip-&gt;first_struct_number = strtol(pArg+6, NULL, 10);</a>
<a name="ln913">            }             </a>
<a name="ln914">            else if ( !memicmp( pArg, &quot;END:&quot;, 4 ) ) </a>
<a name="ln915">            {</a>
<a name="ln916">                ip-&gt;last_struct_number = strtol(pArg+4, NULL, 10);</a>
<a name="ln917">            }             </a>
<a name="ln918">#ifdef BUILD_WITH_ENG_OPTIONS</a>
<a name="ln919">            else if ( !memicmp( pArg, &quot;RSB:&quot;, 4 )) </a>
<a name="ln920">            {</a>
<a name="ln921">                mdbr = (int)strtol(pArg+4, NULL, 10);</a>
<a name="ln922">            } </a>
<a name="ln923">#endif</a>
<a name="ln924"> </a>
<a name="ln925"> </a>
<a name="ln926">            /*--- Output options ---*/</a>
<a name="ln927">#if ( !defined(TARGET_API_LIB) &amp;&amp; !defined(TARGET_LIB_FOR_WINCHI) )</a>
<a name="ln928">            else if ( !stricmp( pArg, &quot;Tabbed&quot; ) ) </a>
<a name="ln929">            {</a>
<a name="ln930">                bXml |=  INCHI_OUT_TABBED_OUTPUT;</a>
<a name="ln931">            } </a>
<a name="ln932">#endif</a>
<a name="ln933">            else if ( !stricmp( pArg, &quot;NOLABELS&quot; ) ) </a>
<a name="ln934">            {</a>
<a name="ln935">                 bNoStructLabels = 1;</a>
<a name="ln936">            } </a>
<a name="ln937">            else if ( !stricmp( pArg, &quot;SAVEOPT&quot; ) ) </a>
<a name="ln938">            {</a>
<a name="ln939">                 bINChIOutputOptions |= INCHI_OUT_SAVEOPT;</a>
<a name="ln940">            } </a>
<a name="ln941">            else if ( !stricmp( pArg, &quot;AUXNONE&quot; ) ) </a>
<a name="ln942">            {    </a>
<a name="ln943">                /* no aux. info */</a>
<a name="ln944">                bINChIOutputOptions |= INCHI_OUT_NO_AUX_INFO;  /* no aux info */</a>
<a name="ln945">                bINChIOutputOptions &amp;= ~INCHI_OUT_SHORT_AUX_INFO;</a>
<a name="ln946">            } </a>
<a name="ln947">            else if ( !stricmp( pArg, &quot;OUTPUTSDF&quot; ) ) </a>
<a name="ln948">            {  </a>
<a name="ln949">                /* output SDfile */</a>
<a name="ln950">                bOutputMolfileOnly = 1;</a>
<a name="ln951">            }             </a>
<a name="ln952">            else if ( !stricmp( pArg, &quot;SdfAtomsDT&quot; ) ) </a>
<a name="ln953">            {  </a>
<a name="ln954">                /* output isotopes H as D and T in SDfile */</a>
<a name="ln955">                bOutputMolfileDT = 1;</a>
<a name="ln956">            } </a>
<a name="ln957">            else if ( !stricmp( pArg, &quot;D&quot; ) ) </a>
<a name="ln958">            {          </a>
<a name="ln959">                /* display the structures */</a>
<a name="ln960">                bDisplay |= 1;</a>
<a name="ln961">            } </a>
<a name="ln962">            else if ( !memicmp( pArg, &quot;F&quot;, 1 ) &amp;&amp; (c =  (int)strtol( pArg+1, (char**)&amp;q, 10 ), q &gt; pArg+1) ) </a>
<a name="ln963">            {</a>
<a name="ln964">                nFontSize = -c;                      /* struct. display font size */</a>
<a name="ln965">            } </a>
<a name="ln966">            else if ( !stricmp( pArg, &quot;EQU&quot; ) ) </a>
<a name="ln967">            {</a>
<a name="ln968">                bCompareComponents = CMP_COMPONENTS;</a>
<a name="ln969">            } </a>
<a name="ln970"> </a>
<a name="ln971"> </a>
<a name="ln972">            /*--- All modes (std and non-std InChI) structure perception options ---*/</a>
<a name="ln973">            else if ( !stricmp( pArg, &quot;SNON&quot; ) ) </a>
<a name="ln974">            {</a>
<a name="ln975">                bVer1DefaultMode &amp;= ~REQ_MODE_STEREO; /* no stereo */</a>
<a name="ln976">                nMode &amp;= ~(REQ_MODE_RACEMIC_STEREO | REQ_MODE_RELATIVE_STEREO | REQ_MODE_CHIR_FLG_STEREO);</a>
<a name="ln977">            } </a>
<a name="ln978">            else if ( !stricmp( pArg, &quot;NEWPSOFF&quot; ) ) </a>
<a name="ln979">            {</a>
<a name="ln980">                 bPointedEdgeStereo = 0;</a>
<a name="ln981">            } </a>
<a name="ln982">            else if ( !stricmp( pArg, &quot;DONOTADDH&quot; ) ) </a>
<a name="ln983">            {</a>
<a name="ln984">                bDoNotAddH = 1;</a>
<a name="ln985">            }</a>
<a name="ln986"> </a>
<a name="ln987"> </a>
<a name="ln988">            /* Non-standard */</a>
<a name="ln989">#ifndef USE_STDINCHI_API</a>
<a name="ln990"> </a>
<a name="ln991">            /* Non-std InChI structure perception options */</a>
<a name="ln992"> </a>
<a name="ln993">            else if ( !stricmp( pArg, &quot;SREL&quot; ) ) </a>
<a name="ln994">            {</a>
<a name="ln995">                bVer1DefaultMode |= REQ_MODE_STEREO;  /* relative stereo */</a>
<a name="ln996">                nMode &amp;= ~(REQ_MODE_RACEMIC_STEREO | REQ_MODE_CHIR_FLG_STEREO);</a>
<a name="ln997">                nMode |= REQ_MODE_RELATIVE_STEREO;</a>
<a name="ln998">                bStdFormat = 0;</a>
<a name="ln999">            }             </a>
<a name="ln1000">            else  if ( !stricmp( pArg, &quot;SRAC&quot; ) ) </a>
<a name="ln1001">            {</a>
<a name="ln1002">                /* REQ_MODE_CHIR_FLG_STEREO */</a>
<a name="ln1003">                bVer1DefaultMode |= REQ_MODE_STEREO;  /* racemic stereo */</a>
<a name="ln1004">                nMode &amp;= ~(REQ_MODE_RELATIVE_STEREO | REQ_MODE_CHIR_FLG_STEREO);</a>
<a name="ln1005">                nMode |= REQ_MODE_RACEMIC_STEREO;</a>
<a name="ln1006">                bStdFormat = 0;</a>
<a name="ln1007">            }             </a>
<a name="ln1008">            else if ( !stricmp( pArg, &quot;SUCF&quot; ) ) </a>
<a name="ln1009">            {</a>
<a name="ln1010">                bVer1DefaultMode |= REQ_MODE_STEREO;  /* stereo defined by the Chiral flag */</a>
<a name="ln1011">                nMode &amp;= ~(REQ_MODE_RELATIVE_STEREO | REQ_MODE_RACEMIC_STEREO);</a>
<a name="ln1012">                nMode |= REQ_MODE_CHIR_FLG_STEREO;</a>
<a name="ln1013">                bStdFormat = 0;</a>
<a name="ln1014">            }             </a>
<a name="ln1015">            else if ( !stricmp( pArg, &quot;ChiralFlagON&quot; ) ) </a>
<a name="ln1016">            { </a>
<a name="ln1017">                /* used only with /SUCF */</a>
<a name="ln1018">                /* NB: do not toggle off bStdFormat! (if necessary SUCF will do) */</a>
<a name="ln1019">                bForcedChiralFlag &amp;= ~FLAG_SET_INP_AT_NONCHIRAL;</a>
<a name="ln1020">                bForcedChiralFlag |= FLAG_SET_INP_AT_CHIRAL;</a>
<a name="ln1021">            }             </a>
<a name="ln1022">            else if ( !stricmp( pArg, &quot;ChiralFlagOFF&quot; ) ) </a>
<a name="ln1023">            { </a>
<a name="ln1024">                /* used only with /SUCF */</a>
<a name="ln1025">                /* NB: do not toggle off bStdFormat! (if necessary SUCF will do) */</a>
<a name="ln1026">                bForcedChiralFlag &amp;= ~FLAG_SET_INP_AT_CHIRAL;</a>
<a name="ln1027">                bForcedChiralFlag |= FLAG_SET_INP_AT_NONCHIRAL;</a>
<a name="ln1028">            }             </a>
<a name="ln1029"> </a>
<a name="ln1030"> </a>
<a name="ln1031">            /*--- Non-std InChI creation options ---*/</a>
<a name="ln1032"> </a>
<a name="ln1033">            /* Stereo */</a>
<a name="ln1034">            else if ( !stricmp( pArg, &quot;SUU&quot; ) ) </a>
<a name="ln1035">            {       </a>
<a name="ln1036">                /* include omitted undef/unknown stereo */</a>
<a name="ln1037">                bVer1DefaultMode &amp;= ~(REQ_MODE_SB_IGN_ALL_UU | REQ_MODE_SC_IGN_ALL_UU);</a>
<a name="ln1038">                bStdFormat = 0;</a>
<a name="ln1039">            } </a>
<a name="ln1040">            else if ( !stricmp( pArg, &quot;SLUUD&quot; ) ) </a>
<a name="ln1041">            {       </a>
<a name="ln1042">               /* Make labels for unknown and undefined stereo different */</a>
<a name="ln1043">                bVer1DefaultMode |= REQ_MODE_DIFF_UU_STEREO;</a>
<a name="ln1044">                bStdFormat = 0;</a>
<a name="ln1045">            } </a>
<a name="ln1046">            /* FixedH */</a>
<a name="ln1047">            else if ( !stricmp( pArg, &quot;FIXEDH&quot; ) ) </a>
<a name="ln1048">            {</a>
<a name="ln1049">                bVer1DefaultMode |= REQ_MODE_BASIC;  /* tautomeric */</a>
<a name="ln1050">                bStdFormat = 0;</a>
<a name="ln1051">            }             </a>
<a name="ln1052">            /* RecMet */</a>
<a name="ln1053">            else if ( !stricmp( pArg, &quot;RECMET&quot; ) ) </a>
<a name="ln1054">            {    </a>
<a name="ln1055">                /* reconnect metals */</a>
<a name="ln1056">                bReconnectCoord = 1;</a>
<a name="ln1057">                bStdFormat = 0;</a>
<a name="ln1058">            } </a>
<a name="ln1059">#if ( KETO_ENOL_TAUT == 1 )</a>
<a name="ln1060">            else if ( !stricmp( pArg, &quot;KET&quot; ) ) </a>
<a name="ln1061">            {</a>
<a name="ln1062">                bKetoEnolTaut = 1;</a>
<a name="ln1063">                bStdFormat = 0;</a>
<a name="ln1064">            } </a>
<a name="ln1065">#endif</a>
<a name="ln1066">#if ( TAUT_15_NON_RING == 1 )</a>
<a name="ln1067">            else if ( !stricmp( pArg, &quot;15T&quot; ) ) </a>
<a name="ln1068">            {</a>
<a name="ln1069">                b15TautNonRing = 1;</a>
<a name="ln1070">                bStdFormat = 0;</a>
<a name="ln1071">            } </a>
<a name="ln1072">#endif</a>
<a name="ln1073"> </a>
<a name="ln1074">#endif</a>
<a name="ln1075"> </a>
<a name="ln1076">            /*--- Generation options ---*/</a>
<a name="ln1077">            else if ( !memicmp( pArg, &quot;W&quot;, 1 ) &amp;&amp; (t = strtod( pArg+1, (char**)&amp;q ), q &gt; pArg+1) ) </a>
<a name="ln1078">            {</a>
<a name="ln1079">                if ( errno == ERANGE || t &lt; 0.0 || t*1000.0 &gt; (double)ULONG_MAX)  </a>
<a name="ln1080">                {</a>
<a name="ln1081">                    ul = 0;</a>
<a name="ln1082">                } </a>
<a name="ln1083">                else </a>
<a name="ln1084">                {</a>
<a name="ln1085">                    ul = (unsigned long)(t*1000.0);  /* max. time per structure */</a>
<a name="ln1086">                }</a>
<a name="ln1087">                ip-&gt;msec_MaxTime = ul;</a>
<a name="ln1088">            }             </a>
<a name="ln1089">            else if ( !stricmp( pArg, &quot;WarnOnEmptyStructure&quot; ) ) </a>
<a name="ln1090">            {</a>
<a name="ln1091">                 ip-&gt;bAllowEmptyStructure = 1;</a>
<a name="ln1092">            } </a>
<a name="ln1093"> </a>
<a name="ln1094">            /* InChIKey/InChI hash */</a>
<a name="ln1095">            else if ( !stricmp( pArg, &quot;Key&quot; ) ) </a>
<a name="ln1096">            {</a>
<a name="ln1097">                bHashKey = 1;</a>
<a name="ln1098">            }            </a>
<a name="ln1099">            else if ( !stricmp( pArg, &quot;XHash1&quot; ) ) </a>
<a name="ln1100">            {</a>
<a name="ln1101">                bHashXtra1 = 1;</a>
<a name="ln1102">            }            </a>
<a name="ln1103">            else if ( !stricmp( pArg, &quot;XHash2&quot; ) ) </a>
<a name="ln1104">            {</a>
<a name="ln1105">                bHashXtra2 = 1;</a>
<a name="ln1106">            }            </a>
<a name="ln1107"> </a>
<a name="ln1108"> </a>
<a name="ln1109">            /*--- Conversion modes ---*/           </a>
<a name="ln1110"> </a>
<a name="ln1111"> </a>
<a name="ln1112">#if ( READ_INCHI_STRING == 1 )</a>
<a name="ln1113">            else if ( !stricmp( pArg, &quot;InChI2InChI&quot; )  ) </a>
<a name="ln1114">            {</a>
<a name="ln1115">                 /* Read InChI Identifiers and output InChI Identifiers */</a>
<a name="ln1116">                ip-&gt;nInputType = INPUT_INCHI;</a>
<a name="ln1117">                ip-&gt;bReadInChIOptions |= READ_INCHI_OUTPUT_INCHI;</a>
<a name="ln1118">                ip-&gt;bReadInChIOptions &amp;= ~READ_INCHI_TO_STRUCTURE;</a>
<a name="ln1119">            } </a>
<a name="ln1120">            else if ( !stricmp( pArg, &quot;InChI2Struct&quot; )  ) </a>
<a name="ln1121">            {</a>
<a name="ln1122">                 /* Split InChI Identifiers into components */</a>
<a name="ln1123">                ip-&gt;bReadInChIOptions |= READ_INCHI_TO_STRUCTURE;</a>
<a name="ln1124">                ip-&gt;bReadInChIOptions &amp;= ~READ_INCHI_OUTPUT_INCHI;</a>
<a name="ln1125">                ip-&gt;nInputType = INPUT_INCHI;</a>
<a name="ln1126">            } </a>
<a name="ln1127">#ifdef BUILD_WITH_ENG_OPTIONS</a>
<a name="ln1128">            else if ( !stricmp( pArg, &quot;KeepBalanceP&quot; )  ) </a>
<a name="ln1129">            {</a>
<a name="ln1130">                 /* When spliting InChI Identifiers into components: */</a>
<a name="ln1131">                 /* If MobileH output then add p to each component;  */</a>
<a name="ln1132">                 /* Otherwise add one more component containing balance */</a>
<a name="ln1133">                 /* of protons and exchangeable isotopic H */</a>
<a name="ln1134">                ip-&gt;bReadInChIOptions |= READ_INCHI_KEEP_BALANCE_P;</a>
<a name="ln1135">                bStdFormat = 0;</a>
<a name="ln1136">            } </a>
<a name="ln1137">#endif</a>
<a name="ln1138">#endif</a>
<a name="ln1139"> </a>
<a name="ln1140">          </a>
<a name="ln1141">            </a>
<a name="ln1142">            /*--- (engineering) Undo bug/draw fixes options ---*/</a>
<a name="ln1143">#ifdef BUILD_WITH_ENG_OPTIONS</a>
<a name="ln1144">            else if ( !stricmp( pArg, &quot;FixSp3bugOFF&quot; ) ) </a>
<a name="ln1145">            {</a>
<a name="ln1146">                 bFixSp3bug = 0;</a>
<a name="ln1147">                 bStdFormat = 0;</a>
<a name="ln1148">            }             </a>
<a name="ln1149">            else if ( !stricmp( pArg, &quot;FBOFF&quot; ) ) </a>
<a name="ln1150">            {</a>
<a name="ln1151">                 bFixSp3bug = 0;</a>
<a name="ln1152">                 bStdFormat = 0;</a>
<a name="ln1153">            }             </a>
<a name="ln1154">            else if ( !stricmp( pArg, &quot;FB2OFF&quot; ) ) </a>
<a name="ln1155">            {</a>
<a name="ln1156">                 bFixFB2 = 0;</a>
<a name="ln1157">                 bStdFormat = 0;</a>
<a name="ln1158">            }             </a>
<a name="ln1159">            else if ( !stricmp( pArg, &quot;SPXYZOFF&quot; ) ) </a>
<a name="ln1160">            {</a>
<a name="ln1161">                 bAddPhosphineStereo = 0;</a>
<a name="ln1162">                 bStdFormat = 0;</a>
<a name="ln1163">            } </a>
<a name="ln1164">            else if ( !stricmp( pArg, &quot;SASXYZOFF&quot; ) ) </a>
<a name="ln1165">            {</a>
<a name="ln1166">                 bAddArsineStereo = 0;</a>
<a name="ln1167">                 bStdFormat = 0;</a>
<a name="ln1168">            } </a>
<a name="ln1169">            else if ( !stricmp( pArg, &quot;FNUDOFF&quot; ) ) </a>
<a name="ln1170">            {</a>
<a name="ln1171">                 ip-&gt;bFixNonUniformDraw = 0;</a>
<a name="ln1172">                 bStdFormat = 0;</a>
<a name="ln1173">            } </a>
<a name="ln1174"> </a>
<a name="ln1175">            /*--- (engineering) Old structure-perception and InChI creation options ---*/</a>
<a name="ln1176">#if ( FIX_ADJ_RAD == 1 )</a>
<a name="ln1177">            else if ( !stricmp( pArg, &quot;FixRad&quot; ) ) </a>
<a name="ln1178">            {</a>
<a name="ln1179">                bFixAdjacentRad = 1;</a>
<a name="ln1180">                bStdFormat = 0;</a>
<a name="ln1181">            } </a>
<a name="ln1182">#endif</a>
<a name="ln1183">#if ( UNDERIVATIZE == 1 )</a>
<a name="ln1184">            else if ( !stricmp( pArg, &quot;DoDRV&quot; ) ) </a>
<a name="ln1185">            {</a>
<a name="ln1186">                ip-&gt;bUnderivatize = 1;</a>
<a name="ln1187">                bStdFormat = 0;</a>
<a name="ln1188">            } </a>
<a name="ln1189">#endif</a>
<a name="ln1190">#if ( RING2CHAIN == 1 )</a>
<a name="ln1191">            else if ( !stricmp( pArg, &quot;DoR2C&quot; ) ) </a>
<a name="ln1192">            {</a>
<a name="ln1193">                ip-&gt;bRing2Chain = 1;</a>
<a name="ln1194">                bStdFormat = 0;</a>
<a name="ln1195">            } </a>
<a name="ln1196">#endif</a>
<a name="ln1197">#if ( RING2CHAIN == 1 || UNDERIVATIZE == 1 )</a>
<a name="ln1198">            else if ( !stricmp( pArg, &quot;DoneOnly&quot; ) ) </a>
<a name="ln1199">            {</a>
<a name="ln1200">                ip-&gt;bIngnoreUnchanged = 1;</a>
<a name="ln1201">                bStdFormat = 0;</a>
<a name="ln1202">            } </a>
<a name="ln1203">#endif</a>
<a name="ln1204"> </a>
<a name="ln1205">            else if ( !memicmp( pArg, &quot;MOVEPOS:&quot;, 8 ) ) </a>
<a name="ln1206">            {</a>
<a name="ln1207">                bMovePositiveCharges = (0 != strtol(pArg+8, NULL, 10));</a>
<a name="ln1208">                bStdFormat = 0;</a>
<a name="ln1209">            }             </a>
<a name="ln1210"> </a>
<a name="ln1211">            else if ( !stricmp( pArg, &quot;NoADP&quot; ) ) </a>
<a name="ln1212">            {</a>
<a name="ln1213">                 bTgFlagHardAddRenProtons = 0;</a>
<a name="ln1214">                 bStdFormat = 0;</a>
<a name="ln1215">            } </a>
<a name="ln1216">            /* Tautomer perception off */</a>
<a name="ln1217">            else if ( !stricmp( pArg, &quot;EXACT&quot; ) ) </a>
<a name="ln1218">            {</a>
<a name="ln1219">                bVer1DefaultMode |= REQ_MODE_BASIC;</a>
<a name="ln1220">                bStdFormat = 0;</a>
<a name="ln1221">            } </a>
<a name="ln1222">            else if ( !stricmp( pArg, &quot;ONLYRECSALT&quot; ) ) </a>
<a name="ln1223">            {  </a>
<a name="ln1224">                /* do not disconnect salts */</a>
<a name="ln1225">                bDisconnectSalts = 0;</a>
<a name="ln1226">                bStdFormat = 0;</a>
<a name="ln1227">            } </a>
<a name="ln1228">            else if ( !stricmp( pArg, &quot;ONLYEXACT&quot; ) || !stricmp( pArg, &quot;ONLYFIXEDH&quot; ) ) </a>
<a name="ln1229">            {</a>
<a name="ln1230">                bVer1DefaultMode |=  REQ_MODE_BASIC;</a>
<a name="ln1231">                bVer1DefaultMode &amp;= ~REQ_MODE_TAUT;</a>
<a name="ln1232">                bStdFormat = 0;</a>
<a name="ln1233">            }             </a>
<a name="ln1234">            else if ( !stricmp( pArg, &quot;ONLYNONISO&quot; ) ) </a>
<a name="ln1235">            {</a>
<a name="ln1236">                bVer1DefaultMode |=  REQ_MODE_NON_ISO;</a>
<a name="ln1237">                bVer1DefaultMode &amp;= ~REQ_MODE_ISO;</a>
<a name="ln1238">                bStdFormat = 0;</a>
<a name="ln1239">            }             </a>
<a name="ln1240">            else if ( !stricmp( pArg, &quot;TAUT&quot; ) ) </a>
<a name="ln1241">            {</a>
<a name="ln1242">                bVer1DefaultMode &amp;= ~REQ_MODE_BASIC;</a>
<a name="ln1243">                bVer1DefaultMode |= REQ_MODE_TAUT;</a>
<a name="ln1244">            }             </a>
<a name="ln1245">            else if ( !stricmp( pArg, &quot;ONLYRECMET&quot; ) ) </a>
<a name="ln1246">            {  </a>
<a name="ln1247">                /* do not disconnect metals */</a>
<a name="ln1248">                bDisconnectCoord = 0;</a>
<a name="ln1249">                bStdFormat = 0;</a>
<a name="ln1250">            }</a>
<a name="ln1251"> </a>
<a name="ln1252">            /*--- (hidden) Old output and other options ---*/</a>
<a name="ln1253"> </a>
<a name="ln1254">            else if ( !stricmp( pArg, &quot;SdfSplit&quot; ) ) </a>
<a name="ln1255">            {  </a>
<a name="ln1256">                /* Split single Molfiles into disconnected components */</a>
<a name="ln1257">                bOutputMolfileSplit = 1;</a>
<a name="ln1258">            } </a>
<a name="ln1259">            else if ( !stricmp( pArg, &quot;DCR&quot; ) ) </a>
<a name="ln1260">            {</a>
<a name="ln1261">                bDisplayCompositeResults = 1;</a>
<a name="ln1262">            } </a>
<a name="ln1263">            else if ( !stricmp( pArg, &quot;AUXFULL&quot; ) || !stricmp( pArg, &quot;AUXMAX&quot; ) ) </a>
<a name="ln1264">            {     </a>
<a name="ln1265">                /* full aux info */</a>
<a name="ln1266">                bINChIOutputOptions &amp;= ~(INCHI_OUT_NO_AUX_INFO | INCHI_OUT_SHORT_AUX_INFO); /* include short aux info */</a>
<a name="ln1267">            }             </a>
<a name="ln1268">            else if ( !stricmp( pArg, &quot;AUXMIN&quot; ) ) </a>
<a name="ln1269">            {     </a>
<a name="ln1270">                /* minimal aux info */</a>
<a name="ln1271">                bINChIOutputOptions &amp;= ~INCHI_OUT_NO_AUX_INFO; /* include short aux info */</a>
<a name="ln1272">                bINChIOutputOptions |= INCHI_OUT_SHORT_AUX_INFO;</a>
<a name="ln1273">            } </a>
<a name="ln1274">#if ( READ_INCHI_STRING == 1 )</a>
<a name="ln1275">            else if ( !stricmp( pArg, &quot;DDSRC&quot; ) ) </a>
<a name="ln1276">            {</a>
<a name="ln1277">                bDisplayIfRestoreWarnings = 1;  /* InChI-&gt;Structure debugging: Display Debug Structure Restore Components */</a>
<a name="ln1278">            }</a>
<a name="ln1279">#endif</a>
<a name="ln1280">            else if ( !stricmp( pArg, &quot;NoVarH&quot; ) ) </a>
<a name="ln1281">            {</a>
<a name="ln1282">                 bTgFlagVariableProtons = 0;</a>
<a name="ln1283">            }             </a>
<a name="ln1284">            else if ( !stricmp( pArg, &quot;FULL&quot; ) ) </a>
<a name="ln1285">            {</a>
<a name="ln1286">                bVer1DefaultMode       = VER103_DEFAULT_MODE;</a>
<a name="ln1287">                nMode                = 0;</a>
<a name="ln1288">                bReconnectCoord      = 1;            /* full output */</a>
<a name="ln1289">                bINChIOutputOptions   = ((EMBED_REC_METALS_INCHI==1)? INCHI_OUT_EMBED_REC   : 0) | INCHI_OUT_SHORT_AUX_INFO;</a>
<a name="ln1290">                ip-&gt;bCtPredecessors  = 0;</a>
<a name="ln1291">                ip-&gt;bAbcNumbers      = 0;</a>
<a name="ln1292">                bXml                 |=  INCHI_OUT_PLAIN_TEXT | INCHI_OUT_PLAIN_TEXT_COMMENTS;</a>
<a name="ln1293">                bXml                 &amp;= ~(INCHI_OUT_XML | INCHI_OUT_XML_TEXT_COMMENTS);</a>
<a name="ln1294">            }             </a>
<a name="ln1295">            else if ( !stricmp( pArg, &quot;MIN&quot; ) ) </a>
<a name="ln1296">            {</a>
<a name="ln1297">                bVer1DefaultMode     = VER103_DEFAULT_MODE;</a>
<a name="ln1298">                nMode                = 0;</a>
<a name="ln1299">                bReconnectCoord      = 1;            /* minimal output */</a>
<a name="ln1300">                bINChIOutputOptions   = ((EMBED_REC_METALS_INCHI==1)? INCHI_OUT_EMBED_REC   : 0) | INCHI_OUT_NO_AUX_INFO;            /* minimal compressed output */</a>
<a name="ln1301">                ip-&gt;bCtPredecessors  = 1;</a>
<a name="ln1302">                ip-&gt;bAbcNumbers      = 1;</a>
<a name="ln1303">                bXml                |= INCHI_OUT_PLAIN_TEXT | INCHI_OUT_PLAIN_TEXT_COMMENTS;</a>
<a name="ln1304">                bXml                &amp;= ~(INCHI_OUT_XML | INCHI_OUT_XML_TEXT_COMMENTS);</a>
<a name="ln1305">            } </a>
<a name="ln1306">            else if ( !stricmp( pArg, &quot;COMPRESS&quot; ) ) </a>
<a name="ln1307">            {</a>
<a name="ln1308">                ip-&gt;bAbcNumbers = 1;</a>
<a name="ln1309">                ip-&gt;bCtPredecessors = 1;             /* compressed output */</a>
<a name="ln1310">            } </a>
<a name="ln1311"> </a>
<a name="ln1312">#if ( READ_INCHI_STRING == 1 )</a>
<a name="ln1313">            else if ( !stricmp( pArg, &quot;InChI2InChI&quot; )  ) </a>
<a name="ln1314">            {</a>
<a name="ln1315">                 /* Read InChI Identifiers and output InChI Identifiers */</a>
<a name="ln1316">                ip-&gt;nInputType = INPUT_INCHI;</a>
<a name="ln1317">                ip-&gt;bReadInChIOptions |= READ_INCHI_OUTPUT_INCHI;</a>
<a name="ln1318">                ip-&gt;bReadInChIOptions &amp;= ~READ_INCHI_TO_STRUCTURE;</a>
<a name="ln1319">            } </a>
<a name="ln1320"> </a>
<a name="ln1321">           else if ( !stricmp( pArg, &quot;SplitInChI&quot; )  ) </a>
<a name="ln1322">            {</a>
<a name="ln1323">                 /* Split InChI Identifiers into components */</a>
<a name="ln1324">                ip-&gt;bReadInChIOptions |= READ_INCHI_SPLIT_OUTPUT;</a>
<a name="ln1325">            } </a>
<a name="ln1326">#endif</a>
<a name="ln1327">            else if ( !stricmp( pArg, &quot;MOLFILENUMBER&quot; ) ) </a>
<a name="ln1328">            {</a>
<a name="ln1329">                ip-&gt;bGetMolfileNumber |= 1;</a>
<a name="ln1330">            } </a>
<a name="ln1331">            else if ( !stricmp( pArg, &quot;OutputPLAIN&quot; ) ) </a>
<a name="ln1332">            {</a>
<a name="ln1333">                bXml |=  INCHI_OUT_PLAIN_TEXT;</a>
<a name="ln1334">                bXml &amp;= ~INCHI_OUT_XML;</a>
<a name="ln1335">            }             </a>
<a name="ln1336">            else if ( !stricmp( pArg, &quot;OutputXML&quot; ) ) </a>
<a name="ln1337">            {</a>
<a name="ln1338">                bXml |= INCHI_OUT_XML;</a>
<a name="ln1339">                bXml &amp;= ~INCHI_OUT_PLAIN_TEXT;</a>
<a name="ln1340">            }             </a>
<a name="ln1341">            else if ( !stricmp( pArg, &quot;OutputANNPLAIN&quot; ) ) </a>
<a name="ln1342">            {</a>
<a name="ln1343">                bXml |=   INCHI_OUT_PLAIN_TEXT_COMMENTS;</a>
<a name="ln1344">                bXml &amp;=  ~INCHI_OUT_XML_TEXT_COMMENTS;</a>
<a name="ln1345">                bXml |=   INCHI_OUT_WINCHI_WINDOW; /* debug */</a>
<a name="ln1346">            }             </a>
<a name="ln1347">            else if ( !stricmp( pArg, &quot;OutputANNXML&quot; ) ) </a>
<a name="ln1348">            {</a>
<a name="ln1349">                bXml |=   INCHI_OUT_XML_TEXT_COMMENTS;</a>
<a name="ln1350">                bXml &amp;=  ~INCHI_OUT_PLAIN_TEXT_COMMENTS;</a>
<a name="ln1351">            } else</a>
<a name="ln1352">            if ( !stricmp( pArg, &quot;ONLYEXACT&quot; ) || !stricmp( pArg, &quot;ONLYFIXEDH&quot; ) ) {</a>
<a name="ln1353">                bVer1DefaultMode |=  REQ_MODE_BASIC;</a>
<a name="ln1354">                bVer1DefaultMode &amp;= ~REQ_MODE_TAUT;</a>
<a name="ln1355">            } else</a>
<a name="ln1356">            if ( !stricmp( pArg, &quot;ONLYNONISO&quot; ) ) {</a>
<a name="ln1357">                bVer1DefaultMode |=  REQ_MODE_NON_ISO;</a>
<a name="ln1358">                bVer1DefaultMode &amp;= ~REQ_MODE_ISO;</a>
<a name="ln1359">            } else</a>
<a name="ln1360">            if ( !stricmp( pArg, &quot;TAUT&quot; ) ) {</a>
<a name="ln1361">                bVer1DefaultMode &amp;= ~REQ_MODE_BASIC;</a>
<a name="ln1362">                bVer1DefaultMode |= REQ_MODE_TAUT;</a>
<a name="ln1363">            } else</a>
<a name="ln1364">            if ( !stricmp( pArg, &quot;ONLYRECMET&quot; ) ) {  /* do not disconnect metals */</a>
<a name="ln1365">                bDisconnectCoord = 0;</a>
<a name="ln1366">            } else</a>
<a name="ln1367">            if ( !stricmp( pArg, &quot;ONLYRECSALT&quot; ) ) {  /* do not disconnect salts */</a>
<a name="ln1368">                bDisconnectSalts = 0;</a>
<a name="ln1369">            } else</a>
<a name="ln1370">            if ( !memicmp( pArg, &quot;MOVEPOS:&quot;, 8 ) ) {   /* added -- 2010-03-01 DT */</a>
<a name="ln1371">                bMovePositiveCharges = (0 != strtol(pArg+8, NULL, 10));</a>
<a name="ln1372">            } else </a>
<a name="ln1373">            if ( !memicmp( pArg, &quot;RSB:&quot;, 4 )) {</a>
<a name="ln1374">                mdbr = (int)strtol(pArg+4, NULL, 10);</a>
<a name="ln1375">            } else</a>
<a name="ln1376">            if ( !stricmp( pArg, &quot;EQU&quot; ) ) {</a>
<a name="ln1377">                bCompareComponents = CMP_COMPONENTS;</a>
<a name="ln1378">            } else</a>
<a name="ln1379">            if ( !stricmp( pArg, &quot;EQUNONISO&quot; ) ) </a>
<a name="ln1380">            {</a>
<a name="ln1381">                bCompareComponents = CMP_COMPONENTS | CMP_COMPONENTS_NONISO;</a>
<a name="ln1382">            } </a>
<a name="ln1383">            else if ( !memicmp( pArg, &quot;OP:&quot;, 3 ) ) </a>
<a name="ln1384">            {</a>
<a name="ln1385">                bOutputPath = 1;</a>
<a name="ln1386">                strncpy(szOutputPath, pArg+3, sizeof(szOutputPath)-1);</a>
<a name="ln1387">            }                         </a>
<a name="ln1388">#endif /* BUILD_WITH_ENG_OPTIONS */            </a>
<a name="ln1389"> </a>
<a name="ln1390"> </a>
<a name="ln1391"> </a>
<a name="ln1392">            /* Display unrecognized option */</a>
<a name="ln1393">            else</a>
<a name="ln1394">            {</a>
<a name="ln1395">                bRecognizedOption = 0;</a>
<a name="ln1396">#ifndef TARGET_LIB_FOR_WINCHI</a>
<a name="ln1397">                inchi_ios_eprint(log_file, &quot;Unrecognized option: \&quot;%s\&quot;.\n&quot;, pArg);</a>
<a name="ln1398">#endif</a>
<a name="ln1399">            }    </a>
<a name="ln1400">            bVer1Options |= bRecognizedOption;</a>
<a name="ln1401">        </a>
<a name="ln1402"> </a>
<a name="ln1403">        }  </a>
<a name="ln1404">        /*=== end of parsing stand-alone/library InChI options ===*/</a>
<a name="ln1405"> </a>
<a name="ln1406"> </a>
<a name="ln1407"> </a>
<a name="ln1408">        else if ( ip-&gt;num_paths &lt; MAX_NUM_PATHS ) </a>
<a name="ln1409">        {</a>
<a name="ln1410">            char *sz;</a>
<a name="ln1411">            if ( argv[i] &amp;&amp; argv[i][0] ) </a>
<a name="ln1412">            {</a>
<a name="ln1413">                if ( (sz = (char*) inchi_malloc( (strlen(argv[i]) + 1)*sizeof(sz[0]))) )</a>
<a name="ln1414">                {</a>
<a name="ln1415">                    strcpy( sz, argv[i] );</a>
<a name="ln1416">                }</a>
<a name="ln1417">#ifdef CML_DEBUG</a>
<a name="ln1418">                printf (&quot;1 path %d argv %d %s\n&quot;, ip -&gt; num_paths, i, argv [i]);</a>
<a name="ln1419">#endif</a>
<a name="ln1420">                   ip-&gt;path[ip-&gt;num_paths++] = sz;</a>
<a name="ln1421">            }</a>
<a name="ln1422">        }</a>
<a name="ln1423">    </a>
<a name="ln1424"> </a>
<a name="ln1425"> </a>
<a name="ln1426">    } /*  for ( i = 1; i &lt; argc; i ++ )  */</a>
<a name="ln1427"> </a>
<a name="ln1428"> </a>
<a name="ln1429"> </a>
<a name="ln1430">    if ( bHashKey != 0 )</a>
<a name="ln1431">    /* 	Suppress InChIKey calculation if: </a>
<a name="ln1432">            compressed output OR Inchi2Struct OR Inchi2Inchi */</a>
<a name="ln1433">    {</a>
<a name="ln1434"> </a>
<a name="ln1435">        if ( (ip-&gt;bAbcNumbers ==1) &amp;&amp; (ip-&gt;bCtPredecessors == 1) )</a>
<a name="ln1436">        {</a>
<a name="ln1437">#ifndef TARGET_LIB_FOR_WINCHI</a>
<a name="ln1438">            inchi_ios_eprint(log_file, &quot;Terminating: generation of InChIKey is not available with 'Compress' option\n&quot;);</a>
<a name="ln1439">            return -1;</a>
<a name="ln1440">#endif</a>
<a name="ln1441">            bHashKey = 0;</a>
<a name="ln1442">        }</a>
<a name="ln1443">        if ( ip-&gt;nInputType == INPUT_INCHI )</a>
<a name="ln1444">        {</a>
<a name="ln1445">#ifndef TARGET_LIB_FOR_WINCHI</a>
<a name="ln1446">            inchi_ios_eprint(log_file, &quot;Terminating: generation of InChIKey is not available in InChI conversion mode\n&quot;);</a>
<a name="ln1447">            return -1;</a>
<a name="ln1448">#endif</a>
<a name="ln1449">            bHashKey = 0;</a>
<a name="ln1450">        }</a>
<a name="ln1451">        else </a>
<a name="ln1452">        if ( bOutputMolfileOnly == 1 )</a>
<a name="ln1453">        {</a>
<a name="ln1454">#ifndef TARGET_LIB_FOR_WINCHI</a>
<a name="ln1455">            inchi_ios_eprint(log_file, &quot;Terminating: generation of InChIKey is not available with 'OutputSDF' option\n&quot;);</a>
<a name="ln1456">            return -1;</a>
<a name="ln1457">#endif</a>
<a name="ln1458">            bHashKey = 0;</a>
<a name="ln1459">        }</a>
<a name="ln1460"> </a>
<a name="ln1461">    }</a>
<a name="ln1462"> </a>
<a name="ln1463"> </a>
<a name="ln1464">    if ( bNameSuffix || bOutputPath ) </a>
<a name="ln1465">    {</a>
<a name="ln1466">        const char *p = NULL;</a>
<a name="ln1467">        char       *r = NULL;</a>
<a name="ln1468">        char       *sz;</a>
<a name="ln1469">        int  len;</a>
<a name="ln1470">        const char szNUL[] = &quot;NUL&quot;; /* fix for AMD processor: use const char[] instead of just &quot;NUL&quot; constant 2008-11-5 DT */</a>
<a name="ln1471"> </a>
<a name="ln1472">        /*  find the 1st path */</a>
<a name="ln1473">        for ( i = 0; i &lt; MAX_NUM_PATHS; i ++ ) </a>
<a name="ln1474">        {</a>
<a name="ln1475">            if ( !p &amp;&amp; ip-&gt;path[i] &amp;&amp; ip-&gt;path[i][0] ) </a>
<a name="ln1476">            {</a>
<a name="ln1477">                p = ip-&gt;path[i];</a>
<a name="ln1478">                break;</a>
<a name="ln1479">            }</a>
<a name="ln1480">        }</a>
<a name="ln1481">        /* fix output path */</a>
<a name="ln1482">        if ( bOutputPath &amp;&amp; szOutputPath[0] &amp;&amp; p ) </a>
<a name="ln1483">        {</a>
<a name="ln1484">            /* remove last slash */</a>
<a name="ln1485">            len = strlen(szOutputPath);</a>
<a name="ln1486">            if ( len &gt; 0 &amp;&amp; szOutputPath[len-1] != INCHI_PATH_DELIM ) </a>
<a name="ln1487">            {</a>
<a name="ln1488">                szOutputPath[len++] = INCHI_PATH_DELIM;</a>
<a name="ln1489">                szOutputPath[len]   = '\0';</a>
<a name="ln1490">            }</a>
<a name="ln1491">            if ( len &gt; 0 &amp;&amp; (r = (char *)strrchr( p, INCHI_PATH_DELIM ) ) &amp;&amp; r[1] ) </a>
<a name="ln1492">            {</a>
<a name="ln1493">                strcat( szOutputPath, r+1 );</a>
<a name="ln1494">                p = szOutputPath;</a>
<a name="ln1495">            }</a>
<a name="ln1496">        }        /*  add missing paths */</a>
<a name="ln1497">        for ( i = 0; p &amp;&amp; i &lt; MAX_NUM_PATHS; i ++ ) </a>
<a name="ln1498">        { </a>
<a name="ln1499">            /* fix for AMD processor: changed order 2008-11-5 DT */</a>
<a name="ln1500">            if ( !ip-&gt;path[i] || !ip-&gt;path[i][0] ) </a>
<a name="ln1501">            {</a>
<a name="ln1502">                len = strlen( p ) + strlen(szNameSuffix) + strlen( ext[i] );</a>
<a name="ln1503">                if ( (sz = (char*) inchi_malloc( (len+1)*sizeof(sz[0]) )) )</a>
<a name="ln1504">                {</a>
<a name="ln1505">                    strcpy( sz, p );</a>
<a name="ln1506">                    strcat( sz, szNameSuffix );</a>
<a name="ln1507">                    strcat( sz, ext[i] );</a>
<a name="ln1508">                    ip-&gt;num_paths++;</a>
<a name="ln1509">                    ip-&gt;path[i] =sz;</a>
<a name="ln1510">                }</a>
<a name="ln1511">             } else</a>
<a name="ln1512">            if ( !stricmp( ip-&gt;path[i], szNUL ) ) </a>
<a name="ln1513">            {</a>
<a name="ln1514">                inchi_free( (char *)ip-&gt;path[i] ); /* cast deliberately const qualifier */</a>
<a name="ln1515">                ip-&gt;path[i] = NULL;</a>
<a name="ln1516">            }</a>
<a name="ln1517">        }</a>
<a name="ln1518">    }</a>
<a name="ln1519"> </a>
<a name="ln1520"> </a>
<a name="ln1521"> </a>
<a name="ln1522"> </a>
<a name="ln1523">#if ( READ_INCHI_STRING == 1 )</a>
<a name="ln1524">    if ( INPUT_INCHI == ip-&gt;nInputType ) </a>
<a name="ln1525">    {</a>
<a name="ln1526">        bCompareComponents                 = 0;</a>
<a name="ln1527">        /*bDisplayCompositeResults           = 0;*/</a>
<a name="ln1528">#if ( I2S_MODIFY_OUTPUT == 1 )</a>
<a name="ln1529">        if ( !(ip-&gt;bReadInChIOptions &amp; READ_INCHI_TO_STRUCTURE ) )</a>
<a name="ln1530">#endif</a>
<a name="ln1531">        {</a>
<a name="ln1532">        bOutputMolfileOnly                 = 0;</a>
<a name="ln1533">        /*bNoStructLabels                    = 1;*/</a>
<a name="ln1534">        bINChIOutputOptions  |= INCHI_OUT_NO_AUX_INFO;</a>
<a name="ln1535">        bINChIOutputOptions  &amp;= ~INCHI_OUT_SHORT_AUX_INFO;</a>
<a name="ln1536">        bINChIOutputOptions  &amp;= ~INCHI_OUT_ONLY_AUX_INFO;</a>
<a name="ln1537">        }</a>
<a name="ln1538">        ip-&gt;bDisplayIfRestoreWarnings = bDisplayIfRestoreWarnings;</a>
<a name="ln1539">        if ( !(bINChIOutputOptions &amp;</a>
<a name="ln1540">            </a>
<a name="ln1541">             (INCHI_OUT_SDFILE_ONLY          |    /* not in bINChIOutputOptions yet */</a>
<a name="ln1542">              INCHI_OUT_XML                  |    /* not in bINChIOutputOptions yet */</a>
<a name="ln1543">              INCHI_OUT_PLAIN_TEXT           |    /* not in bINChIOutputOptions yet */</a>
<a name="ln1544">              INCHI_OUT_PLAIN_TEXT_COMMENTS  |    /* not in bINChIOutputOptions yet */</a>
<a name="ln1545">              INCHI_OUT_XML_TEXT_COMMENTS         /* not in bINChIOutputOptions yet */</a>
<a name="ln1546">                                             ) )</a>
<a name="ln1547">#if ( I2S_MODIFY_OUTPUT == 1 )</a>
<a name="ln1548">              &amp;&amp; !bOutputMolfileOnly</a>
<a name="ln1549">              &amp;&amp; !(bXml &amp; (INCHI_OUT_XML | INCHI_OUT_XML_TEXT_COMMENTS | INCHI_OUT_PLAIN_TEXT | INCHI_OUT_XML_TEXT_COMMENTS))</a>
<a name="ln1550">#endif</a>
<a name="ln1551">           ) {</a>
<a name="ln1552">            bINChIOutputOptions |= INCHI_OUT_PLAIN_TEXT;</a>
<a name="ln1553">        }</a>
<a name="ln1554">    }</a>
<a name="ln1555">#endif</a>
<a name="ln1556"> </a>
<a name="ln1557"> </a>
<a name="ln1558">    if ( bVer1Options ) </a>
<a name="ln1559">    {</a>
<a name="ln1560">        nMode |= bVer1DefaultMode;</a>
<a name="ln1561">    } </a>
<a name="ln1562">    else if ( bReleaseVersion ) </a>
<a name="ln1563">    {</a>
<a name="ln1564">        nMode |= nReleaseMode;</a>
<a name="ln1565">    }</a>
<a name="ln1566"> </a>
<a name="ln1567">#if ( defined(COMPILE_ANSI_ONLY) || defined(TARGET_LIB_FOR_WINCHI) )</a>
<a name="ln1568">    if ( bCompareComponents &amp;&amp; !(bDisplay &amp; 1) ) {</a>
<a name="ln1569">        bCompareComponents = 0;</a>
<a name="ln1570">    }</a>
<a name="ln1571">#endif</a>
<a name="ln1572">    /*  Save original options */</a>
<a name="ln1573">    /* nOrigMode = nMode; */</a>
<a name="ln1574">#ifndef COMPILE_ANSI_ONLY</a>
<a name="ln1575">    ip-&gt;dp.sdp.nFontSize         = nFontSize;</a>
<a name="ln1576">    ip-&gt;dp.sdp.ulDisplTime       = *ulDisplTime;</a>
<a name="ln1577">    ip-&gt;bDisplay                 = bDisplay;</a>
<a name="ln1578">#ifdef TARGET_LIB_FOR_WINCHI</a>
<a name="ln1579">    ip-&gt;bDisplayCompositeResults = bDisplay;</a>
<a name="ln1580">#else</a>
<a name="ln1581">    ip-&gt;bDisplayCompositeResults = bDisplayCompositeResults;</a>
<a name="ln1582">#endif</a>
<a name="ln1583">#else</a>
<a name="ln1584">    ip-&gt;bDisplayEachComponentINChI = 0;</a>
<a name="ln1585">    bCompareComponents            = 0;</a>
<a name="ln1586">#endif</a>
<a name="ln1587">    ip-&gt;bMergeAllInputStructures = bMergeAllInputStructures;</a>
<a name="ln1588">    ip-&gt;bDoNotAddH               = bDoNotAddH;</a>
<a name="ln1589">    /*  set default options */</a>
<a name="ln1590">    if ( !nMode || nMode == REQ_MODE_STEREO ) {</a>
<a name="ln1591">        /*  requested all output */</a>
<a name="ln1592">        nMode |= (REQ_MODE_BASIC | REQ_MODE_TAUT | REQ_MODE_ISO | REQ_MODE_NON_ISO | REQ_MODE_STEREO);</a>
<a name="ln1593">    } else {</a>
<a name="ln1594">        if ( !(nMode &amp; (REQ_MODE_BASIC | REQ_MODE_TAUT)) ) {</a>
<a name="ln1595">            nMode |= (REQ_MODE_BASIC | REQ_MODE_TAUT);</a>
<a name="ln1596">        }</a>
<a name="ln1597">        if ( (nMode &amp; REQ_MODE_STEREO) &amp;&amp; !(nMode &amp; (REQ_MODE_ISO | REQ_MODE_NON_ISO)) ) {</a>
<a name="ln1598">            nMode |= (REQ_MODE_ISO | REQ_MODE_NON_ISO);</a>
<a name="ln1599">        }</a>
<a name="ln1600">    }</a>
<a name="ln1601">    /*  if the user requested isotopic then unconditionally add non-isotopic output. */</a>
<a name="ln1602">    if ( nMode &amp; REQ_MODE_ISO ) {</a>
<a name="ln1603">        nMode |= REQ_MODE_NON_ISO;</a>
<a name="ln1604">    }</a>
<a name="ln1605">#if ( MIN_SB_RING_SIZE &gt; 0 )</a>
<a name="ln1606">    if ( mdbr ) {</a>
<a name="ln1607">        nMinDbRinSize = mdbr;</a>
<a name="ln1608">    }</a>
<a name="ln1609">    nMode |= (nMinDbRinSize &lt;&lt; REQ_MODE_MIN_SB_RING_SHFT) &amp; REQ_MODE_MIN_SB_RING_MASK;</a>
<a name="ln1610">#endif</a>
<a name="ln1611">    /*  input file */</a>
<a name="ln1612">    if ( ip-&gt;nInputType == INPUT_NONE &amp;&amp; ip-&gt;num_paths &gt; 0 ) {</a>
<a name="ln1613">        ip-&gt;nInputType = INPUT_MOLFILE; /*  default */</a>
<a name="ln1614">#if ( ADD_CMLPP == 1 )</a>
<a name="ln1615">        {</a>
<a name="ln1616">            const char *p;</a>
<a name="ln1617">            if ( ip-&gt;path[0] &amp;&amp; ( p = strrchr(ip-&gt;path[0], '.' ) ) &amp;&amp;</a>
<a name="ln1618">                 !stricmp( p, &quot;.cml&quot;) ) {</a>
<a name="ln1619">                ip-&gt;nInputType = INPUT_CMLFILE;</a>
<a name="ln1620">            }</a>
<a name="ln1621">        }</a>
<a name="ln1622">#endif</a>
<a name="ln1623">    }</a>
<a name="ln1624">    ip-&gt;nMode = nMode;</a>
<a name="ln1625">    if ( (bCompareComponents &amp; CMP_COMPONENTS) &amp;&amp; (nMode &amp; REQ_MODE_BASIC) ) {</a>
<a name="ln1626">        bCompareComponents |= CMP_COMPONENTS_NONTAUT; /* compare non-tautomeric */</a>
<a name="ln1627">    }</a>
<a name="ln1628">    ip-&gt;bCompareComponents = bCompareComponents;</a>
<a name="ln1629"> </a>
<a name="ln1630">    ip-&gt;bINChIOutputOptions = bINChIOutputOptions | (bOutputMolfileOnly? INCHI_OUT_SDFILE_ONLY : 0);</a>
<a name="ln1631">    if ( bOutputMolfileOnly ) {</a>
<a name="ln1632">        bXml &amp;= ~(INCHI_OUT_XML                 | INCHI_OUT_PLAIN_TEXT |</a>
<a name="ln1633">                  INCHI_OUT_PLAIN_TEXT_COMMENTS | INCHI_OUT_XML_TEXT_COMMENTS | INCHI_OUT_TABBED_OUTPUT);</a>
<a name="ln1634">#if ( SDF_OUTPUT_DT == 1 )</a>
<a name="ln1635">        ip-&gt;bINChIOutputOptions |= bOutputMolfileDT?    INCHI_OUT_SDFILE_ATOMS_DT : 0;</a>
<a name="ln1636">        ip-&gt;bINChIOutputOptions |= bOutputMolfileSplit? INCHI_OUT_SDFILE_SPLIT : 0;</a>
<a name="ln1637">#endif</a>
<a name="ln1638">    }</a>
<a name="ln1639">    if ( bXml &amp; INCHI_OUT_XML ) {</a>
<a name="ln1640">        bXml &amp;= ~(INCHI_OUT_PLAIN_TEXT | INCHI_OUT_XML_TEXT_COMMENTS | INCHI_OUT_TABBED_OUTPUT);</a>
<a name="ln1641">    }</a>
<a name="ln1642">#ifdef TARGET_LIB_FOR_WINCHI</a>
<a name="ln1643">    if ( !(bDisplay &amp; 1) ) {</a>
<a name="ln1644">        bXml &amp;= ~(INCHI_OUT_PLAIN_TEXT_COMMENTS | INCHI_OUT_XML_TEXT_COMMENTS); /* do not output comments in wINChI text file results */</a>
<a name="ln1645">    } else {</a>
<a name="ln1646">        bXml |= INCHI_OUT_WINCHI_WINDOW;</a>
<a name="ln1647">    }</a>
<a name="ln1648">#endif</a>
<a name="ln1649">    ip-&gt;bINChIOutputOptions |= bXml;</a>
<a name="ln1650">    ip-&gt;bNoStructLabels     = bNoStructLabels;</a>
<a name="ln1651"> </a>
<a name="ln1652">    if ( bForcedChiralFlag ) {</a>
<a name="ln1653">        ip-&gt;bChiralFlag = bForcedChiralFlag;</a>
<a name="ln1654">    }</a>
<a name="ln1655"> </a>
<a name="ln1656">    /*******************************************/</a>
<a name="ln1657">    /*       tautomeric/salts settings         */</a>
<a name="ln1658">    /*******************************************/</a>
<a name="ln1659"> </a>
<a name="ln1660">    ip-&gt;bTautFlags     = 0;   /* initialize */</a>
<a name="ln1661">    ip-&gt;bTautFlagsDone = 0;   /* initialize */</a>
<a name="ln1662"> </a>
<a name="ln1663">    /* find regular tautomerism */</a>
<a name="ln1664">    ip-&gt;bTautFlags |= TG_FLAG_TEST_TAUT__ATOMS;</a>
<a name="ln1665">    /* disconnect salts */</a>
<a name="ln1666">    ip-&gt;bTautFlags |= bDisconnectSalts?         TG_FLAG_DISCONNECT_SALTS    : 0;</a>
<a name="ln1667">    /* if possible find long-range H/(-) taut. on =C-OH, &gt;C=O    */</a>
<a name="ln1668">    ip-&gt;bTautFlags |= bAcidTautomerism?         TG_FLAG_TEST_TAUT__SALTS    : 0;</a>
<a name="ln1669">    /* allow long-range movement of N(+), P(+) charges           */</a>
<a name="ln1670">    ip-&gt;bTautFlags |= bMovePositiveCharges?     TG_FLAG_MOVE_POS_CHARGES    : 0;</a>
<a name="ln1671">    /* multi-attachement long-range H/(-) taut. on =C-OH, &gt;C=O   */</a>
<a name="ln1672">    ip-&gt;bTautFlags |= (bAcidTautomerism &gt; 1)?   TG_FLAG_TEST_TAUT2_SALTS    : 0;</a>
<a name="ln1673">    /* (debug) allow to find long-range H-only tautomerism on =C-OH, &gt;C=O */</a>
<a name="ln1674">    ip-&gt;bTautFlags |= (bUnchargedAcidTaut==1)?  TG_FLAG_ALLOW_NO_NEGTV_O    : 0;</a>
<a name="ln1675">    /* merge =C-OH and &gt;C=O containing t-groups and other =C-OH groups */</a>
<a name="ln1676">    ip-&gt;bTautFlags |= bMergeSaltTGroups?        TG_FLAG_MERGE_TAUT_SALTS    : 0;</a>
<a name="ln1677">    ip-&gt;bTautFlags |= bDisconnectCoord?         TG_FLAG_DISCONNECT_COORD    : 0;</a>
<a name="ln1678">    ip-&gt;bTautFlags |=(bDisconnectCoord &amp;&amp;</a>
<a name="ln1679">                      bReconnectCoord)?         TG_FLAG_RECONNECT_COORD     : 0;</a>
<a name="ln1680">    ip-&gt;bTautFlags |= bDisconnectCoordChkVal?   TG_FLAG_CHECK_VALENCE_COORD : 0;</a>
<a name="ln1681">    ip-&gt;bTautFlags |= bTgFlagVariableProtons?   TG_FLAG_VARIABLE_PROTONS     : 0;</a>
<a name="ln1682">    ip-&gt;bTautFlags |= bTgFlagHardAddRenProtons? TG_FLAG_HARD_ADD_REM_PROTONS : 0;</a>
<a name="ln1683">    ip-&gt;bTautFlags |= bKetoEnolTaut?            TG_FLAG_KETO_ENOL_TAUT : 0;</a>
<a name="ln1684">    ip-&gt;bTautFlags |= b15TautNonRing?           TG_FLAG_1_5_TAUT : 0;</a>
<a name="ln1685"> </a>
<a name="ln1686">#ifdef STEREO_WEDGE_ONLY</a>
<a name="ln1687">    ip-&gt;bTautFlags  |= bPointedEdgeStereo?      TG_FLAG_POINTED_EDGE_STEREO  : 0;</a>
<a name="ln1688">#endif</a>
<a name="ln1689">#if ( FIX_ADJ_RAD == 1 )</a>
<a name="ln1690">    ip-&gt;bTautFlags  |= bFixAdjacentRad?         TG_FLAG_FIX_ADJ_RADICALS : 0;</a>
<a name="ln1691">#endif</a>
<a name="ln1692">    ip-&gt;bTautFlags  |= bAddPhosphineStereo?     TG_FLAG_PHOSPHINE_STEREO : 0;</a>
<a name="ln1693">    ip-&gt;bTautFlags  |= bAddArsineStereo?        TG_FLAG_ARSINE_STEREO : 0;</a>
<a name="ln1694">    ip-&gt;bTautFlags  |= bFixSp3bug?              TG_FLAG_FIX_SP3_BUG   : 0;</a>
<a name="ln1695"> </a>
<a name="ln1696"> </a>
<a name="ln1697">    if (bFixFB2)</a>
<a name="ln1698">    {</a>
<a name="ln1699">#if ( FIX_ISO_FIXEDH_BUG == 1 )</a>
<a name="ln1700">        ip-&gt;bTautFlags  |= TG_FLAG_FIX_ISO_FIXEDH_BUG; /* accomodate FIX_ISO_FIXEDH_BUG */</a>
<a name="ln1701">#endif</a>
<a name="ln1702">#if ( FIX_TERM_H_CHRG_BUG == 1 )</a>
<a name="ln1703">        ip-&gt;bTautFlags  |= TG_FLAG_FIX_TERM_H_CHRG_BUG; /* accomodate FIX_TERM_H_CHRG_BUG */</a>
<a name="ln1704">#endif</a>
<a name="ln1705">#if ( FIX_TRANSPOSITION_CHARGE_BUG == 1 )</a>
<a name="ln1706">        ip-&gt;bINChIOutputOptions |= INCHI_OUT_FIX_TRANSPOSITION_CHARGE_BUG;</a>
<a name="ln1707">#endif</a>
<a name="ln1708">    }</a>
<a name="ln1709"> </a>
<a name="ln1710"> </a>
<a name="ln1711"> </a>
<a name="ln1712"> </a>
<a name="ln1713">    if ( !ip-&gt;nInputType ) </a>
<a name="ln1714">        ip-&gt;nInputType = INPUT_MOLFILE;</a>
<a name="ln1715"> </a>
<a name="ln1716">    /* Check if /SNon requested turn OFF SUU/SLUUD */</a>
<a name="ln1717">    if ( ! (ip-&gt;nMode &amp; REQ_MODE_STEREO) )</a>
<a name="ln1718">    {</a>
<a name="ln1719">        ip-&gt;nMode &amp;= ~REQ_MODE_DIFF_UU_STEREO;</a>
<a name="ln1720">        ip-&gt;nMode &amp;= ~(REQ_MODE_SB_IGN_ALL_UU | REQ_MODE_SC_IGN_ALL_UU);</a>
<a name="ln1721">    }</a>
<a name="ln1722"> </a>
<a name="ln1723"> </a>
<a name="ln1724">    /* Standard InChI ? */</a>
<a name="ln1725">    if (bStdFormat)  </a>
<a name="ln1726">    {</a>
<a name="ln1727">        ip-&gt;bINChIOutputOptions |= INCHI_OUT_STDINCHI;</a>
<a name="ln1728">    }</a>
<a name="ln1729"> </a>
<a name="ln1730">    /* InChIKey ? */</a>
<a name="ln1731">    if ( !bHashKey )</a>
<a name="ln1732">        ip-&gt;bCalcInChIHash = INCHIHASH_NONE;</a>
<a name="ln1733">    else</a>
<a name="ln1734">        ip-&gt;bCalcInChIHash = INCHIHASH_KEY;        </a>
<a name="ln1735">    </a>
<a name="ln1736">    /* Extension(s) to hash (in non-std mode only) ? */</a>
<a name="ln1737">    if ( !bHashKey )</a>
<a name="ln1738">    {</a>
<a name="ln1739">        if ( (bHashXtra1!=0) || (bHashXtra2!=0) )</a>
<a name="ln1740">            inchi_ios_eprint(log_file,</a>
<a name="ln1741">                            &quot;Hash extension(s) not generated: InChIKey not requested&quot;);</a>
<a name="ln1742">    }</a>
<a name="ln1743">    else</a>
<a name="ln1744">    {</a>
<a name="ln1745">        if ( bHashXtra1 )</a>
<a name="ln1746">        {</a>
<a name="ln1747">            if ( bHashXtra2 )   ip-&gt;bCalcInChIHash = INCHIHASH_KEY_XTRA1_XTRA2;</a>
<a name="ln1748">            else                ip-&gt;bCalcInChIHash = INCHIHASH_KEY_XTRA1;</a>
<a name="ln1749">        }</a>
<a name="ln1750">        else if ( bHashXtra2 )</a>
<a name="ln1751">        {</a>
<a name="ln1752">            ip-&gt;bCalcInChIHash = INCHIHASH_KEY_XTRA2;</a>
<a name="ln1753">        }</a>
<a name="ln1754">    }</a>
<a name="ln1755"> </a>
<a name="ln1756"> </a>
<a name="ln1757">    return 0;</a>
<a name="ln1758">}</a>
<a name="ln1759"> </a>
<a name="ln1760"> </a>
<a name="ln1761"> </a>
<a name="ln1762">/*******************************************************************/</a>
<a name="ln1763">int PrintInputParms( INCHI_IOSTREAM *log_file, INPUT_PARMS *ip )</a>
<a name="ln1764">{</a>
<a name="ln1765">INCHI_MODE nMode = ip-&gt;nMode;</a>
<a name="ln1766">int k;</a>
<a name="ln1767">int bStdFormat = 1;</a>
<a name="ln1768">int first=1;</a>
<a name="ln1769">           </a>
<a name="ln1770">     </a>
<a name="ln1771">#ifdef TARGET_LIB_FOR_WINCHI</a>
<a name="ln1772">    int bInChI2Struct = 0; /* as of December 2008, winchi-1 does not convert InChI to structure */</a>
<a name="ln1773">#else</a>
<a name="ln1774">    int bInChI2Struct = (ip-&gt;bReadInChIOptions &amp; READ_INCHI_TO_STRUCTURE) &amp;&amp; ip-&gt;nInputType == INPUT_INCHI;</a>
<a name="ln1775">#endif</a>
<a name="ln1776">            </a>
<a name="ln1777">    if ( !(ip-&gt;bINChIOutputOptions &amp; INCHI_OUT_STDINCHI) )</a>
<a name="ln1778">        bStdFormat = 0;</a>
<a name="ln1779"> </a>
<a name="ln1780"> </a>
<a name="ln1781">    /* some stereo */</a>
<a name="ln1782">    if ( ! (nMode &amp; REQ_MODE_STEREO) ) </a>
<a name="ln1783">    {</a>
<a name="ln1784">        inchi_ios_eprint( log_file, &quot;Using specific structure perception features:\n&quot;);</a>
<a name="ln1785">        first = 0;</a>
<a name="ln1786">        inchi_ios_eprint( log_file, &quot;  Stereo OFF\n&quot;);</a>
<a name="ln1787">    }</a>
<a name="ln1788">    else</a>
<a name="ln1789">    {</a>
<a name="ln1790">        if ( ! (TG_FLAG_POINTED_EDGE_STEREO &amp; ip-&gt;bTautFlags) ) </a>
<a name="ln1791">        {</a>
<a name="ln1792">            if (first)</a>
<a name="ln1793">            {</a>
<a name="ln1794">                inchi_ios_eprint( log_file, &quot;Using specific structure perception features:\n&quot;);</a>
<a name="ln1795">                first = 0;</a>
<a name="ln1796">            }</a>
<a name="ln1797">            inchi_ios_eprint( log_file, &quot;  Both ends of wedge point to stereocenters\n&quot;);</a>
<a name="ln1798">        }</a>
<a name="ln1799">    }</a>
<a name="ln1800">    if ( ip-&gt;bDoNotAddH ) </a>
<a name="ln1801">    {</a>
<a name="ln1802">        if (first)</a>
<a name="ln1803">            inchi_ios_eprint( log_file, &quot;Using specific structure perception features:\n&quot;);</a>
<a name="ln1804">        inchi_ios_eprint( log_file, &quot;  Do not add H\n&quot;);</a>
<a name="ln1805">    }</a>
<a name="ln1806"> </a>
<a name="ln1807"> </a>
<a name="ln1808">    /*  Generation/conversion indicator */</a>
<a name="ln1809">    if (bStdFormat)</a>
<a name="ln1810">    {</a>
<a name="ln1811">        if ( !(ip-&gt;bINChIOutputOptions &amp; INCHI_OUT_SDFILE_ONLY) &amp;&amp; !bInChI2Struct )</a>
<a name="ln1812">            inchi_ios_eprint( log_file, &quot;Generating standard InChI\n&quot; );</a>
<a name="ln1813"> </a>
<a name="ln1814">#if ( !defined(TARGET_API_LIB) &amp;&amp; !defined(TARGET_LIB_FOR_WINCHI) &amp;&amp; !defined(TARGET_EXE_USING_API) )</a>
<a name="ln1815">        /* effective only in command line program InChI or stdInChI */</a>
<a name="ln1816">        else if ( bInChI2Struct )             </a>
<a name="ln1817">            inchi_ios_eprint( log_file, &quot;Converting InChI(s) to structure(s) in %s\n&quot;,</a>
<a name="ln1818">                              (ip-&gt;bINChIOutputOptions &amp; INCHI_OUT_SDFILE_ONLY)? </a>
<a name="ln1819">                              &quot;MOL format&quot; : &quot;aux. info format&quot; );</a>
<a name="ln1820">#endif</a>
<a name="ln1821">    }</a>
<a name="ln1822">    else</a>
<a name="ln1823">        inchi_ios_eprint( log_file, &quot;Generating non-standard InChI with the options: \n&quot; );</a>
<a name="ln1824"> </a>
<a name="ln1825">    </a>
<a name="ln1826">    /* SDfile output */</a>
<a name="ln1827"> </a>
<a name="ln1828">    if ( ip-&gt;bINChIOutputOptions &amp; INCHI_OUT_SDFILE_ONLY ) </a>
<a name="ln1829">    {</a>
<a name="ln1830">        inchi_ios_eprint( log_file, </a>
<a name="ln1831">                         &quot;Output SDfile only without stereochemical information and atom coordinates%s\n&quot;,</a>
<a name="ln1832">                         (ip-&gt;bINChIOutputOptions &amp; INCHI_OUT_SDFILE_ATOMS_DT)? </a>
<a name="ln1833">                         &quot;\n(write H isotopes as D, T)&quot;:&quot;&quot; );</a>
<a name="ln1834">    }</a>
<a name="ln1835">    </a>
<a name="ln1836">    /* Fixed/Mobile H */</a>
<a name="ln1837">    if (!bStdFormat)</a>
<a name="ln1838">    {</a>
<a name="ln1839">        if( (nMode &amp; (REQ_MODE_BASIC | REQ_MODE_TAUT )) == (REQ_MODE_BASIC | REQ_MODE_TAUT) ) </a>
<a name="ln1840">            inchi_ios_eprint( log_file, &quot;  Mobile H Perception OFF (include FixedH layer)\n&quot; );</a>
<a name="ln1841">        else if( (nMode &amp; (REQ_MODE_BASIC | REQ_MODE_TAUT )) == (REQ_MODE_TAUT) ) </a>
<a name="ln1842">            inchi_ios_eprint( log_file, &quot;  Mobile H Perception ON  (omit FixedH layer)\n&quot; );</a>
<a name="ln1843">        else if( (nMode &amp; (REQ_MODE_BASIC | REQ_MODE_TAUT )) == (REQ_MODE_BASIC) ) </a>
<a name="ln1844">            inchi_ios_eprint( log_file, &quot;  Mobile H ignored\n&quot; );</a>
<a name="ln1845">        else </a>
<a name="ln1846">            inchi_ios_eprint( log_file, &quot;  Undefined Mobile H mode\n&quot; );</a>
<a name="ln1847"> </a>
<a name="ln1848">        if ( (ip-&gt;bTautFlags &amp; TG_FLAG_VARIABLE_PROTONS) ) </a>
<a name="ln1849">         if ( !(ip-&gt;bTautFlags &amp; TG_FLAG_HARD_ADD_REM_PROTONS) ) </a>
<a name="ln1850">            inchi_ios_eprint( log_file, &quot;  Disabled Aggressive (De)protonation\n&quot; );</a>
<a name="ln1851"> </a>
<a name="ln1852">#if ( FIND_RING_SYSTEMS != 1 )</a>
<a name="ln1853">        inchi_ios_eprint( log_file, &quot;  %s5-, 6-, 7-memb. ring taut. ignored\n&quot;, i?&quot;; &quot;:&quot;&quot;);</a>
<a name="ln1854">#endif</a>
<a name="ln1855"> </a>
<a name="ln1856">        /* RecMet */</a>
<a name="ln1857">        if ( ip-&gt;bTautFlags &amp; TG_FLAG_DISCONNECT_COORD ) </a>
<a name="ln1858">        {</a>
<a name="ln1859">            if ( ip-&gt;bTautFlags &amp; TG_FLAG_RECONNECT_COORD ) </a>
<a name="ln1860">                inchi_ios_eprint( log_file, &quot;  Include bonds to metals\n&quot;);</a>
<a name="ln1861">            else</a>
<a name="ln1862">                inchi_ios_eprint( log_file, &quot;  Do not reconnect metals (omit RecMet layer)\n&quot;);</a>
<a name="ln1863">        }</a>
<a name="ln1864">        else</a>
<a name="ln1865">            inchi_ios_eprint( log_file, &quot;  Do not disconnect metals\n&quot;);</a>
<a name="ln1866"> </a>
<a name="ln1867">        /* isotopic - always ON, output disabled. 09-17-2009*/</a>
<a name="ln1868">        /*</a>
<a name="ln1869">        if ( nMode &amp; REQ_MODE_ISO ) </a>
<a name="ln1870">            inchi_ios_eprint( log_file, &quot;  Isotopic ON\n&quot;);</a>
<a name="ln1871">        else if ( nMode &amp; REQ_MODE_NON_ISO ) </a>
<a name="ln1872">            inchi_ios_eprint( log_file, &quot;  Isotopic OFF\n&quot;);</a>
<a name="ln1873">        */</a>
<a name="ln1874"> </a>
<a name="ln1875">#if ( FIX_ADJ_RAD == 1 )</a>
<a name="ln1876">    if ( ip-&gt;bTautFlags &amp; TG_FLAG_FIX_ADJ_RADICALS ) </a>
<a name="ln1877">        inchi_ios_eprint( log_file, &quot;Fix Adjacent Radicals\n&quot; );</a>
<a name="ln1878">#endif</a>
<a name="ln1879"> </a>
<a name="ln1880">        /*  stereo */</a>
<a name="ln1881">        if ( nMode &amp; REQ_MODE_STEREO ) </a>
<a name="ln1882">        {</a>
<a name="ln1883">            inchi_ios_eprint( log_file,  &quot;  %s%s%s%sStereo ON\n&quot;,</a>
<a name="ln1884">                     ( nMode &amp; REQ_MODE_NOEQ_STEREO )?     &quot;Slow &quot;:&quot;&quot;,</a>
<a name="ln1885">                     ( nMode &amp; REQ_MODE_REDNDNT_STEREO )?  &quot;Redund. &quot;:&quot;&quot;,</a>
<a name="ln1886">                     ( nMode &amp; REQ_MODE_NO_ALT_SBONDS)?    &quot;No AltBond &quot;:&quot;&quot;,</a>
<a name="ln1887"> </a>
<a name="ln1888">                     ( nMode &amp; REQ_MODE_RACEMIC_STEREO)?   &quot;Racemic &quot; :</a>
<a name="ln1889">                     ( nMode &amp;  REQ_MODE_RELATIVE_STEREO)? &quot;Relative &quot; :</a>
<a name="ln1890">                     ( nMode &amp;  REQ_MODE_CHIR_FLG_STEREO)? &quot;Chiral Flag &quot; : &quot;Absolute &quot; );</a>
<a name="ln1891">            if ( 0 == (nMode &amp; (REQ_MODE_SB_IGN_ALL_UU | REQ_MODE_SC_IGN_ALL_UU)) ) </a>
<a name="ln1892">                inchi_ios_eprint( log_file, &quot;  Include undefined/unknown stereogenic centers and bonds\n&quot;);</a>
<a name="ln1893">            else if ( REQ_MODE_SC_IGN_ALL_UU == (nMode &amp; (REQ_MODE_SB_IGN_ALL_UU | REQ_MODE_SC_IGN_ALL_UU)) ) </a>
<a name="ln1894">                inchi_ios_eprint( log_file, &quot;  Omit undefined/unknown stereogenic centers\n&quot;);</a>
<a name="ln1895">            else if ( REQ_MODE_SB_IGN_ALL_UU == (nMode &amp; (REQ_MODE_SB_IGN_ALL_UU | REQ_MODE_SC_IGN_ALL_UU)) ) </a>
<a name="ln1896">                inchi_ios_eprint( log_file, &quot;  Omit undefined/unknown stereogenic bonds\n&quot;);</a>
<a name="ln1897">            else</a>
<a name="ln1898">                /*case REQ_MODE_SB_IGN_ALL_UU | REQ_MODE_SC_IGN_ALL_UU*/</a>
<a name="ln1899">                inchi_ios_eprint( log_file, &quot;  Omit undefined/unknown stereogenic centers and bonds\n&quot;);</a>
<a name="ln1900"> </a>
<a name="ln1901">            if ( 0 != (nMode &amp; REQ_MODE_DIFF_UU_STEREO) )</a>
<a name="ln1902">            {</a>
<a name="ln1903">                inchi_ios_eprint( log_file, &quot;  Make labels for unknown and undefined stereo different\n&quot;);</a>
<a name="ln1904">            }</a>
<a name="ln1905"> </a>
<a name="ln1906"> </a>
<a name="ln1907">#if ( defined(MIN_SB_RING_SIZE) &amp;&amp; MIN_SB_RING_SIZE &gt; 0 )</a>
<a name="ln1908">            k = (ip-&gt;nMode &amp; REQ_MODE_MIN_SB_RING_MASK) &gt;&gt; REQ_MODE_MIN_SB_RING_SHFT;</a>
<a name="ln1909">            if ( bRELEASE_VERSION != 1 || k != MIN_SB_RING_SIZE ) </a>
<a name="ln1910">            {</a>
<a name="ln1911">                if ( k &gt;= 3 ) </a>
<a name="ln1912">                    inchi_ios_eprint( log_file, &quot;  Min. stereobond ring size: %d\n&quot;, k );</a>
<a name="ln1913">                else </a>
<a name="ln1914">                    inchi_ios_eprint( log_file, &quot;  Min. stereobond ring size: NONE\n&quot; );</a>
<a name="ln1915">            }</a>
<a name="ln1916">#endif</a>
<a name="ln1917">        } /* stereo */</a>
<a name="ln1918"> </a>
<a name="ln1919">    } /* !bStdFormat */</a>
<a name="ln1920"> </a>
<a name="ln1921">  </a>
<a name="ln1922"> </a>
<a name="ln1923">    if ( !bStdFormat )</a>
<a name="ln1924">    {</a>
<a name="ln1925">        if ( TG_FLAG_KETO_ENOL_TAUT &amp; ip-&gt;bTautFlags) </a>
<a name="ln1926">            inchi_ios_eprint( log_file, &quot;  Account for keto-enol tautomerism\n&quot;);</a>
<a name="ln1927">        else</a>
<a name="ln1928">            inchi_ios_eprint( log_file, &quot;  Do not account for keto-enol tautomerism\n&quot;);    </a>
<a name="ln1929">        if ( TG_FLAG_1_5_TAUT &amp; ip-&gt;bTautFlags) </a>
<a name="ln1930">            inchi_ios_eprint( log_file, &quot;  Account for 1,5-tautomerism\n&quot;);</a>
<a name="ln1931">        else</a>
<a name="ln1932">            inchi_ios_eprint( log_file, &quot;  Do not account for 1,5-tautomerism\n&quot;);</a>
<a name="ln1933">#ifdef BUILD_WITH_ENG_OPTIONS</a>
<a name="ln1934">        if ( TG_FLAG_PHOSPHINE_STEREO &amp; ip-&gt;bTautFlags ) </a>
<a name="ln1935">            inchi_ios_eprint( log_file, &quot;  Include phosphine stereochemistry\n&quot;);</a>
<a name="ln1936">        else</a>
<a name="ln1937">            inchi_ios_eprint( log_file, &quot;  Do not include phosphine stereochemistry\n&quot;);</a>
<a name="ln1938">        if ( TG_FLAG_ARSINE_STEREO &amp; ip-&gt;bTautFlags ) </a>
<a name="ln1939">            inchi_ios_eprint( log_file, &quot;  Include arsine stereochemistry\n&quot;);</a>
<a name="ln1940">        else</a>
<a name="ln1941">            inchi_ios_eprint( log_file, &quot;  Do not include arsine stereochemistry\n&quot;);</a>
<a name="ln1942">        if ( ! (TG_FLAG_FIX_SP3_BUG &amp; ip-&gt;bTautFlags) ) </a>
<a name="ln1943">                inchi_ios_eprint( log_file, &quot;  Turned OFF fix of bug leading to missing or undefined sp3 parity\n&quot;);</a>
<a name="ln1944">        if ( !(TG_FLAG_FIX_ISO_FIXEDH_BUG &amp; ip-&gt;bTautFlags) )</a>
<a name="ln1945">            inchi_ios_eprint( log_file, &quot;  Turned OFF bug-fixes found after v.1.02b release\n&quot;);</a>
<a name="ln1946">        if ( !(ip-&gt;bFixNonUniformDraw) ) </a>
<a name="ln1947">            inchi_ios_eprint( log_file, &quot;  Turned OFF fixes of non-uniform drawing issues\n&quot;);</a>
<a name="ln1948">        if ( ! (TG_FLAG_MOVE_POS_CHARGES &amp; ip-&gt;bTautFlags) ) </a>
<a name="ln1949">                inchi_ios_eprint( log_file, &quot;  MovePos turned OFF\n&quot;);</a>
<a name="ln1950">#endif</a>
<a name="ln1951">    } /* !bStdFormat */</a>
<a name="ln1952"> </a>
<a name="ln1953">    if ( ip-&gt;bCalcInChIHash != INCHIHASH_NONE ) </a>
<a name="ln1954">    {</a>
<a name="ln1955">        if (bStdFormat)</a>
<a name="ln1956">            inchi_ios_eprint( log_file, &quot;Generating standard InChIKey\n&quot;);</a>
<a name="ln1957">        else</a>
<a name="ln1958">            inchi_ios_eprint( log_file, &quot;Generating InChIKey\n&quot;);</a>
<a name="ln1959">        if ( ip-&gt;bCalcInChIHash == INCHIHASH_KEY_XTRA1 )</a>
<a name="ln1960">            inchi_ios_eprint( log_file, &quot;Generating hash extension (1st block)\n&quot;);</a>
<a name="ln1961">        else if ( ip-&gt;bCalcInChIHash == INCHIHASH_KEY_XTRA2 )</a>
<a name="ln1962">            inchi_ios_eprint( log_file, &quot;Generating hash extension (2nd block)\n&quot;);</a>
<a name="ln1963">        else if ( ip-&gt;bCalcInChIHash == INCHIHASH_KEY_XTRA1_XTRA2 )</a>
<a name="ln1964">            inchi_ios_eprint( log_file, &quot;Generating hash extension (two blocks)\n&quot;);</a>
<a name="ln1965">    }</a>
<a name="ln1966"> </a>
<a name="ln1967">    if ( ip-&gt;bINChIOutputOptions &amp; INCHI_OUT_SAVEOPT )</a>
<a name="ln1968">    {</a>
<a name="ln1969">        inchi_ios_eprint( log_file, &quot;Saving InChI creation options&quot; );</a>
<a name="ln1970">        if ( bStdFormat )</a>
<a name="ln1971">        {</a>
<a name="ln1972">            inchi_ios_eprint( log_file, &quot; suppressed for standard InChI&quot; );</a>
<a name="ln1973">            /* NB: actual suppression takes place on InChI serialization */</a>
<a name="ln1974">            /* (as on e.g. Inchi2Inchi conversion it may appear that we create non-std */</a>
<a name="ln1975">            /*  InChI instead of standard one) */</a>
<a name="ln1976">        }</a>
<a name="ln1977">        inchi_ios_eprint( log_file, &quot;\n&quot; );</a>
<a name="ln1978"> </a>
<a name="ln1979">    }</a>
<a name="ln1980"> </a>
<a name="ln1981"> </a>
<a name="ln1982">    if ( ip-&gt;bAllowEmptyStructure ) </a>
<a name="ln1983">        inchi_ios_eprint( log_file, &quot;Issue warning on empty structure\n&quot; );</a>
<a name="ln1984"> </a>
<a name="ln1985"> </a>
<a name="ln1986"> </a>
<a name="ln1987"> </a>
<a name="ln1988">    /* Input */</a>
<a name="ln1989">    if ( ip-&gt;nInputType ) </a>
<a name="ln1990">    {</a>
<a name="ln1991">        inchi_ios_eprint( log_file, &quot;Input format: %s&quot;,</a>
<a name="ln1992">            ip-&gt;nInputType == INPUT_MOLFILE?     &quot;MOLfile&quot;       :</a>
<a name="ln1993">            ip-&gt;nInputType == INPUT_SDFILE?      &quot;SDfile&quot;        :</a>
<a name="ln1994">            ip-&gt;nInputType == INPUT_CMLFILE?     &quot;CMLfile&quot;       :</a>
<a name="ln1995">#if ( READ_INCHI_STRING == 1 )</a>
<a name="ln1996">            ip-&gt;nInputType == INPUT_INCHI?       &quot;InChI (plain identifier)&quot; :</a>
<a name="ln1997">#endif</a>
<a name="ln1998">            ip-&gt;nInputType == INPUT_INCHI_XML?   &quot;InChI AuxInfo (xml)&quot;   :</a>
<a name="ln1999">            ip-&gt;nInputType == INPUT_INCHI_PLAIN? &quot;InChI AuxInfo (plain)&quot; : &quot;Unknown&quot; );</a>
<a name="ln2000">        if ( (ip-&gt;nInputType == INPUT_MOLFILE || ip-&gt;nInputType == INPUT_SDFILE) &amp;&amp;</a>
<a name="ln2001">             ip-&gt;bGetMolfileNumber ) </a>
<a name="ln2002">            inchi_ios_eprint( log_file, &quot;  (attempting to read Molfile number)&quot; );</a>
<a name="ln2003">        inchi_ios_eprint( log_file, &quot;\n&quot;);</a>
<a name="ln2004">    }</a>
<a name="ln2005"> </a>
<a name="ln2006">    if ( ip-&gt;szSdfDataHeader[0] &amp;&amp; ip-&gt;nInputType != INPUT_SDFILE ) </a>
<a name="ln2007">        inchi_ios_eprint( log_file, &quot;  SDfile data header: \&quot;%s\&quot;\n&quot;, ip-&gt;szSdfDataHeader);</a>
<a name="ln2008"> </a>
<a name="ln2009">    /* Output */</a>
<a name="ln2010"> </a>
<a name="ln2011">    inchi_ios_eprint( log_file, &quot;Output format: %s%s\n&quot;, </a>
<a name="ln2012">        (ip-&gt;bINChIOutputOptions &amp; INCHI_OUT_PLAIN_TEXT)?  &quot;Plain text&quot; :</a>
<a name="ln2013">        (ip-&gt;bINChIOutputOptions &amp; INCHI_OUT_XML)?         &quot;XML&quot;:</a>
<a name="ln2014">        ((ip-&gt;bINChIOutputOptions &amp; INCHI_OUT_SDFILE_ONLY) &amp;&amp; bInChI2Struct )? &quot;SDfile only (without stereochemical info and atom coordinates)&quot; :</a>
<a name="ln2015">        ((ip-&gt;bINChIOutputOptions &amp; INCHI_OUT_SDFILE_ONLY) &amp;&amp; !bInChI2Struct)? &quot;SDfile only&quot; : &quot;Unknown&quot;,</a>
<a name="ln2016"> </a>
<a name="ln2017">        ((ip-&gt;bINChIOutputOptions &amp; INCHI_OUT_PLAIN_TEXT) &amp;&amp;</a>
<a name="ln2018">        (ip-&gt;bINChIOutputOptions &amp; INCHI_OUT_TABBED_OUTPUT))? &quot;, tabbed&quot;:&quot;&quot;);</a>
<a name="ln2019"> </a>
<a name="ln2020">#if ( bRELEASE_VERSION == 1 )</a>
<a name="ln2021">    if ( ip-&gt;bCtPredecessors || ip-&gt;bAbcNumbers ) </a>
<a name="ln2022">    {</a>
<a name="ln2023">        if ( ip-&gt;bCtPredecessors &amp;&amp; ip-&gt;bAbcNumbers ) </a>
<a name="ln2024">            inchi_ios_eprint( log_file, &quot;Representation: Compressed\n&quot;);</a>
<a name="ln2025">        else </a>
<a name="ln2026">            inchi_ios_eprint( log_file, &quot;Connection table: %s, %s\n&quot;,</a>
<a name="ln2027">                ip-&gt;bCtPredecessors? &quot;Predecessor_numbers(closures)&quot;:&quot;Canon_numbers(branching, ring closures)&quot;,</a>
<a name="ln2028">                ip-&gt;bAbcNumbers?     &quot;Shorter alternative&quot;:&quot;Numerical&quot;);</a>
<a name="ln2029">    }</a>
<a name="ln2030">#else</a>
<a name="ln2031">    if ( (bRELEASE_VERSION != 1) || ip-&gt;bCtPredecessors || ip-&gt;bAbcNumbers ) </a>
<a name="ln2032">        inchi_ios_eprint( log_file, &quot;Connection table: %s, %s\n&quot;,</a>
<a name="ln2033">            ip-&gt;bCtPredecessors? &quot;Predecessor_numbers(closures)&quot;:&quot;Canon_numbers(branching, ring closures)&quot;,</a>
<a name="ln2034">            ip-&gt;bAbcNumbers?     &quot;Shorter alternative&quot;:&quot;Numerical&quot;);</a>
<a name="ln2035">    else </a>
<a name="ln2036">        inchi_ios_eprint( log_file, &quot;Representation: Numerical&quot;);</a>
<a name="ln2037">#endif</a>
<a name="ln2038"> </a>
<a name="ln2039">    if ( !(ip-&gt;bINChIOutputOptions &amp; INCHI_OUT_SDFILE_ONLY) ) </a>
<a name="ln2040">    {</a>
<a name="ln2041">        if( ip-&gt;bINChIOutputOptions &amp; INCHI_OUT_NO_AUX_INFO ) </a>
<a name="ln2042">            inchi_ios_eprint( log_file, &quot;Aux. info suppressed\n&quot;);</a>
<a name="ln2043">        else if ( ip-&gt;bINChIOutputOptions &amp; INCHI_OUT_SHORT_AUX_INFO ) </a>
<a name="ln2044">            inchi_ios_eprint( log_file, &quot;Minimal Aux. info\n&quot;);</a>
<a name="ln2045">        else </a>
<a name="ln2046">            inchi_ios_eprint( log_file, &quot;Full Aux. info\n&quot;);</a>
<a name="ln2047">    }</a>
<a name="ln2048"> </a>
<a name="ln2049"> </a>
<a name="ln2050"> </a>
<a name="ln2051">    if ( ip-&gt;msec_MaxTime ) </a>
<a name="ln2052">    {</a>
<a name="ln2053">        unsigned long seconds = ip-&gt;msec_MaxTime/1000;</a>
<a name="ln2054">        unsigned long milliseconds = (ip-&gt;msec_MaxTime%1000);</a>
<a name="ln2055">        inchi_ios_eprint( log_file, &quot;Timeout per structure: %lu.%03lu sec\n&quot;, seconds, milliseconds);</a>
<a name="ln2056">    } </a>
<a name="ln2057">    else </a>
<a name="ln2058">        inchi_ios_eprint( log_file, &quot;No timeout&quot;);</a>
<a name="ln2059">    inchi_ios_eprint( log_file, &quot;Up to %d atoms per structure\n&quot;, MAX_ATOMS);</a>
<a name="ln2060">    if ( ip-&gt;first_struct_number &gt; 1 ) </a>
<a name="ln2061">        inchi_ios_eprint( log_file, &quot;Skipping %ld structure%s\n&quot;, ip-&gt;first_struct_number-1, ip-&gt;first_struct_number==2? &quot;&quot;:&quot;s&quot; );</a>
<a name="ln2062">    if ( ip-&gt;last_struct_number &gt; 0 ) </a>
<a name="ln2063">        inchi_ios_eprint( log_file, &quot;Terminate after structure #%ld\n&quot;, ip-&gt;last_struct_number );</a>
<a name="ln2064">    if ( ip-&gt;bSaveWarningStructsAsProblem &amp;&amp; ip-&gt;path[3] &amp;&amp; ip-&gt;path[3][0] ) </a>
<a name="ln2065">        inchi_ios_eprint( log_file, &quot;Saving warning structures into the problem file\n&quot;);</a>
<a name="ln2066">    if ( ip-&gt;bSaveAllGoodStructsAsProblem &amp;&amp; ip-&gt;path[3] &amp;&amp; ip-&gt;path[3][0] ) </a>
<a name="ln2067">        inchi_ios_eprint( log_file, &quot;Saving only all good structures into the problem file\n&quot;);</a>
<a name="ln2068">    /*  Report debug modes */</a>
<a name="ln2069">#if ( bRELEASE_VERSION != 1 )</a>
<a name="ln2070">    inchi_ios_eprint( log_file, &quot;Release version = NO\n&quot;);</a>
<a name="ln2071">#endif</a>
<a name="ln2072"> </a>
<a name="ln2073"> </a>
<a name="ln2074">#if ( TRACE_MEMORY_LEAKS == 1 &amp;&amp; defined(_DEBUG) )</a>
<a name="ln2075">    inchi_ios_eprint( log_file, &quot;Tracing memory leaks (SLOW)\n&quot;);</a>
<a name="ln2076">#endif</a>
<a name="ln2077"> </a>
<a name="ln2078">    inchi_ios_eprint( log_file, &quot;\n&quot; );</a>
<a name="ln2079"> </a>
<a name="ln2080"> </a>
<a name="ln2081"> </a>
<a name="ln2082">#if ( bRELEASE_VERSION != 1 )</a>
<a name="ln2083">#if ( FIND_RING_SYSTEMS == 1 )</a>
<a name="ln2084">    inchi_ios_eprint( log_file, &quot;Find ring systems=Y\nTautomers:\n&quot; );</a>
<a name="ln2085">    inchi_ios_eprint( log_file, &quot; 4-pyridinol=%s\n&quot;, TAUT_4PYRIDINOL_RINGS==1? &quot;Y&quot;:&quot;N&quot;);</a>
<a name="ln2086">    inchi_ios_eprint( log_file, &quot; pyrazole=%s\n&quot;, TAUT_PYRAZOLE_RINGS==1? &quot;Y&quot;:&quot;N&quot;);</a>
<a name="ln2087">    inchi_ios_eprint( log_file, &quot; tropolone=%s\n&quot;, TAUT_TROPOLONE_7==1? &quot;Y&quot;:&quot;N&quot;);</a>
<a name="ln2088">    inchi_ios_eprint( log_file, &quot; tropolone-5=%s\n&quot;, TAUT_TROPOLONE_5==1? &quot;Y&quot;:&quot;N&quot;);</a>
<a name="ln2089">    inchi_ios_eprint( log_file, &quot;Only chain attachments to tautomeric rings=%s\n&quot;, TAUT_RINGS_ATTACH_CHAIN==1? &quot;Y&quot;:&quot;N&quot;);</a>
<a name="ln2090">#endif</a>
<a name="ln2091">    if ( ip-&gt;bGetSdfileId ) </a>
<a name="ln2092">        inchi_ios_eprint( log_file, &quot;Extracting SDfile IDs\n&quot;);</a>
<a name="ln2093"> </a>
<a name="ln2094">    inchi_ios_eprint( log_file, &quot;\nDbg: MOVE_CHARGES=%d\n&quot;,</a>
<a name="ln2095">                           0!=(ip-&gt;bTautFlags&amp;TG_FLAG_MOVE_POS_CHARGES));</a>
<a name="ln2096">    inchi_ios_eprint( log_file, &quot;     REPLACE_ALT_WITH_TAUT=%d; NEUTRALIZE_ENDPOINTS=%d; BNS_PROTECT_FROM_TAUT=%d\n&quot;,</a>
<a name="ln2097">                                  REPLACE_ALT_WITH_TAUT,    NEUTRALIZE_ENDPOINTS, BNS_PROTECT_FROM_TAUT);</a>
<a name="ln2098">    inchi_ios_eprint( log_file, &quot;     DISCONNECT_SALTS=%d;   TEST_TAUT_SALTS=%d;    TEST_TAUT2_SALTS=%d\n&quot;,</a>
<a name="ln2099">                                  0!=(ip-&gt;bTautFlags&amp;TG_FLAG_DISCONNECT_SALTS),</a>
<a name="ln2100">                                  0!=(ip-&gt;bTautFlags&amp;TG_FLAG_TEST_TAUT__SALTS),</a>
<a name="ln2101">                                  0!=(ip-&gt;bTautFlags&amp;TG_FLAG_TEST_TAUT2_SALTS));</a>
<a name="ln2102"> </a>
<a name="ln2103">    inchi_ios_eprint( log_file, &quot;     CHARGED_ACID_TAUT_ONLY=%d MERGE_TAUT_SALTS=%d\n&quot;,</a>
<a name="ln2104">                                  0==(ip-&gt;bTautFlags&amp;TG_FLAG_ALLOW_NO_NEGTV_O),</a>
<a name="ln2105">                                  0!=(ip-&gt;bTautFlags&amp;TG_FLAG_MERGE_TAUT_SALTS));</a>
<a name="ln2106">    inchi_ios_eprint( log_file, &quot;     DISCONNECT_COORD=%d\n&quot;, 0!=(ip-&gt;bTautFlags&amp;TG_FLAG_DISCONNECT_COORD) );</a>
<a name="ln2107">#if ( TEST_RENUMB_ATOMS == 1 )</a>
<a name="ln2108">    inchi_ios_eprint( log_file, &quot;\nDbg: TEST_RENUMB_ATOMS=%d; TEST_RENUMB_NEIGH=%d; TEST_RENUMB_SWITCH=%d\n&quot;,</a>
<a name="ln2109">                                  TEST_RENUMB_ATOMS,    TEST_RENUMB_NEIGH,    TEST_RENUMB_SWITCH );</a>
<a name="ln2110">    inchi_ios_eprint( log_file, &quot;     TEST_RENUMB_ATOMS_SAVE_LONGEST=%d\n&quot;,</a>
<a name="ln2111">                                  TEST_RENUMB_ATOMS_SAVE_LONGEST);</a>
<a name="ln2112">#endif</a>
<a name="ln2113"> </a>
<a name="ln2114">#endif /* ( bRELEASE_VERSION != 1 ) */</a>
<a name="ln2115"> </a>
<a name="ln2116"> </a>
<a name="ln2117">    return 0;</a>
<a name="ln2118">}</a>
<a name="ln2119"> </a>
<a name="ln2120"> </a>
<a name="ln2121"> </a>
<a name="ln2122">/************************************************************************************/</a>
<a name="ln2123">void HelpCommandLineParms( INCHI_IOSTREAM *f )</a>
<a name="ln2124">{</a>
<a name="ln2125">    if ( !f )</a>
<a name="ln2126">        return;</a>
<a name="ln2127"> </a>
<a name="ln2128">#if ( bRELEASE_VERSION == 1 )</a>
<a name="ln2129"> </a>
<a name="ln2130">    inchi_ios_print_nodisplay( f, </a>
<a name="ln2131">#ifdef TARGET_EXE_USING_API</a>
<a name="ln2132">        &quot;%s ver %s%s.\n\nUsage:\ninchi_main inputFile [outputFile [logFile [problemFile]]] [%coption[ %coption...]]\n&quot;, </a>
<a name="ln2133">        INCHI_NAME, INCHI_VERSION, TARGET_ID_STRING, </a>
<a name="ln2134">        INCHI_OPTION_PREFX, INCHI_OPTION_PREFX); </a>
<a name="ln2135">#else</a>
<a name="ln2136">        &quot;%s ver %s%s.\n\nUsage:\ninchi-%s inputFile [outputFile [logFile [problemFile]]] [%coption [%coption...]]\n&quot;, 	     </a>
<a name="ln2137">        INCHI_NAME, INCHI_VERSION, TARGET_ID_STRING, </a>
<a name="ln2138">        INCHI_VERSION, INCHI_OPTION_PREFX, INCHI_OPTION_PREFX); </a>
<a name="ln2139">#if ( BUILD_WITH_AMI == 1 )</a>
<a name="ln2140">    inchi_ios_print_nodisplay( f, </a>
<a name="ln2141">        &quot;inchi-%s inputFiles... %cAMI [%coption[ %coption...]]\n&quot;, 	     </a>
<a name="ln2142">        INCHI_VERSION, INCHI_OPTION_PREFX, INCHI_OPTION_PREFX, INCHI_OPTION_PREFX); </a>
<a name="ln2143">#endif</a>
<a name="ln2144">#endif</a>
<a name="ln2145">         </a>
<a name="ln2146">    inchi_ios_print_nodisplay( f, &quot;\nOptions:\n&quot;);</a>
<a name="ln2147">    </a>
<a name="ln2148">    inchi_ios_print_nodisplay( f, &quot;\nInput\n&quot;);</a>
<a name="ln2149">    inchi_ios_print_nodisplay( f, &quot;  STDIO       Use standard input/output streams\n&quot;);</a>
<a name="ln2150">    inchi_ios_print_nodisplay( f, &quot;  InpAux      Input structures in %s default aux. info format\n              (for use with STDIO)\n&quot;, INCHI_NAME);</a>
<a name="ln2151">    inchi_ios_print_nodisplay( f, &quot;  SDF:DataHeader Read from the input SDfile the ID under this DataHeader\n&quot;);</a>
<a name="ln2152">#if ( ADD_CMLPP == 1 )</a>
<a name="ln2153">    inchi_ios_print_nodisplay( f, &quot;  CML         Input in CML format (default for input file .CML extension)\n&quot;);</a>
<a name="ln2154">#endif</a>
<a name="ln2155">/*</a>
<a name="ln2156">    inchi_ios_print_nodisplay( f, &quot;  START:n     Skip structures up to n-th one\n&quot;);</a>
<a name="ln2157">    inchi_ios_print_nodisplay( f, &quot;  END:m       Skip structures after m-th one\n&quot;);</a>
<a name="ln2158">*/</a>
<a name="ln2159">#if ( BUILD_WITH_AMI == 1 )</a>
<a name="ln2160">    inchi_ios_print_nodisplay( f, &quot;  AMI         Allow multiple input files (wildcards supported)\n&quot;);</a>
<a name="ln2161">#endif</a>
<a name="ln2162"> </a>
<a name="ln2163">    inchi_ios_print_nodisplay( f, &quot;Output\n&quot;);</a>
<a name="ln2164">    inchi_ios_print_nodisplay( f, &quot;  AuxNone     Omit auxiliary information (default: Include)\n&quot;);</a>
<a name="ln2165">    inchi_ios_print_nodisplay( f, &quot;  SaveOpt     Save custom InChI creation options (non-standard InChI)\n&quot;);</a>
<a name="ln2166">    inchi_ios_print_nodisplay( f, &quot;  NoLabels    Omit structure number, DataHeader and ID from %s output\n&quot;, INCHI_NAME);</a>
<a name="ln2167">    inchi_ios_print_nodisplay( f, &quot;  Tabbed      Separate structure number, %s, and AuxInfo with tabs\n&quot;, INCHI_NAME);</a>
<a name="ln2168">    </a>
<a name="ln2169">    /*inchi_ios_print_nodisplay( f, &quot;  Compress    Compressed output\n&quot;); */</a>
<a name="ln2170">    /*inchi_ios_print_nodisplay( f, &quot;    FULL        Standard set of options for Full Verbose Output\n&quot;);*/</a>
<a name="ln2171">    /*inchi_ios_print_nodisplay( f, &quot;    MIN         Standard set of options for Minimal Concise Output\n&quot;);*/</a>
<a name="ln2172">#if ( defined(_WIN32) &amp;&amp; defined(_MSC_VER) &amp;&amp; !defined(COMPILE_ANSI_ONLY) &amp;&amp; !defined(TARGET_API_LIB) )</a>
<a name="ln2173">    inchi_ios_print_nodisplay( f, &quot;  D           Display the structures\n&quot;);</a>
<a name="ln2174">    inchi_ios_print_nodisplay( f, &quot;  EQU         Display sets of identical components\n&quot;);</a>
<a name="ln2175">    inchi_ios_print_nodisplay( f, &quot;  Fnumber     Set display Font size in number of points\n&quot;);</a>
<a name="ln2176">#endif</a>
<a name="ln2177">    /*inchi_ios_print_nodisplay( f, &quot;    PLAIN       Plain text output (Default: XML format)\n&quot;);*/</a>
<a name="ln2178">    inchi_ios_print_nodisplay( f, &quot;  OutputSDF   Convert %s created with default aux. info to SDfile\n&quot;, INCHI_NAME);</a>
<a name="ln2179">#if ( SDF_OUTPUT_DT == 1 )</a>
<a name="ln2180">    inchi_ios_print_nodisplay( f, &quot;  SdfAtomsDT  Output Hydrogen Isotopes to SDfile as Atoms D and T\n&quot;);</a>
<a name="ln2181">#endif</a>
<a name="ln2182">#if ( BUILD_WITH_AMI == 1 )</a>
<a name="ln2183">    inchi_ios_print_nodisplay( f, &quot;  AMIOutStd   Write output to stdout (in AMI mode)\n&quot;);</a>
<a name="ln2184">    inchi_ios_print_nodisplay( f, &quot;  AMILogStd   Write log to stderr (in AMI mode)\n&quot;);</a>
<a name="ln2185">    inchi_ios_print_nodisplay( f, &quot;  AMIPrbNone  Suppress creation of problem files (in AMI mode)\n&quot;);</a>
<a name="ln2186">#endif</a>
<a name="ln2187">    inchi_ios_print_nodisplay( f, &quot;Structure perception\n&quot;);</a>
<a name="ln2188">    inchi_ios_print_nodisplay( f, &quot;  SNon        Exclude stereo (default: include absolute stereo)\n&quot;);</a>
<a name="ln2189">    inchi_ios_print_nodisplay( f, &quot;  NEWPSOFF    Both ends of wedge point to stereocenters (default: a narrow end)\n&quot;);</a>
<a name="ln2190">    inchi_ios_print_nodisplay( f, &quot;  DoNotAddH   All H are explicit (default: add H according to usual valences)\n&quot;);</a>
<a name="ln2191">    </a>
<a name="ln2192">#ifndef USE_STDINCHI_API</a>
<a name="ln2193">    inchi_ios_print_nodisplay( f, &quot;Stereo perception modifiers (non-standard InChI)\n&quot;);</a>
<a name="ln2194">    inchi_ios_print_nodisplay( f, &quot;  SRel        Relative stereo\n&quot;);</a>
<a name="ln2195">    inchi_ios_print_nodisplay( f, &quot;  SRac        Racemic stereo\n&quot;);</a>
<a name="ln2196">    inchi_ios_print_nodisplay( f, &quot;  SUCF        Use Chiral Flag: On means Absolute stereo, Off - Relative\n&quot;); </a>
<a name="ln2197"> </a>
<a name="ln2198">    inchi_ios_print_nodisplay( f, &quot;Customizing InChI creation (non-standard InChI)\n&quot;);</a>
<a name="ln2199">    inchi_ios_print_nodisplay( f, &quot;  SUU         Always include omitted unknown/undefined stereo\n&quot;);</a>
<a name="ln2200">    inchi_ios_print_nodisplay( f, &quot;  SLUUD       Make labels for unknown and undefined stereo different\n&quot;);</a>
<a name="ln2201">    inchi_ios_print_nodisplay( f, &quot;  RecMet      Include reconnected metals results\n&quot;);</a>
<a name="ln2202">    inchi_ios_print_nodisplay( f, &quot;  FixedH      Include Fixed H layer\n&quot;);</a>
<a name="ln2203">    inchi_ios_print_nodisplay( f, &quot;  KET         Account for keto-enol tautomerism (experimental)\n&quot;);</a>
<a name="ln2204">    inchi_ios_print_nodisplay( f, &quot;  15T         Account for 1,5-tautomerism (experimental)\n&quot;);</a>
<a name="ln2205">#endif</a>
<a name="ln2206"> </a>
<a name="ln2207">    inchi_ios_print_nodisplay( f, &quot;Generation\n&quot;);</a>
<a name="ln2208">    inchi_ios_print_nodisplay( f, &quot;  Wnumber     Set time-out per structure in seconds; W0 means unlimited\n&quot;);</a>
<a name="ln2209">    inchi_ios_print_nodisplay( f, &quot;  WarnOnEmptyStructure Warn and produce empty %s for empty structure\n&quot;, INCHI_NAME);</a>
<a name="ln2210">    inchi_ios_print_nodisplay( f, &quot;  Key         Generate InChIKey\n&quot;);</a>
<a name="ln2211">    inchi_ios_print_nodisplay( f, &quot;  XHash1      Generate hash extension (to 256 bits) for 1st block of InChIKey\n&quot;);</a>
<a name="ln2212">    inchi_ios_print_nodisplay( f, &quot;  XHash2      Generate hash extension (to 256 bits) for 2nd block of InChIKey\n&quot;);</a>
<a name="ln2213"> </a>
<a name="ln2214"> </a>
<a name="ln2215">    inchi_ios_print_nodisplay( f, &quot;Conversion\n&quot;);</a>
<a name="ln2216">#ifdef TARGET_EXE_USING_API</a>
<a name="ln2217">    inchi_ios_print_nodisplay( f, &quot;  InChI2InChI  Test mode: Mol/SDfile-&gt;%s-&gt;%s\n&quot;, INCHI_NAME, INCHI_NAME);</a>
<a name="ln2218">    inchi_ios_print_nodisplay( f, &quot;  InChI2Struct Test mode: Mol/SDfile-&gt;%s-&gt;Structure-&gt;(%s+AuxInfo)\n&quot;, INCHI_NAME, INCHI_NAME);</a>
<a name="ln2219">#else</a>
<a name="ln2220">    inchi_ios_print_nodisplay( f, &quot;  InChI2InChI  Convert %s string(s) into %s string(s)\n&quot;, INCHI_NAME, INCHI_NAME); </a>
<a name="ln2221">    inchi_ios_print_nodisplay( f, &quot;  InChI2Struct Convert InChI string(s) to structure(s) in InChI aux.info format\n&quot;);</a>
<a name="ln2222">#endif</a>
<a name="ln2223"> </a>
<a name="ln2224">#ifdef BUILD_WITH_ENG_OPTIONS</a>
<a name="ln2225">#if 0</a>
<a name="ln2226">    inchi_ios_print_nodisplay( f, &quot;Engineering options (for testing only)\n&quot;);</a>
<a name="ln2227">    inchi_ios_print_nodisplay( f, &quot;  NoADP       Disable Aggressive Deprotonation\n&quot;);</a>
<a name="ln2228">#if ( FIX_ADJ_RAD == 1 )</a>
<a name="ln2229">    inchi_ios_print_nodisplay( f, &quot;  FixRad      Fix Adjacent Radicals\n&quot;);</a>
<a name="ln2230">#endif</a>
<a name="ln2231">    inchi_ios_print_nodisplay( f, &quot;  SPXYZOFF    Do not include Phosphines Stereochemistry\n&quot;);</a>
<a name="ln2232">    inchi_ios_print_nodisplay( f, &quot;  SAsXYZOFF   Do not include Arsines Stereochemistry\n&quot;);</a>
<a name="ln2233">    inchi_ios_print_nodisplay( f, &quot;  FBOFF       Do not fix bug leading to missing or undefined sp3 parity\n&quot; );</a>
<a name="ln2234">    inchi_ios_print_nodisplay( f, &quot;  FB2OFF      Do not fix bugs found after v.1.02b release\n&quot; );</a>
<a name="ln2235">    inchi_ios_print_nodisplay( f, &quot;  FNUDOFF     Do not fix non-uniform drawing issues\n&quot; );</a>
<a name="ln2236">#endif</a>
<a name="ln2237">#endif</a>
<a name="ln2238"> </a>
<a name="ln2239"> </a>
<a name="ln2240">/*</a>
<a name="ln2241">breleaseversion&lt;1</a>
<a name="ln2242">#else</a>
<a name="ln2243">    inchi_ios_print_nodisplay( f, &quot;%s ver %s. Special testing version 12-12-2002.\n&quot;, INCHI_NAME, INCHI_VERSION);</a>
<a name="ln2244">    inchi_ios_print_nodisplay( f, &quot;\nUsage:\ncINChI09b inputFile [outputFile [logFile [problemFile]]] [%coption[ %coption...]]\n&quot;, INCHI_OPTION_PREFX, INCHI_OPTION_PREFX);</a>
<a name="ln2245">    inchi_ios_print_nodisplay( f, &quot;\nOptions:\n&quot;);</a>
<a name="ln2246">    inchi_ios_print_nodisplay( f, &quot;\tB        Basic\n&quot;);</a>
<a name="ln2247">    inchi_ios_print_nodisplay( f, &quot;\tT        basic Tautomeric\n&quot;);</a>
<a name="ln2248">    inchi_ios_print_nodisplay( f, &quot;\tI        Isotopic\n&quot;);</a>
<a name="ln2249">    inchi_ios_print_nodisplay( f, &quot;\tN        Non-isotopic\n&quot;);</a>
<a name="ln2250">    inchi_ios_print_nodisplay( f, &quot;\tS        Stereo\n&quot;);</a>
<a name="ln2251">    inchi_ios_print_nodisplay( f, &quot;\tE        Exclude Stereo\n&quot;);</a>
<a name="ln2252">    inchi_ios_print_nodisplay( f, &quot;\tD        Display the structures\n&quot;);</a>
<a name="ln2253">    inchi_ios_print_nodisplay( f, &quot;\tALT      produce shorter ALTernative representation (Abc)\n&quot;);</a>
<a name="ln2254">    inchi_ios_print_nodisplay( f, &quot;\tSCT      produce shorter connection table representation\n&quot;);</a>
<a name="ln2255">    inchi_ios_print_nodisplay( f, &quot;\tXML      output in xml format\n&quot;);</a>
<a name="ln2256">    inchi_ios_print_nodisplay( f, &quot;\tPLAIN    output in plain format\n&quot;);</a>
<a name="ln2257">    inchi_ios_print_nodisplay( f, &quot;\tMERGE    Merge all MOLfiles from the input file into one compound\n&quot;);</a>
<a name="ln2258">    inchi_ios_print_nodisplay( f, &quot;\tWnumber  time-out per structure in seconds, W0 means unlimited\n&quot;);</a>
<a name="ln2259">    inchi_ios_print_nodisplay( f, &quot;\tFnumber  set display Font size, points\n&quot;);</a>
<a name="ln2260">    inchi_ios_print_nodisplay( f, &quot;\tSREL     Relative Stereo\n&quot;);</a>
<a name="ln2261">    inchi_ios_print_nodisplay( f, &quot;\tSRAC     Racemic Stereo\n&quot;);</a>
<a name="ln2262">    inchi_ios_print_nodisplay( f, &quot;\tNOUUSB   Omit stereobonds if all are unknown/undefined\n&quot;);</a>
<a name="ln2263">    inchi_ios_print_nodisplay( f, &quot;\tNOUUSC   Omit stereocenters if all are unknown/undefined\n&quot;);</a>
<a name="ln2264">    inchi_ios_print_nodisplay( f, &quot;\tSS       Slow Stereo: do not use stereo equivalence\n&quot;);</a>
<a name="ln2265">    inchi_ios_print_nodisplay( f, &quot;\tRS       Do not test for Redundant Stereo elements\n&quot;);</a>
<a name="ln2266">    inchi_ios_print_nodisplay( f, &quot;\tPW       Save warning structures in the problems file\n&quot;);</a>
<a name="ln2267">    inchi_ios_print_nodisplay( f, &quot;\tPGO      Save only all good structures in the problems file\n&quot;);</a>
<a name="ln2268">    inchi_ios_print_nodisplay( f, &quot;\tDSB      Double Stereo Bonds only (ignore alternating bonds stereo)\n&quot;);</a>
<a name="ln2269">    inchi_ios_print_nodisplay( f, &quot;\tRSB:n    Min Ring Size for detecting for Stereo Bonds (n=1 =&gt; all)\n&quot;);</a>
<a name="ln2270">    inchi_ios_print_nodisplay( f, &quot;\tAUXINFO:0          do not output auxiliary information (default:1)\n&quot;);</a>
<a name="ln2271">    inchi_ios_print_nodisplay( f, &quot;\tDISCONSALT:0       do not disconnect salts (default:1)\n&quot;);</a>
<a name="ln2272">    inchi_ios_print_nodisplay( f, &quot;\tDISCONMETAL:0      do not disconnect metals (default:1)\n&quot;);</a>
<a name="ln2273">    inchi_ios_print_nodisplay( f, &quot;\tDISCONMETALCHKVAL:1 do not disconnect if typical valence (default:0)\n&quot;);</a>
<a name="ln2274">    inchi_ios_print_nodisplay( f, &quot;\tRECONMETAL:0       do not reconnect metals (default:1)\n&quot;);</a>
<a name="ln2275">    inchi_ios_print_nodisplay( f, &quot;\tMOVEPOS:0          do not check moveable positive charges (default:1)\n&quot;);</a>
<a name="ln2276">    inchi_ios_print_nodisplay( f, &quot;\tACIDTAUT:n         n=1: one H/(-) tautomerism, 2: more (deflt), 0:none\n&quot;);</a>
<a name="ln2277">    inchi_ios_print_nodisplay( f, &quot;\tMERGESALTTG:1      merge salt t-groups (default), 0: do not merge\n&quot;);</a>
<a name="ln2278">    inchi_ios_print_nodisplay( f, &quot;\tUNCHARGEDACIDS:1   Apply salt (acid) tautomerism in neutral species\n&quot;);</a>
<a name="ln2279">    inchi_ios_print_nodisplay( f, &quot;\tO:[suffix]         Open all 4 files adding suffix to the inputFile name\n&quot;);</a>
<a name="ln2280">    inchi_ios_print_nodisplay( f, &quot;\tOP:outputpath      Set output path\n&quot;);</a>
<a name="ln2281">    inchi_ios_print_nodisplay( f, &quot;\tMOL                input file is a MOLfile (default)\n&quot;);</a>
<a name="ln2282">    inchi_ios_print_nodisplay( f, &quot;\tSDF[:DataHeader]   Include SDfile data for the header into the results\n&quot;);</a>
<a name="ln2283">    inchi_ios_print_nodisplay( f, &quot;\tSDFID              extract CAS r.n. in addition to requested SDfile data\n&quot;);</a>
<a name="ln2284">    inchi_ios_print_nodisplay( f, &quot;\tSTART:number       Start at the given structure ordering number\n&quot;);</a>
<a name="ln2285">    inchi_ios_print_nodisplay( f, &quot;\tEND:number         Terminate after the given structure ordering number\n&quot;);</a>
<a name="ln2286">*/</a>
<a name="ln2287">#endif</a>
<a name="ln2288"> </a>
<a name="ln2289">}</a>
<a name="ln2290"> </a>
<a name="ln2291"> </a>
<a name="ln2292"> </a>
<a name="ln2293"> </a>
<a name="ln2294">/*^^^ */</a>
<a name="ln2295">/************************************************************************************/</a>
<a name="ln2296">void HelpCommandLineParmsReduced( INCHI_IOSTREAM *f )</a>
<a name="ln2297">{</a>
<a name="ln2298">    if ( !f )</a>
<a name="ln2299">        return;</a>
<a name="ln2300"> </a>
<a name="ln2301">#if ( bRELEASE_VERSION == 1 )</a>
<a name="ln2302"> </a>
<a name="ln2303"> </a>
<a name="ln2304">    /*^^^ */</a>
<a name="ln2305">     inchi_ios_print_nodisplay( f, </a>
<a name="ln2306">#ifdef TARGET_EXE_USING_API</a>
<a name="ln2307">         &quot;%s ver %s%s.\n\nUsage:\ninchi_main inputFile [outputFile [logFile [problemFile]]] [%coption[ %coption...]]\n&quot;, </a>
<a name="ln2308">         INCHI_NAME, INCHI_VERSION, TARGET_ID_STRING, </a>
<a name="ln2309">         INCHI_OPTION_PREFX, INCHI_OPTION_PREFX); </a>
<a name="ln2310">#else</a>
<a name="ln2311">         &quot;%s ver %s%s.\n\nUsage:\nc%s-%s inputFile [outputFile [logFile [problemFile]]] [%coption[ %coption...]]\n&quot;, </a>
<a name="ln2312">         INCHI_NAME, INCHI_VERSION, TARGET_ID_STRING, </a>
<a name="ln2313">         INCHI_NAME, INCHI_VERSION, INCHI_OPTION_PREFX, INCHI_OPTION_PREFX); 		 </a>
<a name="ln2314">#endif</a>
<a name="ln2315">    /*^^^ */    </a>
<a name="ln2316"> </a>
<a name="ln2317">    inchi_ios_print_nodisplay( f, &quot;\nOptions:\n&quot;);</a>
<a name="ln2318"> </a>
<a name="ln2319"> </a>
<a name="ln2320">    inchi_ios_print_nodisplay( f, &quot;\nInput\n&quot;);</a>
<a name="ln2321">    inchi_ios_print_nodisplay( f, &quot;  STDIO       Use standard input/output streams\n&quot;);</a>
<a name="ln2322">    inchi_ios_print_nodisplay( f, &quot;  InpAux      Input structures in %s default aux. info format\n              (for use with STDIO)\n&quot;, INCHI_NAME);</a>
<a name="ln2323">    inchi_ios_print_nodisplay( f, &quot;  SDF:DataHeader Read from the input SDfile the ID under this DataHeader\n&quot;);</a>
<a name="ln2324">#if ( ADD_CMLPP == 1 )</a>
<a name="ln2325">    inchi_ios_print_nodisplay( f, &quot;  CML         Input in CML format (default for input file .CML extension)\n&quot;);</a>
<a name="ln2326">#endif</a>
<a name="ln2327">/*</a>
<a name="ln2328">    inchi_ios_print_nodisplay( f, &quot;  START:n     Skip structures up to n-th one\n&quot;);</a>
<a name="ln2329">    inchi_ios_print_nodisplay( f, &quot;  END:m       Skip structures after m-th one\n&quot;);</a>
<a name="ln2330">*/</a>
<a name="ln2331">#if ( BUILD_WITH_AMI == 1 )</a>
<a name="ln2332">    inchi_ios_print_nodisplay( f, &quot;  AMI         Allow multiple input files (wildcards supported)\n&quot;);</a>
<a name="ln2333">#endif</a>
<a name="ln2334"> </a>
<a name="ln2335">    inchi_ios_print_nodisplay( f, &quot;Output\n&quot;);</a>
<a name="ln2336">    inchi_ios_print_nodisplay( f, &quot;  AuxNone     Omit auxiliary information (default: Include)\n&quot;);</a>
<a name="ln2337">    inchi_ios_print_nodisplay( f, &quot;  SaveOpt     Save custom InChI creation options (non-standard InChI)\n&quot;);</a>
<a name="ln2338">    inchi_ios_print_nodisplay( f, &quot;  NoLabels    Omit structure number, DataHeader and ID from %s output\n&quot;, INCHI_NAME);</a>
<a name="ln2339">    inchi_ios_print_nodisplay( f, &quot;  Tabbed      Separate structure number, %s, and AuxInfo with tabs\n&quot;, INCHI_NAME);</a>
<a name="ln2340">    /* inchi_ios_print_nodisplay( f, &quot;  Compress    Compressed output\n&quot;); */</a>
<a name="ln2341">#if ( defined(_WIN32) &amp;&amp; defined(_MSC_VER) &amp;&amp; !defined(COMPILE_ANSI_ONLY) &amp;&amp; !defined(TARGET_API_LIB) )</a>
<a name="ln2342">    inchi_ios_print_nodisplay( f, &quot;  D           Display the structures\n&quot;);</a>
<a name="ln2343">    inchi_ios_print_nodisplay( f, &quot;  EQU         Display sets of identical components\n&quot;);</a>
<a name="ln2344">    inchi_ios_print_nodisplay( f, &quot;  Fnumber     Set display Font size in number of points\n&quot;);</a>
<a name="ln2345">#endif</a>
<a name="ln2346">    inchi_ios_print_nodisplay( f, &quot;  OutputSDF   Convert %s created with default aux. info to SDfile\n&quot;, INCHI_NAME);</a>
<a name="ln2347">#if ( SDF_OUTPUT_DT == 1 )</a>
<a name="ln2348">    inchi_ios_print_nodisplay( f, &quot;  SdfAtomsDT  Output Hydrogen Isotopes to SDfile as Atoms D and T\n&quot;);</a>
<a name="ln2349">#endif</a>
<a name="ln2350">#if ( BUILD_WITH_AMI == 1 )</a>
<a name="ln2351">    inchi_ios_print_nodisplay( f, &quot;  AMIOutStd   Write output to stdout (in AMI mode)\n&quot;);</a>
<a name="ln2352">    inchi_ios_print_nodisplay( f, &quot;  AMILogStd   Write log to stderr (in AMI mode)\n&quot;);</a>
<a name="ln2353">    inchi_ios_print_nodisplay( f, &quot;  AMIPrbNone  Suppress creation of problem files (in AMI mode)\n&quot;);</a>
<a name="ln2354">#endif</a>
<a name="ln2355">    inchi_ios_print_nodisplay( f, &quot;Structure perception\n&quot;);</a>
<a name="ln2356">    inchi_ios_print_nodisplay( f, &quot;  SNon        Exclude stereo (default: include absolute stereo)\n&quot;);</a>
<a name="ln2357">    inchi_ios_print_nodisplay( f, &quot;  NEWPSOFF    Both ends of wedge point to stereocenters (default: a narrow end)\n&quot;);</a>
<a name="ln2358">    inchi_ios_print_nodisplay( f, &quot;  DoNotAddH   All H are explicit (default: add H according to usual valences)\n&quot;);</a>
<a name="ln2359">    </a>
<a name="ln2360">#ifndef USE_STDINCHI_API</a>
<a name="ln2361">    inchi_ios_print_nodisplay( f, &quot;Stereo perception modifiers (non-standard InChI)\n&quot;);</a>
<a name="ln2362">    inchi_ios_print_nodisplay( f, &quot;  SRel        Relative stereo\n&quot;);</a>
<a name="ln2363">    inchi_ios_print_nodisplay( f, &quot;  SRac        Racemic stereo\n&quot;);</a>
<a name="ln2364">    inchi_ios_print_nodisplay( f, &quot;  SUCF        Use Chiral Flag: On means Absolute stereo, Off - Relative\n&quot;); </a>
<a name="ln2365"> </a>
<a name="ln2366">    inchi_ios_print_nodisplay( f, &quot;Customizing InChI creation (non-standard InChI)\n&quot;);</a>
<a name="ln2367">    inchi_ios_print_nodisplay( f, &quot;  SUU         Always include omitted unknown/undefined stereo\n&quot;);</a>
<a name="ln2368">    inchi_ios_print_nodisplay( f, &quot;  SLUUD       Make labels for unknown and undefined stereo different\n&quot;);</a>
<a name="ln2369">    inchi_ios_print_nodisplay( f, &quot;  RecMet      Include reconnected metals results\n&quot;);</a>
<a name="ln2370">    inchi_ios_print_nodisplay( f, &quot;  FixedH      Include Fixed H layer\n&quot;);</a>
<a name="ln2371">    inchi_ios_print_nodisplay( f, &quot;  KET         Account for keto-enol tautomerism (experimental)\n&quot;);</a>
<a name="ln2372">    inchi_ios_print_nodisplay( f, &quot;  15T         Account for 1,5-tautomerism (experimental)\n&quot;);</a>
<a name="ln2373">#endif</a>
<a name="ln2374"> </a>
<a name="ln2375">    inchi_ios_print_nodisplay( f, &quot;Generation\n&quot;);</a>
<a name="ln2376">    inchi_ios_print_nodisplay( f, &quot;  Wnumber     Set time-out per structure in seconds; W0 means unlimited\n&quot;);</a>
<a name="ln2377">    inchi_ios_print_nodisplay( f, &quot;  WarnOnEmptyStructure Warn and produce empty %s for empty structure\n&quot;, INCHI_NAME);</a>
<a name="ln2378">    inchi_ios_print_nodisplay( f, &quot;  Key         Generate InChIKey\n&quot;);</a>
<a name="ln2379">    inchi_ios_print_nodisplay( f, &quot;  XHash1      Generate hash extension (to 256 bits) for 1st block of InChIKey\n&quot;);</a>
<a name="ln2380">    inchi_ios_print_nodisplay( f, &quot;  XHash2      Generate hash extension (to 256 bits) for 2nd block of InChIKey\n&quot;);</a>
<a name="ln2381"> </a>
<a name="ln2382">#ifdef BUILD_WITH_ENG_OPTIONS</a>
<a name="ln2383">#if 0</a>
<a name="ln2384">    inchi_ios_print_nodisplay( f, &quot;Engineering options (for testing only)\n&quot;);</a>
<a name="ln2385">    inchi_ios_print_nodisplay( f, &quot;  NoADP       Disable Aggressive Deprotonation\n&quot;);</a>
<a name="ln2386">#if ( FIX_ADJ_RAD == 1 )</a>
<a name="ln2387">    inchi_ios_print_nodisplay( f, &quot;  FixRad      Fix Adjacent Radicals\n&quot;);</a>
<a name="ln2388">#endif</a>
<a name="ln2389">    inchi_ios_print_nodisplay( f, &quot;  SPXYZOFF    Do not include Phosphines Stereochemistry\n&quot;);</a>
<a name="ln2390">    inchi_ios_print_nodisplay( f, &quot;  SAsXYZOFF   Do not include Arsines Stereochemistry\n&quot;);</a>
<a name="ln2391">    inchi_ios_print_nodisplay( f, &quot;  FBOFF       Do not fix bug leading to missing or undefined sp3 parity\n&quot; );</a>
<a name="ln2392">    inchi_ios_print_nodisplay( f, &quot;  FB2OFF      Do not fix bugs found after v.1.02b release\n&quot; );</a>
<a name="ln2393">    inchi_ios_print_nodisplay( f, &quot;  FNUDOFF     Do not fix non-uniform drawing issues\n&quot; );</a>
<a name="ln2394">#endif</a>
<a name="ln2395">#endif</a>
<a name="ln2396"> </a>
<a name="ln2397"> </a>
<a name="ln2398">      </a>
<a name="ln2399">#endif /* #if ( bRELEASE_VERSION == 1 ) */</a>
<a name="ln2400">}</a>
<a name="ln2401"> </a>
<a name="ln2402"> </a>
<a name="ln2403"> </a>
<a name="ln2404"> </a>
<a name="ln2405">#define fprintf2 inchi_fprintf</a>
<a name="ln2406"> </a>
<a name="ln2407">#ifndef TARGET_API_LIB</a>
<a name="ln2408">/************************************************************************************/</a>
<a name="ln2409">int OpenFiles( FILE **inp_file, FILE **output_file, FILE **log_file, FILE **prb_file, INPUT_PARMS *ip )</a>
<a name="ln2410">{</a>
<a name="ln2411">/*</a>
<a name="ln2412">  -- Files --</a>
<a name="ln2413">  ip-&gt;path[0] =&gt; Input</a>
<a name="ln2414">  ip-&gt;path[1] =&gt; Output (INChI)</a>
<a name="ln2415">  ip-&gt;path[2] =&gt; Log</a>
<a name="ln2416">  ip-&gt;path[3] =&gt; Problem structures</a>
<a name="ln2417">  ip-&gt;path[4] =&gt; Errors file (ACD Labs)</a>
<a name="ln2418"> </a>
<a name="ln2419">*/</a>
<a name="ln2420">    /*  logfile -- open as early as possible */</a>
<a name="ln2421">    if ( !ip-&gt;path[2] || !ip-&gt;path[2][0] ) {</a>
<a name="ln2422">        fprintf2( stderr, &quot;%s version %s%s%s\n&quot;, INCHI_NAME, INCHI_VERSION, TARGET_ID_STRING, bRELEASE_VERSION? &quot;&quot;:&quot;&quot;); /* (Pre-release, for evaluation purposes only)&quot; ); */</a>
<a name="ln2423">        fprintf2( stderr, &quot;Log file not specified. Using standard error output.\n&quot;);</a>
<a name="ln2424">        *log_file = stderr;</a>
<a name="ln2425">    } else</a>
<a name="ln2426">    if ( !(*log_file = fopen( ip-&gt;path[2], &quot;w&quot; ) ) ) {</a>
<a name="ln2427">        fprintf2( stderr, &quot;%s version %s%s%s\n&quot;, INCHI_NAME, INCHI_VERSION, TARGET_ID_STRING, bRELEASE_VERSION? &quot;&quot;:&quot;&quot;); /* (Pre-release, for evaluation purposes only)&quot; );*/</a>
<a name="ln2428">        fprintf2( stderr, &quot;Cannot open log file '%s'. Using standard error output.\n&quot;, ip-&gt;path[2] );</a>
<a name="ln2429">        *log_file = stderr;</a>
<a name="ln2430">    } else {</a>
<a name="ln2431">        fprintf2( *log_file, &quot;%s version %s%s%s\n&quot;, INCHI_NAME, INCHI_VERSION, TARGET_ID_STRING, bRELEASE_VERSION? &quot;&quot;:&quot;&quot;); /* (Pre-release, for evaluation purposes only)&quot; );*/</a>
<a name="ln2432">        fprintf2( *log_file, &quot;Opened log file '%s'\n&quot;, ip-&gt;path[2] );</a>
<a name="ln2433">    }</a>
<a name="ln2434">    /* input file */</a>
<a name="ln2435">    if ( (ip-&gt;nInputType == INPUT_MOLFILE || ip-&gt;nInputType == INPUT_SDFILE ||</a>
<a name="ln2436">         ip-&gt;nInputType == INPUT_CMLFILE  || ip-&gt;nInputType == INPUT_INCHI  ||</a>
<a name="ln2437">         ip-&gt;nInputType == INPUT_INCHI_PLAIN ) &amp;&amp; ip-&gt;num_paths &gt; 0 ) </a>
<a name="ln2438">    {</a>
<a name="ln2439">        const char *fmode = NULL;</a>
<a name="ln2440">#if ( defined(_MSC_VER)&amp;&amp;defined(_WIN32) || defined(__BORLANDC__)&amp;&amp;defined(__WIN32__) || defined(__GNUC__)&amp;&amp;defined(__MINGW32__)&amp;&amp;defined(_WIN32) )</a>
<a name="ln2441">        /* compilers that definitely allow fopen &quot;rb&quot; (binary read) mode */</a>
<a name="ln2442">        fmode = &quot;rb&quot;;</a>
<a name="ln2443">        if ( !ip-&gt;path[0] || !ip-&gt;path[0][0] || !(*inp_file = fopen( ip-&gt;path[0], &quot;rb&quot; ) ) ) </a>
<a name="ln2444">        {</a>
<a name="ln2445">            fprintf2( *log_file, &quot;Cannot open input file '%s'. Terminating.\n&quot;, ip-&gt;path[0]? ip-&gt;path[0] : &quot;&lt;No name&gt;&quot; );</a>
<a name="ln2446">            goto exit_function;</a>
<a name="ln2447">        } </a>
<a name="ln2448">        else </a>
<a name="ln2449">        {</a>
<a name="ln2450">            if ( ip-&gt;nInputType == INPUT_CMLFILE ) </a>
<a name="ln2451">            {</a>
<a name="ln2452">                int c;</a>
<a name="ln2453">#ifdef CML_DEBUG</a>
<a name="ln2454">                printf (&quot;cr %d lf %d ret %d\n&quot;, (int) '\r', (int) '\f', (int) '\n');</a>
<a name="ln2455">#endif</a>
<a name="ln2456">                /* read up to the end of the first line */</a>
<a name="ln2457">                while( (c = fgetc( *inp_file )) &amp;&amp; c != EOF &amp;&amp; c != '\n' &amp;&amp; c != '\r' )</a>
<a name="ln2458">                    ;</a>
<a name="ln2459">                if ( c == '\r' || c == EOF ) </a>
<a name="ln2460">                {</a>
<a name="ln2461">                    /* text file contains CR; close and reopen as &quot;text&quot; */</a>
<a name="ln2462">                    fclose( *inp_file );</a>
<a name="ln2463">                    if ( !(*inp_file = fopen( ip-&gt;path[0], &quot;r&quot; ) ) ) </a>
<a name="ln2464">                    {</a>
<a name="ln2465">                        fprintf2( *log_file, &quot;Cannot open input file '%s' (2nd attempt). Terminating.\n&quot;, ip-&gt;path[0] );</a>
<a name="ln2466">                        goto exit_function;</a>
<a name="ln2467">                    }</a>
<a name="ln2468">                    fprintf2( *log_file, &quot;Opened input file '%s'\n&quot;, ip-&gt;path[0] );</a>
<a name="ln2469">                    fmode = &quot;r&quot;;</a>
<a name="ln2470">                } </a>
<a name="ln2471">                else </a>
<a name="ln2472">                {</a>
<a name="ln2473">                    fclose( *inp_file );</a>
<a name="ln2474">                    if ( !(*inp_file = fopen( ip-&gt;path[0], &quot;rb&quot; ) ) ) </a>
<a name="ln2475">                    {</a>
<a name="ln2476">                        fprintf2( *log_file, &quot;Cannot open input file '%s' (2nd attempt). Terminating.\n&quot;, ip-&gt;path[0] );</a>
<a name="ln2477">                        goto exit_function;</a>
<a name="ln2478">                    }</a>
<a name="ln2479">                    fprintf2( *log_file, &quot;Opened input file '%s': no CR.\n&quot;, ip-&gt;path[0] );</a>
<a name="ln2480">                    fmode = &quot;rb&quot;;</a>
<a name="ln2481">                }</a>
<a name="ln2482">            } /* CML */</a>
<a name="ln2483">            else</a>
<a name="ln2484">                fprintf2( *log_file, &quot;Opened input file '%s'\n&quot;, ip-&gt;path[0] );</a>
<a name="ln2485"> </a>
<a name="ln2486">        }</a>
<a name="ln2487">#else</a>
<a name="ln2488">        if ( !ip-&gt;path[0] || !ip-&gt;path[0][0] || !(*inp_file = fopen( ip-&gt;path[0], &quot;r&quot; ) ) ) {</a>
<a name="ln2489">            fprintf2( *log_file, &quot;Cannot open input file '%s'. Terminating.\n&quot;, ip-&gt;path[0]? ip-&gt;path[0] : &quot;&lt;No Name&gt;&quot; );</a>
<a name="ln2490">            goto exit_function;</a>
<a name="ln2491">        } else {</a>
<a name="ln2492">            fprintf2( *log_file, &quot;Opened input file '%s'\n&quot;, ip-&gt;path[0] );</a>
<a name="ln2493">        }</a>
<a name="ln2494">        fmode = &quot;r&quot;;</a>
<a name="ln2495">#endif</a>
<a name="ln2496">        DetectInputINChIFileType( inp_file, ip, fmode );</a>
<a name="ln2497">    } else</a>
<a name="ln2498">    if ( (ip-&gt;nInputType != INPUT_MOLFILE &amp;&amp; ip-&gt;nInputType != INPUT_SDFILE &amp;&amp; ip-&gt;nInputType != INPUT_CMLFILE &amp;&amp; ip-&gt;nInputType != INPUT_INCHI </a>
<a name="ln2499">        /*^^^ post-1.02b */</a>
<a name="ln2500">        &amp;&amp; ip-&gt;nInputType != INPUT_INCHI_PLAIN</a>
<a name="ln2501">        )) {</a>
<a name="ln2502">        fprintf2( *log_file, &quot;Input file type not specified. Terminating.\n&quot;);</a>
<a name="ln2503">        goto exit_function;</a>
<a name="ln2504">    } else {</a>
<a name="ln2505">        fprintf2( *log_file, &quot;Input file not specified. Using standard input.\n&quot;);</a>
<a name="ln2506">        *inp_file = stdin;</a>
<a name="ln2507">    }</a>
<a name="ln2508">    /*  output file */</a>
<a name="ln2509">    if ( !ip-&gt;path[1] || !ip-&gt;path[1][0] ) {</a>
<a name="ln2510">        fprintf2( *log_file, &quot;Output file not specified. Using standard output.\n&quot;);</a>
<a name="ln2511">        *output_file = stdout;</a>
<a name="ln2512">    } else {</a>
<a name="ln2513">        if ( !(*output_file = fopen( ip-&gt;path[1], &quot;w&quot; ) ) ) {</a>
<a name="ln2514">            fprintf2( *log_file, &quot;Cannot open output file '%s'. Terminating.\n&quot;, ip-&gt;path[1] );</a>
<a name="ln2515">            goto exit_function;</a>
<a name="ln2516">        } else {</a>
<a name="ln2517">             fprintf2( *log_file, &quot;Opened output file '%s'\n&quot;, ip-&gt;path[1] );</a>
<a name="ln2518">            if ( (ip-&gt;bINChIOutputOptions &amp; (INCHI_OUT_PLAIN_TEXT)) &amp;&amp;</a>
<a name="ln2519">                  *inp_file != stdin &amp;&amp;</a>
<a name="ln2520">                  !(ip-&gt;bINChIOutputOptions &amp; INCHI_OUT_SDFILE_ONLY) &amp;&amp;</a>
<a name="ln2521">                  !ip-&gt;bNoStructLabels &amp;&amp;</a>
<a name="ln2522">                  !(ip-&gt;bINChIOutputOptions &amp; INCHI_OUT_TABBED_OUTPUT)) {</a>
<a name="ln2523">                 PrintFileName( &quot;* Input_File: \&quot;%s\&quot;\n&quot;, *output_file, ip-&gt;path[0] );</a>
<a name="ln2524">             }</a>
<a name="ln2525">        }</a>
<a name="ln2526">    }</a>
<a name="ln2527">    /*  problem file */</a>
<a name="ln2528">    if ( ip-&gt;path[3] &amp;&amp; ip-&gt;path[3][0] ) {</a>
<a name="ln2529">        const char *fmode = &quot;w&quot;;</a>
<a name="ln2530">#if ( defined(_MSC_VER)&amp;&amp;defined(_WIN32) || defined(__BORLANDC__)&amp;&amp;defined(__WIN32__) || defined(__GNUC__)&amp;&amp;defined(__MINGW32__)&amp;&amp;defined(_WIN32) )</a>
<a name="ln2531">        if ( ip-&gt;nInputType != INPUT_CMLFILE ) {</a>
<a name="ln2532">            fmode = &quot;wb&quot;;</a>
<a name="ln2533">        }</a>
<a name="ln2534">#endif</a>
<a name="ln2535">        if ( !(*prb_file = fopen( ip-&gt;path[3], fmode ) ) ) {</a>
<a name="ln2536">            fprintf2( *log_file, &quot;Cannot open problem file '%s'. Terminating.\n&quot;, ip-&gt;path[3] );</a>
<a name="ln2537">            goto exit_function;</a>
<a name="ln2538">        } else {</a>
<a name="ln2539">             fprintf2( *log_file, &quot;Opened problem file '%s'\n&quot;, ip-&gt;path[3] );</a>
<a name="ln2540">        }</a>
<a name="ln2541">    }</a>
<a name="ln2542">    return 1;  /*  success */</a>
<a name="ln2543"> </a>
<a name="ln2544">exit_function:</a>
<a name="ln2545">    return 0; /*  failed */</a>
<a name="ln2546"> </a>
<a name="ln2547">}</a>
<a name="ln2548">#define NUM_VERSIONS 7</a>
<a name="ln2549">#define LEN_VERSIONS 64</a>
<a name="ln2550">/*******************************************************************/</a>
<a name="ln2551">static int bMatchOnePrefix( int len, char *str, int lenPrefix[],</a>
<a name="ln2552">                            char strPrefix[][LEN_VERSIONS], int numPrefix);</a>
<a name="ln2553">/*******************************************************************/</a>
<a name="ln2554">static int bMatchOnePrefix( int len, char *str, int lenPrefix[],</a>
<a name="ln2555">                            char strPrefix[][LEN_VERSIONS], int numPrefix)</a>
<a name="ln2556">{</a>
<a name="ln2557">    int i;</a>
<a name="ln2558">    for ( i = 0; i &lt; numPrefix; i ++ ) {</a>
<a name="ln2559">        if ( len &gt;= lenPrefix[i] &amp;&amp;</a>
<a name="ln2560">             !memcmp( str, strPrefix[i], lenPrefix[i] ) ) { </a>
<a name="ln2561">            return 1;</a>
<a name="ln2562">        }</a>
<a name="ln2563">    }</a>
<a name="ln2564">    return 0;</a>
<a name="ln2565">}</a>
<a name="ln2566">/*******************************************************************/</a>
<a name="ln2567">int DetectInputINChIFileType( FILE **inp_file, INPUT_PARMS *ip, const char *fmode )</a>
<a name="ln2568">{</a>
<a name="ln2569">    char szLine[256], ret = 0;</a>
<a name="ln2570">    static char szPlnVersion[NUM_VERSIONS][LEN_VERSIONS]; /* = &quot;INChI:1.1Beta/&quot;;*/</a>
<a name="ln2571">    static int  lenPlnVersion[NUM_VERSIONS];</a>
<a name="ln2572">    static char szPlnAuxVer[NUM_VERSIONS][LEN_VERSIONS]; /* = &quot;AuxInfo:1.1Beta/&quot;;*/</a>
<a name="ln2573">    static int  lenPlnAuxVer[NUM_VERSIONS];</a>
<a name="ln2574">    static char szXmlVersion[NUM_VERSIONS][LEN_VERSIONS]; /* = &quot;&lt;INChI version=\&quot;1.1Beta\&quot;&gt;&quot;;*/</a>
<a name="ln2575">    static int  lenXmlVersion[NUM_VERSIONS];</a>
<a name="ln2576">    static char szXmlStruct[LEN_VERSIONS]  = &quot;&lt;structure&quot;;</a>
<a name="ln2577">    static int  lenXmlStruct;</a>
<a name="ln2578">    static char szXmlIdentVer[NUM_VERSIONS][LEN_VERSIONS]; /*= &quot;&lt;identifier version=\&quot;1.1Beta\&quot;&quot;;*/</a>
<a name="ln2579">    static int  lenXmlIdentVer[NUM_VERSIONS];</a>
<a name="ln2580">    static char szXmlMsgError[LEN_VERSIONS];</a>
<a name="ln2581">    static int  lenXmlMsgError = 0;</a>
<a name="ln2582">    static char szXmlMsgFatal[LEN_VERSIONS]= &quot;&lt;message type=\&quot;fatal (aborted)\&quot;&quot;;</a>
<a name="ln2583">    static int  lenXmlMsgFatal;</a>
<a name="ln2584">    static int  bInitilized = 0;</a>
<a name="ln2585">    int  bINChI_plain = 0, bINChI_xml = 0, len, i;</a>
<a name="ln2586">    if ( ip-&gt;nInputType == INPUT_INCHI_XML || ip-&gt;nInputType == INPUT_INCHI_PLAIN || ip-&gt;nInputType == INPUT_INCHI ) {</a>
<a name="ln2587">        return 1;</a>
<a name="ln2588">    }</a>
<a name="ln2589">    if ( !bInitilized ) {</a>
<a name="ln2590">        lenPlnVersion[0]  = sprintf( szPlnVersion[0],  &quot;%s=%s/&quot;, INCHI_NAME, INCHI_VERSION );</a>
<a name="ln2591">        lenPlnVersion[1]  = sprintf( szPlnVersion[1],  &quot;INChI=1.12Beta/&quot; );</a>
<a name="ln2592">        lenPlnVersion[2]  = sprintf( szPlnVersion[2],  &quot;INChI=1.0RC/&quot; );</a>
<a name="ln2593">        lenPlnVersion[3]  = sprintf( szPlnVersion[3],  &quot;InChI=1.0RC/&quot; );</a>
<a name="ln2594">        lenPlnVersion[4]  = sprintf( szPlnVersion[4],  &quot;InChI=1/&quot; );</a>
<a name="ln2595">        lenPlnVersion[5]  = sprintf( szPlnVersion[5],  &quot;MoChI=1a/&quot; );</a>
<a name="ln2596">        lenPlnVersion[6]  = sprintf( szPlnVersion[6],  &quot;InChI=1S/&quot; );</a>
<a name="ln2597">        lenPlnAuxVer[0]   = sprintf( szPlnAuxVer[0],   &quot;AuxInfo=%s/&quot;, INCHI_VERSION );</a>
<a name="ln2598">        lenPlnAuxVer[1]   = sprintf( szPlnAuxVer[1],   &quot;AuxInfo=1.12Beta/&quot; );</a>
<a name="ln2599">        lenPlnAuxVer[2]   = sprintf( szPlnAuxVer[2],   &quot;AuxInfo=1.0RC/&quot; );</a>
<a name="ln2600">        lenPlnAuxVer[3]   = sprintf( szPlnAuxVer[3],   &quot;AuxInfo=1.0RC/&quot; );</a>
<a name="ln2601">        lenPlnAuxVer[4]   = sprintf( szPlnAuxVer[4],   &quot;AuxInfo=1/&quot; );</a>
<a name="ln2602">        lenPlnAuxVer[5]   = sprintf( szPlnAuxVer[5],   &quot;AuxInfo=1a/&quot; );</a>
<a name="ln2603">        lenPlnAuxVer[6]   = sprintf( szPlnAuxVer[6],   &quot;AuxInfo=1/&quot; );</a>
<a name="ln2604">        lenXmlVersion[0]  = sprintf( szXmlVersion[0],  &quot;&lt;%s version=\&quot;%s\&quot;&gt;&quot;, INCHI_NAME, INCHI_VERSION );</a>
<a name="ln2605">        lenXmlVersion[1]  = sprintf( szXmlVersion[1],  &quot;&lt;INChI version=\&quot;1.12Beta\&quot;&gt;&quot; );</a>
<a name="ln2606">        lenXmlVersion[2]  = sprintf( szXmlVersion[2],  &quot;&lt;INChI version=\&quot;1.0RC\&quot;&gt;&quot; );</a>
<a name="ln2607">        lenXmlVersion[3]  = sprintf( szXmlVersion[3],  &quot;&lt;InChI version=\&quot;1.0RC\&quot;&gt;&quot; );</a>
<a name="ln2608">        lenXmlVersion[4]  = sprintf( szXmlVersion[4],  &quot;&lt;InChI version=\&quot;1\&quot;&gt;&quot; );</a>
<a name="ln2609">        lenXmlVersion[5]  = sprintf( szXmlVersion[5],  &quot;&lt;MoChI version=\&quot;1a\&quot;&gt;&quot; );</a>
<a name="ln2610">        lenXmlVersion[6]  = sprintf( szXmlVersion[6],  &quot;&lt;InChI version=\&quot;1S\&quot;&gt;&quot; );</a>
<a name="ln2611">        lenXmlIdentVer[0] = sprintf( szXmlIdentVer[0], &quot;&lt;identifier version=\&quot;%s\&quot;&quot;, INCHI_VERSION );</a>
<a name="ln2612">        lenXmlIdentVer[1] = sprintf( szXmlIdentVer[1], &quot;&lt;identifier version=\&quot;1.12Beta\&quot;&quot; );</a>
<a name="ln2613">        lenXmlIdentVer[2] = sprintf( szXmlIdentVer[2], &quot;&lt;identifier version=\&quot;1.0RC\&quot;&quot; );</a>
<a name="ln2614">        lenXmlIdentVer[3] = sprintf( szXmlIdentVer[3], &quot;&lt;identifier version=\&quot;1.0RC\&quot;&quot; );</a>
<a name="ln2615">        lenXmlIdentVer[4] = sprintf( szXmlIdentVer[4], &quot;&lt;identifier version=\&quot;1\&quot;&quot; );</a>
<a name="ln2616">        lenXmlIdentVer[5] = sprintf( szXmlIdentVer[5], &quot;&lt;identifier version=\&quot;1a\&quot;&quot; );</a>
<a name="ln2617">        lenXmlIdentVer[6] = sprintf( szXmlIdentVer[6], &quot;&lt;identifier version=\&quot;1S\&quot;&quot; );</a>
<a name="ln2618">        lenXmlMsgError    = sprintf( szXmlMsgError,    &quot;&lt;message type=\&quot;error (no %s)\&quot;&quot;, INCHI_NAME );</a>
<a name="ln2619">        lenXmlStruct      = strlen(szXmlStruct);</a>
<a name="ln2620">        lenXmlMsgFatal    = strlen(szXmlMsgFatal);</a>
<a name="ln2621">#if ( FIX_DALKE_BUGS == 1 )</a>
<a name="ln2622">        bInitilized = 1;</a>
<a name="ln2623">#endif</a>
<a name="ln2624">    }</a>
<a name="ln2625">    for ( i = 0; i &lt; 4; i ++ ) {</a>
<a name="ln2626">        len = inchi_fgetsLfTab( szLine, sizeof(szLine)-1, *inp_file );</a>
<a name="ln2627">        if ( len &lt; 0 )</a>
<a name="ln2628">            break;</a>
<a name="ln2629">        if ( bMatchOnePrefix( len, szLine, lenPlnVersion, szPlnVersion, NUM_VERSIONS ) ||</a>
<a name="ln2630">             bMatchOnePrefix( len, szLine, lenPlnAuxVer, szPlnAuxVer, NUM_VERSIONS ) ) {</a>
<a name="ln2631">            bINChI_plain ++;</a>
<a name="ln2632">        } else</a>
<a name="ln2633">        if ( bMatchOnePrefix( len, szLine, lenXmlVersion, szXmlVersion, NUM_VERSIONS ) ||</a>
<a name="ln2634">             bMatchOnePrefix( len, szLine, &amp;lenXmlStruct, &amp;szXmlStruct, 1 ) ||</a>
<a name="ln2635">             bMatchOnePrefix( len, szLine, lenXmlIdentVer, szXmlIdentVer, NUM_VERSIONS ) ||</a>
<a name="ln2636">             bMatchOnePrefix( len, szLine, &amp;lenXmlMsgError, &amp;szXmlMsgError, 1 ) ||</a>
<a name="ln2637">             bMatchOnePrefix( len, szLine, &amp;lenXmlMsgFatal, &amp;szXmlMsgFatal, 1 ) ) {</a>
<a name="ln2638">            bINChI_xml ++;</a>
<a name="ln2639">        }</a>
<a name="ln2640">    }</a>
<a name="ln2641">    if ( bINChI_plain &gt;= 2 &amp;&amp; !bINChI_xml ) {</a>
<a name="ln2642">        ip-&gt;nInputType = INPUT_INCHI_PLAIN;</a>
<a name="ln2643">        ret = 1;</a>
<a name="ln2644">    } else</a>
<a name="ln2645">    if ( !bINChI_plain &amp;&amp; bINChI_xml &gt;= 3 ) {</a>
<a name="ln2646">        ip-&gt;nInputType = INPUT_INCHI_XML;</a>
<a name="ln2647">        ret = 1;</a>
<a name="ln2648">    }</a>
<a name="ln2649">/*exit_function:*/</a>
<a name="ln2650">    fclose ( *inp_file );</a>
<a name="ln2651">    *inp_file = fopen( ip-&gt;path[0], fmode );</a>
<a name="ln2652">    return ret;</a>
<a name="ln2653">}</a>
<a name="ln2654">#undef NUM_VERSIONS</a>
<a name="ln2655">#undef LEN_VERSIONS</a>
<a name="ln2656"> </a>
<a name="ln2657">#endif /* TARGET_API_LIB */</a>

</code></pre>
<div class="balloon" rel="147"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v547/" target="_blank">V547</a> Expression 'bVer1Options' is always true.</p></div>
<div class="balloon" rel="208"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v547/" target="_blank">V547</a> Expression 'bVer1Options' is always true.</p></div>
<div class="balloon" rel="1475"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v560/" target="_blank">V560</a> A part of conditional expression is always true: !p.</p></div>
<div class="balloon" rel="1514"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v547/" target="_blank">V547</a> Expression 'ip->path[i]' is always true.</p></div>
<div class="balloon" rel="1606"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v547/" target="_blank">V547</a> Expression 'mdbr' is always false.</p></div>
<div class="balloon" rel="1625"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v560/" target="_blank">V560</a> A part of conditional expression is always false: (bCompareComponents & 0x0001).</p></div>
<div class="balloon" rel="1636"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v547/" target="_blank">V547</a> Expression 'bOutputMolfileSplit' is always false.</p></div>
<div class="balloon" rel="1632"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v753/" target="_blank">V753</a> The '&=' operation always sets a value of 'bXml' variable to zero.</p></div>
<div class="balloon" rel="1666"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v547/" target="_blank">V547</a> Expression 'bDisconnectSalts' is always true.</p></div>
<div class="balloon" rel="1668"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v547/" target="_blank">V547</a> Expression 'bAcidTautomerism' is always true.</p></div>
<div class="balloon" rel="1670"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v547/" target="_blank">V547</a> Expression 'bMovePositiveCharges' is always true.</p></div>
<div class="balloon" rel="1672"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v547/" target="_blank">V547</a> Expression 'bAcidTautomerism > 1' is always true.</p></div>
<div class="balloon" rel="1674"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v547/" target="_blank">V547</a> Expression 'bUnchargedAcidTaut == 1' is always false.</p></div>
<div class="balloon" rel="1676"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v547/" target="_blank">V547</a> Expression 'bMergeSaltTGroups' is always true.</p></div>
<div class="balloon" rel="1677"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v547/" target="_blank">V547</a> Expression 'bDisconnectCoord' is always true.</p></div>
<div class="balloon" rel="1680"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v547/" target="_blank">V547</a> Expression 'bDisconnectCoordChkVal' is always false.</p></div>
<div class="balloon" rel="1681"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v547/" target="_blank">V547</a> Expression 'bTgFlagVariableProtons' is always true.</p></div>
<div class="balloon" rel="1682"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v547/" target="_blank">V547</a> Expression 'bTgFlagHardAddRenProtons' is always true.</p></div>
<div class="balloon" rel="1692"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v547/" target="_blank">V547</a> Expression 'bAddPhosphineStereo' is always true.</p></div>
<div class="balloon" rel="1693"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v547/" target="_blank">V547</a> Expression 'bAddArsineStereo' is always true.</p></div>
<div class="balloon" rel="1694"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v547/" target="_blank">V547</a> Expression 'bFixSp3bug' is always true.</p></div>
<div class="balloon" rel="1697"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v547/" target="_blank">V547</a> Expression 'bFixFB2' is always true.</p></div>
<div class="balloon" rel="1441"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v779/" target="_blank">V779</a> Unreachable code detected. It is possible that an error is present.</p></div>
<div class="balloon" rel="1792"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v547/" target="_blank">V547</a> Expression 'first' is always true.</p></div>

<link rel="stylesheet" href="highlight.css">
<script src="highlight.pack.js"></script>
<script src="highlightjs-line-numbers.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script>hljs.initLineNumbersOnLoad();</script>
<script>
  $(document).ready(function() {
      $('.balloon').each(function () {
          var bl = $(this);
          var line = bl.attr('rel');
          var text = $('a[name="ln'+line+'"]').text();

          var space_count = 0;
          for(var i = 0; i<text.length; i++){
              var char = text[i];
              if((char !== ' ')&&(char !== '\t'))break;
              if(char === '\t')space_count++;
              space_count++;
          }

          bl.css('margin-left', space_count*8);
          $('a[name="ln'+line+'"]').after(bl);
      });

      window.location = window.location;
  });
</script>
</body>
</html>
